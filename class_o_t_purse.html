<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Open-Transactions: OTPurse Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Open-Transactions
   &#160;<span id="projectnumber">master/1066fb4910a63ee3f7de8e0807fee3eb663b66c7</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_o_t_purse.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">OTPurse Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="OTPurse" --><!-- doxytag: inherits="OTContract" -->
<p><code>#include &lt;<a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OTPurse:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_o_t_purse.png" usemap="#OTPurse_map" alt=""/>
  <map id="OTPurse_map" name="OTPurse_map">
<area href="class_o_t_contract.html" alt="OTContract" shape="rect" coords="0,0,77,24"/>
</map>
 </div></div>

<p><a href="class_o_t_purse-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#acb88fe42551654113b9d142db4cb4a9a">ProcessXMLNode</a> (<a class="el" href="namespaceirr_1_1io.html#a1628edbb9d5d53f18c82d2a92b0ad27e">irr::io::IrrXMLReader</a> *&amp;xml)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a2c89e783f9253e676ff2e25076265ea9">GenerateInternalKey</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="class_o_t_symmetric_key.html">OTSymmetricKey</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a33b82e7e9104846933b51d939c5d5f67">GetInternalKey</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="_t_r1___wrapper_8hpp.html#a4081b6aa22d0f454ce7498756ea212ff">_SharedPtr</a>&lt; <a class="el" href="class_o_t_cached_key.html">OTCachedKey</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ab627c6ac5d031ec230e530242bce6ac7">GetInternalMaster</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a0407a9c4d90472e8d79fb57edfae032a">GetPassphrase</a> (<a class="el" href="class_o_t_password.html">OTPassword</a> &amp;theOutput, const char *szDisplay=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#aa9fabc0850e503fe1bd507dbe9031915">IsNymIDIncluded</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a3546f66455d223a482a462c083b5713e">IsPasswordProtected</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#acd79fd6aebc25bb41034efc059ac77e6">GetNymID</a> (<a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;theOutput) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a1494538d965842e3fa3d1b9ac2b6dd25">Push</a> (<a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a> theOwner, const <a class="el" href="class_o_t_token.html">OTToken</a> &amp;theToken)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="class_o_t_token.html">OTToken</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a84b70b093c79a796815d9a42c8d3bd74">Pop</a> (<a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a> theOwner)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="class_o_t_token.html">OTToken</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#aa6a65c5da7a399e50efa13eb9599a12b">Peek</a> (<a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a> theOwner) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a6684af2c27ddb65d259f2b8cbdd6c361">Count</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ad8e03aa9b3d80b7e3bc927db699cafe5">IsEmpty</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a20274bcfe719e3d24450862d24fc5cfd">GetTotalValue</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a119cc1d12894285669ea8cbe3149fb42">GetLatestValidFrom</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ae4cc3a72c406fc07d39ab9f2368cea5d">GetEarliestValidTo</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#adbd6990754de8d5b2ad9b76b49bdcdee">VerifyCurrentDate</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a7f53ab667e11e662d7ee479967ec4a94">IsExpired</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#aaabdf20e412ce34bade7a3c280973355">Merge</a> (const <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theSigner, <a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a> theOldNym, <a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a> theNewNym, <a class="el" href="class_o_t_purse.html">OTPurse</a> &amp;theNewPurse)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a0e138a075e5d874ca8af2796c63b301d">OTPurse</a> (const <a class="el" href="class_o_t_purse.html">OTPurse</a> &amp;thePurse)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a074d941b3754e4a813c1c3885bdfeb35">OTPurse</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;ASSET_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a80b36e24aa76d2ee444c4f2ba7ccb425">OTPurse</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a4a21772f1d35a4fc8968e7145707fff8">OTPurse</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;ASSET_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;USER_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a0837171e3f0a30d525cbe46a637ed9e4">~OTPurse</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a6cda4ea82f97fab7719242c0827846f7">LoadPurse</a> (const char *szServerID=NULL, const char *szUserID=NULL, const char *szAssetTypeID=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a40b0557a09d2183149dfc7bbd6145e0d">SavePurse</a> (const char *szServerID=NULL, const char *szUserID=NULL, const char *szAssetTypeID=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a3cb2ab98b3dd278d16f76eb6bf35e780">LoadContract</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#aa6b026618394154f1a7f80064a5e6c50">GetServerID</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#af87e5b076d8d738e6b32e56cc49737c1">GetAssetID</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a2333bb1f91629c7a01d90ae551a334cb">InitPurse</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#afb52ebfc9c608146d5e4aefa25e4e163">Release</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ac4e2350ed948d11ac6376381e6983701">Release_Purse</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a58a7e237570ec66ab1fb1d7027298ee3">ReleaseTokens</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a12ff05c33385bec01a70fb8bacc1833f">SaveContractWallet</a> (std::ofstream &amp;ofs)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT <a class="el" href="class_o_t_purse.html">OTPurse</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ac6779fce5508f7d2dc2e02c22595d7e0">PurseFactory</a> (<a class="el" href="class_o_t_string.html">OTString</a> strInput)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT <a class="el" href="class_o_t_purse.html">OTPurse</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a0f000661383e960d0e728f7af8d3d29b">PurseFactory</a> (<a class="el" href="class_o_t_string.html">OTString</a> strInput, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT <a class="el" href="class_o_t_purse.html">OTPurse</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a1d619a34a0d375339daa51f5dc82dbfc">PurseFactory</a> (<a class="el" href="class_o_t_string.html">OTString</a> strInput, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;ASSET_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT <a class="el" href="class_o_t_purse.html">OTPurse</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a5819d325b8fdfcda7ab2325d21705307">LowLevelInstantiate</a> (const <a class="el" href="class_o_t_string.html">OTString</a> &amp;strFirstLine)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT <a class="el" href="class_o_t_purse.html">OTPurse</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#af7e371360c7561acc9eadad47350391c">LowLevelInstantiate</a> (const <a class="el" href="class_o_t_string.html">OTString</a> &amp;strFirstLine, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT <a class="el" href="class_o_t_purse.html">OTPurse</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ada510a95d7ddea9cc078b6ecdb7a2f1c">LowLevelInstantiate</a> (const <a class="el" href="class_o_t_string.html">OTString</a> &amp;strFirstLine, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;ASSET_ID)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ac68123e506c676e50fd07c93d6cc1b2d">UpdateContents</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a1a94117cce01914bb52bd923cf983291">RecalculateExpirationDates</a> (<a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a> &amp;theOwner)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a281dcf5c0af1b6ff7946a570af115790">OTPurse</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="_o_t_purse_8hpp.html#a394fc17df8d11147a504d41fdf9f7531">dequeOfTokens</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_o_t_identifier.html">OTIdentifier</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_o_t_identifier.html">OTIdentifier</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_o_t_identifier.html">OTIdentifier</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_o_t_symmetric_key.html">OTSymmetricKey</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_r1___wrapper_8hpp.html#a4081b6aa22d0f454ce7498756ea212ff">_SharedPtr</a>&lt; <a class="el" href="class_o_t_cached_key.html">OTCachedKey</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00165">165</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a281dcf5c0af1b6ff7946a570af115790"></a><!-- doxytag: member="OTPurse::OTPurse" ref="a281dcf5c0af1b6ff7946a570af115790" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html#a281dcf5c0af1b6ff7946a570af115790">OTPurse::OTPurse</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00640">640</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                 : ot_super(),
<span class="comment">//  m_ServerID(),</span>
<span class="comment">//  m_AssetID(),</span>
    <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a>(0),
    <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>(NULL),
    <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>),
    <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
{
    <a class="code" href="class_o_t_purse.html#a2333bb1f91629c7a01d90ae551a334cb">InitPurse</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0e138a075e5d874ca8af2796c63b301d"></a><!-- doxytag: member="OTPurse::OTPurse" ref="a0e138a075e5d874ca8af2796c63b301d" args="(const OTPurse &amp;thePurse)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html#a281dcf5c0af1b6ff7946a570af115790">OTPurse::OTPurse</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_purse.html">OTPurse</a> &amp;&#160;</td>
          <td class="paramname"><em>thePurse</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00654">654</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                         : ot_super(),
    <a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>(thePurse.<a class="code" href="class_o_t_purse.html#aa6b026618394154f1a7f80064a5e6c50">GetServerID</a>()),
    <a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>(thePurse.<a class="code" href="class_o_t_purse.html#af87e5b076d8d738e6b32e56cc49737c1">GetAssetID</a>()),
    <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a>(0),
    <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>(NULL),
    <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>),
    <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
{
    <a class="code" href="class_o_t_purse.html#a2333bb1f91629c7a01d90ae551a334cb">InitPurse</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a074d941b3754e4a813c1c3885bdfeb35"></a><!-- doxytag: member="OTPurse::OTPurse" ref="a074d941b3754e4a813c1c3885bdfeb35" args="(const OTIdentifier &amp;SERVER_ID, const OTIdentifier &amp;ASSET_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html#a281dcf5c0af1b6ff7946a570af115790">OTPurse::OTPurse</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>ASSET_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00684">684</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                                              : ot_super(),
    <a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>(SERVER_ID),
    <a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>(ASSET_ID),
    <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a>(0),
    <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>(NULL),
    <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>),
    <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
{
    <a class="code" href="class_o_t_purse.html#a2333bb1f91629c7a01d90ae551a334cb">InitPurse</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a80b36e24aa76d2ee444c4f2ba7ccb425"></a><!-- doxytag: member="OTPurse::OTPurse" ref="a80b36e24aa76d2ee444c4f2ba7ccb425" args="(const OTIdentifier &amp;SERVER_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html#a281dcf5c0af1b6ff7946a570af115790">OTPurse::OTPurse</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00671">671</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                               : ot_super(),
    <a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>(SERVER_ID),
    <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a>(0),
    <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>(NULL),
    <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>),
    <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
{
    <a class="code" href="class_o_t_purse.html#a2333bb1f91629c7a01d90ae551a334cb">InitPurse</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4a21772f1d35a4fc8968e7145707fff8"></a><!-- doxytag: member="OTPurse::OTPurse" ref="a4a21772f1d35a4fc8968e7145707fff8" args="(const OTIdentifier &amp;SERVER_ID, const OTIdentifier &amp;ASSET_ID, const OTIdentifier &amp;USER_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html#a281dcf5c0af1b6ff7946a570af115790">OTPurse::OTPurse</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>ASSET_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>USER_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00698">698</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                               : ot_super(),
    <a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>(USER_ID),
    <a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>(SERVER_ID),
    <a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>(ASSET_ID),
    <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a>(0),
    <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>(<span class="keyword">false</span>),
    <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>(NULL),
    <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>),
    <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>(<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
{
    <a class="code" href="class_o_t_purse.html#a2333bb1f91629c7a01d90ae551a334cb">InitPurse</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0837171e3f0a30d525cbe46a637ed9e4"></a><!-- doxytag: member="OTPurse::~OTPurse" ref="a0837171e3f0a30d525cbe46a637ed9e4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html#a0837171e3f0a30d525cbe46a637ed9e4">OTPurse::~OTPurse</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00726">726</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_purse.html#ac4e2350ed948d11ac6376381e6983701">Release_Purse</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a6684af2c27ddb65d259f2b8cbdd6c361"></a><!-- doxytag: member="OTPurse::Count" ref="a6684af2c27ddb65d259f2b8cbdd6c361" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t <a class="el" href="class_o_t_purse.html#a6684af2c27ddb65d259f2b8cbdd6c361">OTPurse::Count</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01542">1542</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> (<a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.size());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2c89e783f9253e676ff2e25076265ea9"></a><!-- doxytag: member="OTPurse::GenerateInternalKey" ref="a2c89e783f9253e676ff2e25076265ea9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#a2c89e783f9253e676ff2e25076265ea9">OTPurse::GenerateInternalKey</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00240">240</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="class_o_t_purse.html#a3546f66455d223a482a462c083b5713e">IsPasswordProtected</a>()     ||
        (NULL != <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>)        ||    <span class="comment">//this-&gt;GetInternalKey())</span>
        (<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>)
       )
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failed: internal Key  or master key already exists. &quot;</span>
                       <span class="stringliteral">&quot;Or IsPasswordProtected was true.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// -------------------------------------------    </span>
    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_o_t_purse.html#ad8e03aa9b3d80b7e3bc927db699cafe5">IsEmpty</a>())
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failed: The purse must be EMPTY before you create a &quot;</span>
                       <span class="stringliteral">&quot;new symmetric key, internal to that purse. (For the purposes of &quot;</span>
                       <span class="stringliteral">&quot;adding a passphrase to the purse, normally.) Otherwise I would have &quot;</span>
                       <span class="stringliteral">&quot;to loop through all the tokens and re-assign ownership of each one. &quot;</span>
                       <span class="stringliteral">&quot;Instead, I&#39;m just going to return false. That&#39;s easier.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// ------------------------------------------------------------------------</span>
<span class="comment">//  OTSymmetricKey *   m_pSymmetricKey;    // If this purse contains its own symmetric key (instead of using an owner Nym)...</span>
<span class="comment">//  OTCachedKey    *   m_pCachedKey;       // ...then it will have a master key as well, for unlocking that symmetric key, and managing timeouts.</span>

    <span class="comment">// m_pSymmetricKey and m_pCachedKey are both explicitly checked for NULL (above.)</span>
    <span class="comment">// Therefore we have to instantiate them both now.</span>
    <span class="comment">//</span>
    <span class="comment">// We&#39;ll do the Master key first, since we need the passphrase from that, in order to</span>
    <span class="comment">// create the symmetric key.</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_password.html">OTPassword</a>  thePassphrase;
    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strDisplay(<span class="stringliteral">&quot;Enter the new passphrase for this new password-protected purse.&quot;</span>); <span class="comment">// todo internationalization / hardcoding.</span>
    <span class="comment">// ------------------------------------------------------------------------</span>
    <span class="comment">// thePassphrase and m_pCachedKey are BOTH output from the below function.</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a> = <a class="code" href="class_o_t_cached_key.html#a97bb15bbe2b2a100a5379b835c4b539d">OTCachedKey::CreateMasterPassword</a>(thePassphrase, strDisplay.Get()); <span class="comment">//int32_t nTimeoutSeconds=OT_MASTER_KEY_TIMEOUT)</span>
    <span class="comment">// ------------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> ((!<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>) ||
        !<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>-&gt;IsGenerated()) <span class="comment">// This one is unnecessary because CreateMasterPassword already checks it. todo optimize.</span>
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failed: While calling OTCachedKey::CreateMasterPassword.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// ------------------------------------------------------------------------</span>
    <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a> = <span class="keyword">new</span> <a class="code" href="class_o_t_symmetric_key.html">OTSymmetricKey</a>(thePassphrase); <span class="comment">// Creates the symmetric key here based on the passphrase from purse&#39;s master key.</span>
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>);
    <span class="comment">// ------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>-&gt;<a class="code" href="class_o_t_symmetric_key.html#a9e2eced2ded569ff96ddace6488a7968">IsGenerated</a>())
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failed: generating m_pSymmetricKey.\n&quot;</span>, __FUNCTION__);
        <span class="keyword">delete</span> <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>; <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a> = NULL;
        <a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>.reset();
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// ------------------------------------------------------------------</span>
    <a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>.<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>();
    <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a> = <span class="keyword">false</span>;
    <span class="comment">// ------------------------------------------------------------------------</span>
    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;%s: Successfully created a purse&#39;s internal key.\n&quot;</span>, __FUNCTION__);
    <span class="comment">// -----------------</span>
    <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a> = <span class="keyword">true</span>;
    <span class="comment">// -----------------</span>
    _SharedPtr&lt;OTCachedKey&gt; pCachedMaster(<a class="code" href="class_o_t_purse.html#ab627c6ac5d031ec230e530242bce6ac7">OTPurse::GetInternalMaster</a>());
    <span class="keywordflow">if</span> (!pCachedMaster)
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed trying to cache the master key for this purse.\n&quot;</span>, __FUNCTION__);
    <span class="comment">// -----------------</span>
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af87e5b076d8d738e6b32e56cc49737c1"></a><!-- doxytag: member="OTPurse::GetAssetID" ref="af87e5b076d8d738e6b32e56cc49737c1" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a>&amp; <a class="el" href="class_o_t_purse.html#af87e5b076d8d738e6b32e56cc49737c1">OTPurse::GetAssetID</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00273">273</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>;  }
</pre></div>
</div>
</div>
<a class="anchor" id="ae4cc3a72c406fc07d39ab9f2368cea5d"></a><!-- doxytag: member="OTPurse::GetEarliestValidTo" ref="ae4cc3a72c406fc07d39ab9f2368cea5d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> <a class="el" href="class_o_t_purse.html#ae4cc3a72c406fc07d39ab9f2368cea5d">OTPurse::GetEarliestValidTo</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01289">1289</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a33b82e7e9104846933b51d939c5d5f67"></a><!-- doxytag: member="OTPurse::GetInternalKey" ref="a33b82e7e9104846933b51d939c5d5f67" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT <a class="el" href="class_o_t_symmetric_key.html">OTSymmetricKey</a>* <a class="el" href="class_o_t_purse.html#a33b82e7e9104846933b51d939c5d5f67">OTPurse::GetInternalKey</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00225">225</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>; } <span class="comment">// symmetric key for this purse.</span>
</pre></div>
</div>
</div>
<a class="anchor" id="ab627c6ac5d031ec230e530242bce6ac7"></a><!-- doxytag: member="OTPurse::GetInternalMaster" ref="ab627c6ac5d031ec230e530242bce6ac7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_r1___wrapper_8hpp.html#a4081b6aa22d0f454ce7498756ea212ff">_SharedPtr</a>&lt; <a class="el" href="class_o_t_cached_key.html">OTCachedKey</a> &gt; <a class="el" href="class_o_t_purse.html#ab627c6ac5d031ec230e530242bce6ac7">OTPurse::GetInternalMaster</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00202">202</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// -------------------------------------------</span>
    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_o_t_purse.html#a3546f66455d223a482a462c083b5713e">IsPasswordProtected</a>() || (!<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>)) <span class="comment">// this second half of the logic should never happen.</span>
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failed: no internal master key exists, in this purse.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> _SharedPtr&lt;OTCachedKey&gt;();
    }
    <span class="comment">// -------------------------------------------</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>-&gt;IsGenerated()) <span class="comment">// should never happen, since the purse IS password-protected... then where&#39;s the master key?</span>
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Error: internal master key has not yet been generated.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> _SharedPtr&lt;OTCachedKey&gt;();
    }
    <span class="comment">// -------------------------------------------</span>
    <span class="comment">// By this point we know the purse is password protected, the internal master key</span>
    <span class="comment">// exists (not NULL) and it&#39;s been properly generated, so we won&#39;t be inadvertantly sticking</span>
    <span class="comment">// a copy of it on the CachedKey map indexed to some nonexistent ID for an ungenerated key.</span>
    <span class="comment">// The caller will be forced to make sure the master key is real and generated, before passing</span>
    <span class="comment">// it in here where it could get copied.</span>
    <span class="comment">//</span>
    <span class="comment">// Why is that important? BECAUSE THE COPY is all the caller will ever actually use! So if it&#39;s</span>
    <span class="comment">// not ENTIRELY loaded up properly BEFORE it&#39;s copied, the caller will never see the properly</span>
    <span class="comment">// loaded version of that master key.</span>
    <span class="comment">// </span>
    <span class="keywordflow">return</span> <a class="code" href="class_o_t_cached_key.html#a8780b8a3f392b0bc4c11253a797d8b5a">OTCachedKey::It</a>(*<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>); <span class="comment">// here we return a cached copy of the master key (so it&#39;s available between instances of this purse.)</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a119cc1d12894285669ea8cbe3149fb42"></a><!-- doxytag: member="OTPurse::GetLatestValidFrom" ref="a119cc1d12894285669ea8cbe3149fb42" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> <a class="el" href="class_o_t_purse.html#a119cc1d12894285669ea8cbe3149fb42">OTPurse::GetLatestValidFrom</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01286">1286</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="acd79fd6aebc25bb41034efc059ac77e6"></a><!-- doxytag: member="OTPurse::GetNymID" ref="acd79fd6aebc25bb41034efc059ac77e6" args="(OTIdentifier &amp;theOutput) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#acd79fd6aebc25bb41034efc059ac77e6">OTPurse::GetNymID</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>theOutput</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00147">147</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">bool</span> bSuccess = <span class="keyword">false</span>;
    theOutput.<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>();
    <span class="comment">// --------------------------------------</span>
    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_o_t_purse.html#a3546f66455d223a482a462c083b5713e">IsPasswordProtected</a>())
    {
        bSuccess = <span class="keyword">false</span>; <span class="comment">// optimizer will remove automatically anyway, I assume. Might as well have it here for clarity.</span>
    }
    <span class="comment">// --------------------------------------</span>
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_o_t_purse.html#aa9fabc0850e503fe1bd507dbe9031915">IsNymIDIncluded</a>() &amp;&amp; !<a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>.<a class="code" href="class_o_t_data.html#a947528765516223eb03bee7745eb8c07">IsEmpty</a>())
    {
        bSuccess = <span class="keyword">true</span>;
        theOutput = <a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>;
    }
    <span class="comment">// --------------------------------------</span>
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>.<a class="code" href="class_o_t_data.html#a947528765516223eb03bee7745eb8c07">IsEmpty</a>())
    {
        bSuccess  = <span class="keyword">true</span>;
        theOutput = <a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>;
    }
    <span class="comment">// --------------------------------------</span>
    <span class="keywordflow">return</span> bSuccess;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0407a9c4d90472e8d79fb57edfae032a"></a><!-- doxytag: member="OTPurse::GetPassphrase" ref="a0407a9c4d90472e8d79fb57edfae032a" args="(OTPassword &amp;theOutput, const char *szDisplay=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#a0407a9c4d90472e8d79fb57edfae032a">OTPurse::GetPassphrase</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_password.html">OTPassword</a> &amp;&#160;</td>
          <td class="paramname"><em>theOutput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>szDisplay</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00177">177</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFunc = <span class="stringliteral">&quot;OTPurse::GetPassphrase&quot;</span>;
    <span class="comment">// -------------------------------------------</span>
    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_o_t_purse.html#a3546f66455d223a482a462c083b5713e">IsPasswordProtected</a>())
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failed: this purse isn&#39;t even password-protected.\n&quot;</span>, szFunc);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// -------------------------------------------</span>
    _SharedPtr&lt;OTCachedKey&gt; pCachedKey(this-&gt;<a class="code" href="class_o_t_purse.html#ab627c6ac5d031ec230e530242bce6ac7">GetInternalMaster</a>());
    <span class="keywordflow">if</span> (!pCachedKey) <a class="code" href="_o_t_assert_8hpp.html#a1ae1def3bdc59b89b0d96240d3c5c321">OT_FAIL</a>;
    <span class="comment">// -------------------------------------------</span>
    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strReason((NULL == szDisplay) ? szFunc : szDisplay);
    <span class="comment">// -------------------------------------------</span>
    <span class="keyword">const</span> <span class="keywordtype">bool</span> bGotMasterPassword = pCachedKey-&gt;GetMasterPassword(pCachedKey, theOutput, strReason.Get()); <span class="comment">//bVerifyTwice=false</span>
    <span class="keywordflow">return</span> bGotMasterPassword;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa6b026618394154f1a7f80064a5e6c50"></a><!-- doxytag: member="OTPurse::GetServerID" ref="aa6b026618394154f1a7f80064a5e6c50" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a>&amp; <a class="el" href="class_o_t_purse.html#aa6b026618394154f1a7f80064a5e6c50">OTPurse::GetServerID</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00272">272</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a20274bcfe719e3d24450862d24fc5cfd"></a><!-- doxytag: member="OTPurse::GetTotalValue" ref="a20274bcfe719e3d24450862d24fc5cfd" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t <a class="el" href="class_o_t_purse.html#a20274bcfe719e3d24450862d24fc5cfd">OTPurse::GetTotalValue</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00244">244</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a2333bb1f91629c7a01d90ae551a334cb"></a><!-- doxytag: member="OTPurse::InitPurse" ref="a2333bb1f91629c7a01d90ae551a334cb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_purse.html#a2333bb1f91629c7a01d90ae551a334cb">OTPurse::InitPurse</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00715">715</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_contract.html#ac523dac7d72b72e54b1ebb5b3a3b21cc">m_strContractType</a>.<a class="code" href="class_o_t_string.html#aa5db620fe8e60c849585d741975db991">Set</a>(<span class="stringliteral">&quot;PURSE&quot;</span>);
    
    <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a> = 0;
    
    <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a> = <span class="keyword">false</span>;
    <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>   = <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad8e03aa9b3d80b7e3bc927db699cafe5"></a><!-- doxytag: member="OTPurse::IsEmpty" ref="ad8e03aa9b3d80b7e3bc927db699cafe5" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#ad8e03aa9b3d80b7e3bc927db699cafe5">OTPurse::IsEmpty</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01548">1548</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.empty();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7f53ab667e11e662d7ee479967ec4a94"></a><!-- doxytag: member="OTPurse::IsExpired" ref="a7f53ab667e11e662d7ee479967ec4a94" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#a7f53ab667e11e662d7ee479967ec4a94">OTPurse::IsExpired</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01299">1299</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> CURRENT_TIME =   <a class="code" href="_o_t_common_8hpp.html#a1163606b2546b160d50c5f0a5afe479a">OTTimeGetCurrentTime</a>();
    
    <span class="comment">// If the current time is AFTER the valid-TO date,</span>
    <span class="comment">// AND the valid_to is a nonzero number (0 means &quot;doesn&#39;t expire&quot;)</span>
    <span class="comment">// THEN return true (it&#39;s expired.)</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> ((CURRENT_TIME &gt;= <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>) &amp;&amp; (<a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a> &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>))
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa9fabc0850e503fe1bd507dbe9031915"></a><!-- doxytag: member="OTPurse::IsNymIDIncluded" ref="aa9fabc0850e503fe1bd507dbe9031915" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT bool <a class="el" href="class_o_t_purse.html#aa9fabc0850e503fe1bd507dbe9031915">OTPurse::IsNymIDIncluded</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00229">229</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>; } <span class="comment">// NymID may be left blank, with user left guessing.</span>
</pre></div>
</div>
</div>
<a class="anchor" id="a3546f66455d223a482a462c083b5713e"></a><!-- doxytag: member="OTPurse::IsPasswordProtected" ref="a3546f66455d223a482a462c083b5713e" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT bool <a class="el" href="class_o_t_purse.html#a3546f66455d223a482a462c083b5713e">OTPurse::IsPasswordProtected</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00231">231</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a3cb2ab98b3dd278d16f76eb6bf35e780"></a><!-- doxytag: member="OTPurse::LoadContract" ref="a3cb2ab98b3dd278d16f76eb6bf35e780" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#a3cb2ab98b3dd278d16f76eb6bf35e780">OTPurse::LoadContract</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_contract.html#a1432a5e924d021a9dc39320d3b8e7b90">OTContract</a>.</p>

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00776">776</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="class_o_t_purse.html#a6cda4ea82f97fab7719242c0827846f7">LoadPurse</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6cda4ea82f97fab7719242c0827846f7"></a><!-- doxytag: member="OTPurse::LoadPurse" ref="a6cda4ea82f97fab7719242c0827846f7" args="(const char *szServerID=NULL, const char *szUserID=NULL, const char *szAssetTypeID=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#a6cda4ea82f97fab7719242c0827846f7">OTPurse::LoadPurse</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>szServerID</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>szUserID</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>szAssetTypeID</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00782">782</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(!this-&gt;<a class="code" href="class_o_t_purse.html#a3546f66455d223a482a462c083b5713e">IsPasswordProtected</a>());
    <span class="comment">// -----------------------------------------</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#ab1e11693a38a1673037b1f29c9d84010">m_strFoldername</a>.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
        <a class="code" href="class_o_t_contract.html#ab1e11693a38a1673037b1f29c9d84010">m_strFoldername</a>.<a class="code" href="class_o_t_string.html#aa5db620fe8e60c849585d741975db991">Set</a>(<a class="code" href="class_o_t_folders.html#a2793558f559a595e6e7b7c09cfac28d7">OTFolders::Purse</a>().<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
    <span class="comment">// -----------------------------------------</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strServerID(<a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>), strUserID(<a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>), strAssetTypeID(<a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>);
    
    <span class="keywordflow">if</span> (NULL != szServerID)
        strServerID = szServerID;
    <span class="keywordflow">if</span> (NULL != szUserID)
        strUserID = szUserID;
    <span class="keywordflow">if</span> (NULL != szAssetTypeID)
        strAssetTypeID = szAssetTypeID;
    <span class="comment">// -------------------------------</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#ab7ab1f1fe7ff7e52f2c126404a8f4f92">m_strFilename</a>.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
    {
        <a class="code" href="class_o_t_contract.html#ab7ab1f1fe7ff7e52f2c126404a8f4f92">m_strFilename</a>.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%s%s%s%s%s&quot;</span>, strServerID.Get(), <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), 
                             strUserID.Get(), <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), strAssetTypeID.Get());
    }
    
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFolder1name  = <a class="code" href="class_o_t_folders.html#a2793558f559a595e6e7b7c09cfac28d7">OTFolders::Purse</a>().<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();     <span class="comment">// purse </span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFolder2name  = strServerID.Get();        <span class="comment">// purse/SERVER_ID</span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFolder3name  = strUserID.Get();          <span class="comment">// purse/SERVER_ID/USER_ID</span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFilename     = strAssetTypeID.Get();     <span class="comment">// purse/SERVER_ID/USER_ID/ASSET_TYPE_ID</span>
    
    <span class="comment">// --------------------------------------------------------------------</span>
    
    <span class="keywordflow">if</span> (<span class="keyword">false</span> == <a class="code" href="namespace_o_t_d_b.html#a73e39a590dfb64f63065821c6bbcd4c6">OTDB::Exists</a>(szFolder1name, szFolder2name, szFolder3name, szFilename))
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(2, <span class="stringliteral">&quot;OTPurse::LoadPurse: File does not exist: %s%s%s%s%s%s%s\n&quot;</span>,
                      szFolder1name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFolder2name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), 
                      szFolder3name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFilename);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    
    <span class="comment">// --------------------------------------------------------------------</span>
    <span class="comment">//</span>
    std::string strFileContents(<a class="code" href="namespace_o_t_d_b.html#a921d6f538de00f4e4297c25cf679f00a">OTDB::QueryPlainString</a>(szFolder1name, szFolder2name, szFolder3name, szFilename)); <span class="comment">// &lt;=== LOADING FROM DATA STORE.</span>
    
    <span class="keywordflow">if</span> (strFileContents.length() &lt; 2)
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;OTPurse::LoadPurse: Error reading file: %s%s%s%s%s%s%s\n&quot;</span>, 
                      szFolder1name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFolder2name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), 
                      szFolder3name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFilename);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// --------------------------------------------------------------------</span>
    
    <span class="comment">// NOTE: No need here to deal with OT ARMORED file format, since LoadContractFromString</span>
    <span class="comment">// already handles it internally.</span>
    
    <a class="code" href="class_o_t_string.html">OTString</a> strRawFile(strFileContents.c_str());
    
    <span class="keywordflow">return</span> <a class="code" href="class_o_t_contract.html#a36300e34dcd94ed7006d98b392d46815">LoadContractFromString</a>(strRawFile);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5819d325b8fdfcda7ab2325d21705307"></a><!-- doxytag: member="OTPurse::LowLevelInstantiate" ref="a5819d325b8fdfcda7ab2325d21705307" args="(const OTString &amp;strFirstLine)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html">OTPurse</a> * <a class="el" href="class_o_t_purse.html#a5819d325b8fdfcda7ab2325d21705307">OTPurse::LowLevelInstantiate</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_string.html">OTString</a> &amp;&#160;</td>
          <td class="paramname"><em>strFirstLine</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00512">512</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_purse.html">OTPurse</a> * pPurse = NULL;
    <span class="keywordflow">if</span> (strFirstLine.<a class="code" href="class_o_t_string.html#acb212b06102322aebb96090601794825">Contains</a>(<span class="stringliteral">&quot;-----BEGIN SIGNED PURSE-----&quot;</span>))  <span class="comment">// this string is 28 chars long. todo hardcoding.</span>
    {   pPurse = <span class="keyword">new</span> <a class="code" href="class_o_t_purse.html#a281dcf5c0af1b6ff7946a570af115790">OTPurse</a>();     <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pPurse); }
    <span class="keywordflow">return</span> pPurse;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af7e371360c7561acc9eadad47350391c"></a><!-- doxytag: member="OTPurse::LowLevelInstantiate" ref="af7e371360c7561acc9eadad47350391c" args="(const OTString &amp;strFirstLine, const OTIdentifier &amp;SERVER_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html">OTPurse</a> * <a class="el" href="class_o_t_purse.html#a5819d325b8fdfcda7ab2325d21705307">OTPurse::LowLevelInstantiate</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_string.html">OTString</a> &amp;&#160;</td>
          <td class="paramname"><em>strFirstLine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00502">502</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_purse.html">OTPurse</a> * pPurse = NULL;
    <span class="keywordflow">if</span> (strFirstLine.<a class="code" href="class_o_t_string.html#acb212b06102322aebb96090601794825">Contains</a>(<span class="stringliteral">&quot;-----BEGIN SIGNED PURSE-----&quot;</span>))  <span class="comment">// this string is 28 chars long. todo hardcoding.</span>
    {   pPurse = <span class="keyword">new</span> <a class="code" href="class_o_t_purse.html#a281dcf5c0af1b6ff7946a570af115790">OTPurse</a>(SERVER_ID);        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pPurse); }
    <span class="keywordflow">return</span> pPurse;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ada510a95d7ddea9cc078b6ecdb7a2f1c"></a><!-- doxytag: member="OTPurse::LowLevelInstantiate" ref="ada510a95d7ddea9cc078b6ecdb7a2f1c" args="(const OTString &amp;strFirstLine, const OTIdentifier &amp;SERVER_ID, const OTIdentifier &amp;ASSET_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html">OTPurse</a> * <a class="el" href="class_o_t_purse.html#a5819d325b8fdfcda7ab2325d21705307">OTPurse::LowLevelInstantiate</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_string.html">OTString</a> &amp;&#160;</td>
          <td class="paramname"><em>strFirstLine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>ASSET_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00491">491</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_purse.html">OTPurse</a> * pPurse = NULL;
    <span class="keywordflow">if</span> (strFirstLine.<a class="code" href="class_o_t_string.html#acb212b06102322aebb96090601794825">Contains</a>(<span class="stringliteral">&quot;-----BEGIN SIGNED PURSE-----&quot;</span>))  <span class="comment">// this string is 28 chars long. todo hardcoding.</span>
    {   pPurse = <span class="keyword">new</span> <a class="code" href="class_o_t_purse.html#a281dcf5c0af1b6ff7946a570af115790">OTPurse</a>(SERVER_ID, ASSET_ID);      <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pPurse); }
    <span class="keywordflow">return</span> pPurse;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aaabdf20e412ce34bade7a3c280973355"></a><!-- doxytag: member="OTPurse::Merge" ref="aaabdf20e412ce34bade7a3c280973355" args="(const OTPseudonym &amp;theSigner, OTNym_or_SymmetricKey theOldNym, OTNym_or_SymmetricKey theNewNym, OTPurse &amp;theNewPurse)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#aaabdf20e412ce34bade7a3c280973355">OTPurse::Merge</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theSigner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a>&#160;</td>
          <td class="paramname"><em>theOldNym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a>&#160;</td>
          <td class="paramname"><em>theNewNym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_purse.html">OTPurse</a> &amp;&#160;</td>
          <td class="paramname"><em>theNewPurse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00314">314</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFunc = <span class="stringliteral">&quot;OTPurse::Merge&quot;</span>;
    
    <a class="code" href="_o_t_purse_8hpp.html#ad8b3ba3b9a822e5c01381df2282bb03e">mapOfTokenPointers</a> theMap;
    
    <span class="keywordflow">while</span> (this-&gt;<a class="code" href="class_o_t_purse.html#a6684af2c27ddb65d259f2b8cbdd6c361">Count</a>() &gt; 0) 
    {
        <a class="code" href="class_o_t_token.html">OTToken</a> * pToken = this-&gt;<a class="code" href="class_o_t_purse.html#a84b70b093c79a796815d9a42c8d3bd74">Pop</a>(theOldNym); <span class="comment">// must be private, if a Nym.</span>
        <a class="code" href="_o_t_assert_8hpp.html#a033b133f48e61f2b227c52ad2be0c882">OT_ASSERT_MSG</a>(NULL != pToken, <span class="stringliteral">&quot;OTPurse::Merge: Assert: NULL != this-&gt;Pop(theOldNym) \n&quot;</span>);
                
        <span class="keyword">const</span> <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> &amp; ascTokenID = pToken-&gt;<a class="code" href="class_o_t_token.html#ac66cb04fd3053e8fa444010b59a89332">GetSpendable</a>();
        
        std::list&lt;mapOfTokenPointers::iterator&gt; listOfTokenMapIterators;
        
        <span class="comment">// I just popped a Token off of *this. Let&#39;s see if it&#39;s in my temporary map...</span>
        <span class="comment">// If it&#39;s already there, then just delete it (duplicate).</span>
        <span class="comment">//</span>
        <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_purse_8hpp.html#ad8b3ba3b9a822e5c01381df2282bb03e">mapOfTokenPointers</a>, theMap)
        {
            <a class="code" href="class_o_t_token.html">OTToken</a> * pTempToken = (*it).second;
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pTempToken);
            
            <span class="keyword">const</span> <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> &amp; ascTempTokenID = pTempToken-&gt;<a class="code" href="class_o_t_token.html#ac66cb04fd3053e8fa444010b59a89332">GetSpendable</a>();
            <span class="comment">// --------------------------------</span>
            <span class="comment">// It&#39;s already there. Delete the one that&#39;s already there.</span>
            <span class="comment">// (That way we can add it after, whether it was there originally or not.)</span>
            <span class="keywordflow">if</span> (ascTempTokenID == ascTokenID)
            {
                listOfTokenMapIterators.push_back(it);
<span class="comment">//              theMap.erase(it);</span>
<span class="comment">//              delete pTempToken;</span>
<span class="comment">//              pTempToken = NULL;</span>
                <span class="comment">//break; // In case there are multiple duplicates, not just one.</span>
            }
        }
        <span class="keywordflow">while</span> (listOfTokenMapIterators.size() &gt; 0)
        {
            <a class="code" href="class_o_t_token.html">OTToken</a> * pTempToken = (listOfTokenMapIterators.back())-&gt;second;
            theMap.erase(listOfTokenMapIterators.back());
            <span class="keyword">delete</span> pTempToken;
            pTempToken = NULL;
            listOfTokenMapIterators.pop_back();
        }
        
        <span class="comment">// Now we know there aren&#39;t any duplicates on the temporary map, let&#39;s add the token to it.</span>
        std::string theKey = ascTokenID.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();      
        theMap.insert(std::pair&lt;std::string, OTToken*&gt;(theKey, pToken));
    }
    <span class="comment">// At this point, all of the tokens on *this have been popped, and added</span>
    <span class="comment">// to the temporary map as token pointers, with any duplicates removed.</span>
    <span class="comment">// -----------------------------------------------------------</span>
    <span class="comment">// Basically now I just want to do the exact same thing with the other purse...</span>
    <span class="comment">//</span>
    <span class="keywordflow">while</span> (theNewPurse.<a class="code" href="class_o_t_purse.html#a6684af2c27ddb65d259f2b8cbdd6c361">Count</a>() &gt; 0) 
    {
        <a class="code" href="class_o_t_token.html">OTToken</a> * pToken = theNewPurse.<a class="code" href="class_o_t_purse.html#a84b70b093c79a796815d9a42c8d3bd74">Pop</a>(theNewNym); 
        <a class="code" href="_o_t_assert_8hpp.html#a033b133f48e61f2b227c52ad2be0c882">OT_ASSERT_MSG</a>(NULL != pToken, <span class="stringliteral">&quot;OTPurse::Merge: Assert: NULL != theNewPurse.Pop(theNewNym) \n&quot;</span>);
        
        <span class="keyword">const</span> <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> &amp; ascTokenID = pToken-&gt;<a class="code" href="class_o_t_token.html#ac66cb04fd3053e8fa444010b59a89332">GetSpendable</a>();
        
        std::list&lt;mapOfTokenPointers::iterator&gt; listOfTokenMapIterators;

        <span class="comment">// I just popped a Token off of theNewPurse. Let&#39;s see if it&#39;s in my temporary map...</span>
        <span class="comment">// If it&#39;s already there, then just delete it (it&#39;s a duplicate.)</span>
        <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_purse_8hpp.html#ad8b3ba3b9a822e5c01381df2282bb03e">mapOfTokenPointers</a>, theMap)
        {
            <a class="code" href="class_o_t_token.html">OTToken</a> * pTempToken = (*it).second;
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pTempToken);
            
            <span class="keyword">const</span> <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> &amp; ascTempTokenID = pTempToken-&gt;<a class="code" href="class_o_t_token.html#ac66cb04fd3053e8fa444010b59a89332">GetSpendable</a>();
            
            <span class="comment">// --------------------------------</span>
            <span class="comment">// It&#39;s already there. Delete the one that&#39;s already there.</span>
            <span class="comment">// (That way we can add it after, whether it was there originally or not.)</span>
            <span class="keywordflow">if</span> (ascTempTokenID == ascTokenID)
            {
                listOfTokenMapIterators.push_back(it);
<span class="comment">//              theMap.erase(it);</span>
<span class="comment">//              delete pTempToken;</span>
<span class="comment">//              pTempToken = NULL;</span>
                <span class="comment">//break; // In case there are multiple duplicates, not just one.</span>
            }
        }
        <span class="keywordflow">while</span> (listOfTokenMapIterators.size() &gt; 0)
        {
            <a class="code" href="class_o_t_token.html">OTToken</a> * pTempToken = (listOfTokenMapIterators.back())-&gt;second;
            theMap.erase(listOfTokenMapIterators.back());
            <span class="keyword">delete</span> pTempToken;
            pTempToken = NULL;
            listOfTokenMapIterators.pop_back();
        }
        <span class="comment">// Now we KNOW there aren&#39;t any duplicates on the temporary map, so let&#39;s</span>
        <span class="comment">// add the token to it...</span>
        <span class="comment">//</span>
        std::string theKey = ascTokenID.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();      
        theMap.insert(std::pair&lt;std::string, OTToken*&gt;(theKey, pToken));
        <span class="comment">// --------------------------------------------------------------</span>
        <span class="comment">//</span>
        <span class="comment">// SINCE THE new purse is being MERGED into the old purse, we don&#39;t have to re-assign ownership</span>
        <span class="comment">// of any of the old tokens. But we DO need to re-assign ownership of the NEW tokens that are being</span>
        <span class="comment">// merged in. We reassign them from New ==&gt; TO OLD. (And we only bother if they aren&#39;t the same Nym.)</span>
        <span class="comment">//</span>
<span class="comment">//      if (false == theNewNym.CompareID(theOldNym)) // Not the same Nym!!</span>
        <span class="comment">//</span>
        <span class="comment">// UPDATE: the above line was moved INSIDE OTToken::ReassignOwnership, FYI.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == pToken-&gt;<a class="code" href="class_o_t_token.html#aa661b16971fbca2e3b4a1c3452e4c030">ReassignOwnership</a>(theNewNym,  <span class="comment">// must be private, if a Nym.</span>
                                               theOldNym)) <span class="comment">// can be public, if a Nym.</span>
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Failed while attempting to re-assign &quot;</span>
                          <span class="stringliteral">&quot;ownership of token during purse merge.\n&quot;</span>, szFunc);
        }
        <span class="keywordflow">else</span> 
        {
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;%s: FYI: Success re-assigning ownership of &quot;</span>
                           <span class="stringliteral">&quot;token during purse merge.\n&quot;</span>, szFunc);
            
            pToken-&gt;<a class="code" href="class_o_t_contract.html#aae54340526fbd8eb8a18de27a4b97c83">ReleaseSignatures</a>();
            pToken-&gt;<a class="code" href="class_o_t_contract.html#abd60037fe655ee8cae9a3ece5d1e2ea6">SignContract</a>(theSigner);
            pToken-&gt;<a class="code" href="class_o_t_contract.html#a363ae430d4fd9256ab8364dbafb95444">SaveContract</a>();
        }
    }
    <span class="comment">// -----------------------------------------------------------</span>
    
    <span class="comment">// At this point, all of the tokens on *this (old purse) AND theNewPurse have been popped, and added</span>
    <span class="comment">// to the temporary map as token pointers, with any duplicates removed.</span>
    <span class="comment">// Also, the tokens on the New Purse have been reassigned (from theNewNym as owner, to theOldNym as</span>
    <span class="comment">// owner) and each has been signed and saved properly, using the old Nym.</span>

    <span class="comment">// -----------------------------------------------------------</span>
    <span class="comment">// Next, we loop through theMap, and Push ALL of those tokens back onto *this. (The old purse.)</span>
    
    <span class="keywordtype">bool</span> bSuccess = <span class="keyword">true</span>;
    
    <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_purse_8hpp.html#ad8b3ba3b9a822e5c01381df2282bb03e">mapOfTokenPointers</a>, theMap)
    {
        <a class="code" href="class_o_t_token.html">OTToken</a> * pToken = (*it).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pToken);
        <span class="comment">// ----------------------------------</span>
        <span class="keywordtype">bool</span> bPush = this-&gt;<a class="code" href="class_o_t_purse.html#a1494538d965842e3fa3d1b9ac2b6dd25">Push</a>(theOldNym, <span class="comment">// can be public, if a Nym.</span>
                                *pToken);  <span class="comment">// The purse makes it&#39;s own copy of the token, into string form.</span>
        
        <span class="keywordflow">if</span> (!bPush)
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Failure pushing token into purse.\n&quot;</span>, szFunc);
            bSuccess = <span class="keyword">false</span>;
        }
        <span class="comment">// Notice we don&#39;t break here if 1 token fails -- we loop through them all.</span>
        <span class="comment">// Maybe shouldn&#39;t? Seems right somehow.</span>
    }
    <span class="comment">// -----------------------------------------------------</span>
    <span class="comment">// Next I clean up all the tokens out of the temporary map, since they will leak otherwise.</span>
    <span class="comment">//</span>
    <span class="keywordflow">while</span> (!theMap.empty())
    {       
        <a class="code" href="class_o_t_token.html">OTToken</a> * pToken = theMap.begin()-&gt;second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pToken);
        <span class="comment">// ---------------------------</span>
        <span class="keyword">delete</span> pToken; pToken = NULL;
        <span class="comment">// ---------------------------</span>
        theMap.erase(theMap.begin());
    }
    <span class="comment">// -----------------------------------------------------</span>
    
    <span class="comment">// Note: Caller needs to re-sign and re-save this purse, since we aren&#39;t doing it</span>
    <span class="comment">// internally here.</span>
    
    <span class="keywordflow">return</span> bSuccess;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa6a65c5da7a399e50efa13eb9599a12b"></a><!-- doxytag: member="OTPurse::Peek" ref="aa6a65c5da7a399e50efa13eb9599a12b" args="(OTNym_or_SymmetricKey theOwner) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_token.html">OTToken</a> * <a class="el" href="class_o_t_purse.html#aa6a65c5da7a399e50efa13eb9599a12b">OTPurse::Peek</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a>&#160;</td>
          <td class="paramname"><em>theOwner</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01331">1331</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.empty())
        <span class="keywordflow">return</span> NULL;
    <span class="comment">// ---------------</span>
    <span class="comment">// Grab a pointer to the first armored token on the deque.</span>
    <span class="comment">//</span>
    <span class="keyword">const</span> <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> * pArmor =  <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.front();
    <span class="comment">// ---------------  </span>
    <span class="comment">// Copy the token contents into an Envelope.</span>
    <a class="code" href="class_o_t_envelope.html">OTEnvelope</a> theEnvelope(*pArmor);
    <span class="comment">// ---------------</span>
    <span class="comment">// Open the envelope into a string.</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strToken;
    <span class="keyword">const</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strDisplay(__FUNCTION__); <span class="comment">// this is the passphrase string that will display if theOwner doesn&#39;t have one already.</span>
    <span class="comment">// ---------------</span>
    <span class="keyword">const</span> <span class="keywordtype">bool</span> bSuccess = theOwner.<a class="code" href="class_o_t_nym__or___symmetric_key.html#a1c32b029ccef668d2058d54bc69f1b00">Open_or_Decrypt</a>(theEnvelope, strToken, &amp;strDisplay);
    <span class="comment">// ---------------</span>
    <span class="keywordflow">if</span> (bSuccess)
    {
        <span class="comment">// Create a new token with the same server and asset IDs as this purse.</span>
        <a class="code" href="class_o_t_token.html">OTToken</a> * pToken = <a class="code" href="class_o_t_token.html#ac758de04ed60991098005a7ac9578d71">OTToken::TokenFactory</a>(strToken, *<span class="keyword">this</span>);
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pToken);
        
        <span class="keywordflow">if</span> (pToken-&gt;<a class="code" href="class_o_t_instrument.html#a1f6c7b528680d84dcb998d473bdd99a6">GetAssetID</a>()  != <a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a> ||
            pToken-&gt;<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>() != <a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>)
        {
            <span class="keyword">delete</span> pToken;
            pToken = NULL;
            
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: ERROR: Cash token with wrong server or asset type.\n&quot;</span>, __FUNCTION__);
        }
        <span class="keywordflow">else</span> 
        {
            <span class="comment">// CALLER is responsible to delete this token.</span>
            <span class="keywordflow">return</span> pToken;
        }
    }
    <span class="keywordflow">else</span>
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure: theOwner.Open_or_Decrypt.\n&quot;</span>, __FUNCTION__);

    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a84b70b093c79a796815d9a42c8d3bd74"></a><!-- doxytag: member="OTPurse::Pop" ref="a84b70b093c79a796815d9a42c8d3bd74" args="(OTNym_or_SymmetricKey theOwner)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_token.html">OTToken</a> * <a class="el" href="class_o_t_purse.html#a84b70b093c79a796815d9a42c8d3bd74">OTPurse::Pop</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a>&#160;</td>
          <td class="paramname"><em>theOwner</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01387">1387</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.empty())
        <span class="keywordflow">return</span> NULL;
    <span class="comment">// ---------------</span>
    <a class="code" href="class_o_t_token.html">OTToken</a> * pToken = this-&gt;<a class="code" href="class_o_t_purse.html#aa6a65c5da7a399e50efa13eb9599a12b">Peek</a>(theOwner);
    <span class="comment">// ---------------</span>
    <span class="keywordflow">if</span> (NULL == pToken)
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure: this-&gt;Peek(theOwner) &quot;</span>
                      <span class="stringliteral">&quot;(And m_dequeTokens isn&#39;t empty, either.)\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> NULL;
    }
    <span class="comment">// ---------------</span>
    <span class="comment">// Grab a pointer to the ascii-armored token, and remove it from the deque.</span>
    <span class="comment">// (And delete it.)</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> * pArmor =  <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.front();
    <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.pop_front();
    <span class="keyword">delete</span> pArmor; pArmor = NULL;   
    <span class="comment">// -----------------------------------</span>
    <span class="comment">// We keep track of the purse&#39;s total value.</span>
    <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a> -= pToken-&gt;<a class="code" href="class_o_t_token.html#a4e17470c475313139d1ed975e6c26b5a">GetDenomination</a>();
    <span class="comment">// -----------------------------------</span>
    <span class="comment">// We keep track of the purse&#39;s expiration dates, based on the tokens within.</span>
    <span class="comment">//</span>
<span class="comment">//    OT_ASSERT(pToken-&gt;GetValidFrom() &lt;= m_tLatestValidFrom); // If the token&#39;s was larger, then the purse&#39;s should match it already.</span>
<span class="comment">//    OT_ASSERT(pToken-&gt;GetValidTo()   &gt;= m_tEarliestValidTo); // If the token&#39;s was smaller, then the purse&#39;s should match it already.</span>

    <span class="comment">// NOTE: the above asserts were commented out because the below call to RecalculateExpirationDates</span>
    <span class="comment">// was commented out (because without recalculating those dates when tokens are removed, these asserts</span>
    <span class="comment">// would get triggered.)</span>
    
    <span class="keywordflow">if</span> ((pToken-&gt;<a class="code" href="class_o_t_instrument.html#a08eb5f25566832e1a67b3e33c0dcc13f">GetValidFrom</a>() == <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a>) ||
        (pToken-&gt;<a class="code" href="class_o_t_instrument.html#ab83a62f51692c946ff394408026b0c18">GetValidTo</a>()   == <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>))
    {
<span class="comment">//      RecalculateExpirationDates(theOwner);</span>
    }
    <span class="comment">// -----------------------------------</span>
    <span class="comment">// CALLER is responsible to delete this token.</span>
    <span class="keywordflow">return</span> pToken;
}
</pre></div>
</div>
</div>
<a class="anchor" id="acb88fe42551654113b9d142db4cb4a9a"></a><!-- doxytag: member="OTPurse::ProcessXMLNode" ref="acb88fe42551654113b9d142db4cb4a9a" args="(irr::io::IrrXMLReader *&amp;xml)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t <a class="el" href="class_o_t_purse.html#acb88fe42551654113b9d142db4cb4a9a">OTPurse::ProcessXMLNode</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceirr_1_1io.html#a1628edbb9d5d53f18c82d2a92b0ad27e">irr::io::IrrXMLReader</a> *&amp;&#160;</td>
          <td class="paramname"><em>xml</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_contract.html#a48611c37c8e8e7d9125238bda2b77978">OTContract</a>.</p>

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01006">1006</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <span class="keywordtype">char</span> *szFunc = <span class="stringliteral">&quot;OTPurse::ProcessXMLNode&quot;</span>;
    <span class="comment">// -----------------------</span>
    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strNodeName(xml-&gt;getNodeName());
        
    <span class="keywordflow">if</span> (strNodeName.Compare(<span class="stringliteral">&quot;purse&quot;</span>))
    {   
        <a class="code" href="class_o_t_contract.html#aa0d889e0e1670b56fedca245041a5ed3">m_strVersion</a> = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;version&quot;</span>);
        <span class="comment">// ---------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strTotalValue = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;totalValue&quot;</span>);
        
        <span class="keywordflow">if</span> (strTotalValue.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>() &amp;&amp; (atol(strTotalValue.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>()) &gt; 0))
            <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a> = atol(strTotalValue.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
        <span class="keywordflow">else</span>
            <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a> = 0;
        <span class="comment">// ---------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> str_valid_from = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;validFrom&quot;</span>);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> str_valid_to   = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;validTo&quot;</span>);
        
        <span class="keywordflow">if</span> (str_valid_from.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
        {
            int64_t lValidFrom = str_valid_from.<a class="code" href="class_o_t_string.html#a18ca8f42f6e90ab7801c019611d9dca8">ToLong</a>();

            <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a> = <a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(lValidFrom);
        }
        <span class="keywordflow">if</span> (str_valid_to.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
        {
            int64_t lValidTo = str_valid_to.<a class="code" href="class_o_t_string.html#a18ca8f42f6e90ab7801c019611d9dca8">ToLong</a>();

            <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a> = <a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(lValidTo);
        }
        <span class="comment">// ---------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strPasswdProtected  = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;isPasswordProtected&quot;</span>);
        <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a> = strPasswdProtected.<a class="code" href="class_o_t_string.html#a03401b39fb66d63696342c4f61ea8bf5">Compare</a>(<span class="stringliteral">&quot;true&quot;</span>);
        <span class="comment">// ---------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strNymIDIncluded = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;isNymIDIncluded&quot;</span>);
        <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a> = strNymIDIncluded.<a class="code" href="class_o_t_string.html#a03401b39fb66d63696342c4f61ea8bf5">Compare</a>(<span class="stringliteral">&quot;true&quot;</span>);
        <span class="comment">// ---------------------------------</span>
        <span class="comment">// TODO security: Might want to verify the server ID here, if it&#39;s already set.</span>
        <span class="comment">// Just to make sure it&#39;s the one we were expecting.</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strServerID      = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;serverID&quot;</span>);
        <span class="keywordflow">if</span> (strServerID.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
            <a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>.<a class="code" href="class_o_t_identifier.html#ae29aa1245d3831a207aabc9b8a493bfc">SetString</a>(strServerID);
        <span class="keywordflow">else</span>
        {
            <a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>.<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>();
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed loading serverID, when one was expected.\n&quot;</span>, szFunc);
            <span class="keywordflow">return</span> (-1);
        }
        <span class="comment">// ---------------------------------</span>
        <span class="comment">// TODO security: Might want to verify the asset ID here, if it&#39;s already set.</span>
        <span class="comment">// Just to make sure it&#39;s the one we were expecting.</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strAssetTypeID   = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;assetTypeID&quot;</span>);
        <span class="keywordflow">if</span> (strAssetTypeID.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
            <a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>.<a class="code" href="class_o_t_identifier.html#ae29aa1245d3831a207aabc9b8a493bfc">SetString</a>(strAssetTypeID);
        <span class="keywordflow">else</span>
        {
            <a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>.<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>();
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed loading assetTypeID, when one was expected.\n&quot;</span>, szFunc);
            <span class="keywordflow">return</span> (-1);
        }
        <span class="comment">// ---------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strUserID    = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;userID&quot;</span>); <span class="comment">// (May not exist.)</span>
        <span class="keywordflow">if</span> (<a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>) <span class="comment">// Nym ID **is** included.  (It&#39;s optional. Even if you use one, you don&#39;t have to list it.)</span>
        {
            <span class="keywordflow">if</span> (strUserID.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
                <a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>.<a class="code" href="class_o_t_identifier.html#ae29aa1245d3831a207aabc9b8a493bfc">SetString</a>(strUserID);
            <span class="keywordflow">else</span>
            {
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed loading userID, when one was expected. &quot;</span>
                              <span class="stringliteral">&quot;(isNymIDIncluded was true.)\n&quot;</span>, szFunc);
                <a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>.<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>();
                <span class="keywordflow">return</span> (-1);
            }
        }
        <span class="keywordflow">else</span><span class="comment">// UserID SUPPOSED to be blank here. (Thus the Release.) Maybe later,</span>
            <span class="comment">// we might consider trying to read it, in order to validate this.</span>
            <span class="comment">//</span>
            <a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>.<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>(); <span class="comment">// For now, just assume it&#39;s not there to be read, and Release my own value to match it.</span>
        <span class="comment">// ---------------------------------        </span>
            
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(4, <span class="stringliteral">&quot;%s: Loaded purse... (%s)\n ServerID: %s\n UserID: %s\n Asset ID: %s\n----------\n&quot;</span>,
                       szFunc, (<a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a> ? <span class="stringliteral">&quot;Password-protected&quot;</span> : <span class="stringliteral">&quot;NOT password-protected&quot;</span>),
                       strServerID.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(), <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a> ? strUserID.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>() : <span class="stringliteral">&quot;&quot;</span>,
                       strAssetTypeID.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());

        <span class="keywordflow">return</span> 1;
    }
    <span class="comment">// ----------------------------------------------</span>

    <span class="comment">// Sometimes you want the purse to have a passphrase on it, without being attached to</span>
    <span class="comment">// one of your actual Nyms in your wallet. To accommodate this, OT creates a symmetric key</span>
    <span class="comment">// and stashes it INSIDE the purse. This symmetric key can have whatever passphrase you want.</span>
    <span class="comment">// There is also a master key attached, which allows for passphrase timeouts on the symmetric key.</span>
    <span class="comment">// Therefore internalKey and cachedKey will both be attached to the purse (or neither will be.)</span>
    <span class="comment">//</span>
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strNodeName.Compare(<span class="stringliteral">&quot;internalKey&quot;</span>)) 
    {
        <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>) <span class="comment">// If we&#39;re NOT using the internal key, then why am I in the middle of loading one here?</span>
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Unexpected &#39;internalKey&#39; data, &quot;</span>
                          <span class="stringliteral">&quot;since m_bPasswordProtected is set to false!\n&quot;</span>, szFunc);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        <span class="comment">// ----------------------------------------------------</span>
        <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>.<a class="code" href="class_o_t_data.html#a947528765516223eb03bee7745eb8c07">IsEmpty</a>()) <span class="comment">// If the UserID isn&#39;t empty, then why am I in the middle of loading an internal Key?</span>
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Unexpected &#39;internalKey&#39; data, since m_UserID is not blank! &quot;</span>
                         <span class="stringliteral">&quot;(The UserID should have loaded before THIS node ever popped up...)\n&quot;</span>, szFunc);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        <span class="comment">// ----------------------------------------------------</span>
        <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a>  ascValue;
        
        <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#a72ffe11fdcf2f6e3566afa9061241f30">OTContract::LoadEncodedTextField</a>(xml, ascValue) ||
            !ascValue.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Expected %s element to have text field.\n&quot;</span>,
                          szFunc, <span class="stringliteral">&quot;internalKey&quot;</span>);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        <span class="comment">// ----------------------------------------------------</span>
        <span class="comment">//</span>
        <span class="comment">// Let&#39;s see if the internal key is already loaded somehow... (Shouldn&#39;t be...)</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (NULL != <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>)
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: WARNING: While loading internal Key for a purse, &quot;</span>
                         <span class="stringliteral">&quot;noticed the pointer was ALREADY set! (I&#39;m deleting old one to make room, &quot;</span>
                          <span class="stringliteral">&quot;and then allowing this one to load instead...)\n&quot;</span>, szFunc);
<span class="comment">//          return (-1); // error condition</span>
            
            <span class="keyword">delete</span> <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>;
            <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a> = NULL;
        }
        <span class="comment">// ----------------------------------------------------</span>
        <span class="comment">//</span>
        <span class="comment">// By this point, I&#39;ve loaded up the string containing the encrypted symmetric key.</span>
        <span class="comment">// I also know that m_bPasswordProtected is set to true, and I know that m_pSymmetricKey is NULL.</span>
        <span class="comment">//</span>
        <span class="comment">// (It&#39;s only now that I bother instantiating.)</span>
        <span class="comment">//</span>
        <a class="code" href="class_o_t_symmetric_key.html">OTSymmetricKey</a> * pSymmetricKey = <span class="keyword">new</span> <a class="code" href="class_o_t_symmetric_key.html">OTSymmetricKey</a>();
        <a class="code" href="_o_t_assert_8hpp.html#a033b133f48e61f2b227c52ad2be0c882">OT_ASSERT_MSG</a>(NULL != pSymmetricKey, <span class="stringliteral">&quot;OTPurse::ProcessXMLNode: Assert: NULL != new OTSymmetricKey \n&quot;</span>);
        <span class="comment">// -----------------</span>
        <span class="comment">// NOTE: In the event of any error, need to delete pSymmetricKey before returning.</span>
        <span class="comment">// (Or it will leak.)</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (!pSymmetricKey-&gt;<a class="code" href="class_o_t_symmetric_key.html#ac1a0a93da93305492ecebca03110a954">SerializeFrom</a>(ascValue))
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: While loading internal Key for a purse, failed &quot;</span>
                          <span class="stringliteral">&quot;serializing from stored string! (Failed loading purse.)\n&quot;</span>, szFunc);
            <span class="keyword">delete</span> pSymmetricKey; pSymmetricKey = NULL;
            <span class="keywordflow">return</span> (-1);
        }
        <span class="comment">// -----------------</span>
        <span class="comment">// By this point, the symmetric key has loaded successfully from storage.</span>

        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;%s: Successfully loaded a purse&#39;s internal key.\n&quot;</span>, szFunc);
        <span class="comment">// -----------------</span>
        <span class="comment">// No more worry about pSymmetricKey cleanup, now that this pointer is set.</span>

        <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a> = pSymmetricKey;
        <span class="comment">// -----------------</span>
        <span class="keywordflow">return</span> 1;
    }
    <span class="comment">// ----------------------------------------------</span>
    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strNodeName.Compare(<span class="stringliteral">&quot;cachedKey&quot;</span>))
    {
        <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>) <span class="comment">// If we&#39;re NOT using the internal and master keys, then why am I in the middle of loading one here?</span>
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Unexpected &#39;cachedKey&#39; data, &quot;</span>
                          <span class="stringliteral">&quot;since m_bPasswordProtected is set to false!\n&quot;</span>, szFunc);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        <span class="comment">// ----------------------------------------------------</span>
        <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>.<a class="code" href="class_o_t_data.html#a947528765516223eb03bee7745eb8c07">IsEmpty</a>()) <span class="comment">// If the UserID isn&#39;t empty, then why am I in the middle of loading an internal Key?</span>
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Unexpected &#39;cachedKey&#39; data, since m_UserID is not blank!\n&quot;</span>, szFunc);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        <span class="comment">// ----------------------------------------------------</span>
        <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a>  ascValue;
        
        <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#a72ffe11fdcf2f6e3566afa9061241f30">OTContract::LoadEncodedTextField</a>(xml, ascValue) ||
            !ascValue.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Expected %s element to have text field.\n&quot;</span>,
                          szFunc, <span class="stringliteral">&quot;cachedKey&quot;</span>);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        <span class="comment">// ----------------------------------------------------</span>
        <span class="comment">//</span>
        <span class="comment">// Let&#39;s see if the master key is already loaded somehow... (Shouldn&#39;t be...)</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>)
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: WARNING: While loading master Key for a purse, &quot;</span>
                         <span class="stringliteral">&quot;noticed the pointer was ALREADY set! (I&#39;m deleting old one to make room, &quot;</span>
                          <span class="stringliteral">&quot;and then allowing this one to load instead...)\n&quot;</span>, szFunc);
<span class="comment">//          return (-1); // error condition</span>
            
            <a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>.reset();
        }
        <span class="comment">// ----------------------------------------------------</span>
        <span class="comment">//</span>
        <span class="comment">// By this point, I&#39;ve loaded up the string containing the encrypted symmetric key.</span>
        <span class="comment">// I also know that m_bPasswordProtected is set to true, and I know that m_pSymmetricKey is NULL.</span>
        <span class="comment">//</span>
        <span class="comment">// (It&#39;s only now that I bother instantiating.)</span>
        <span class="comment">//</span>
        _SharedPtr&lt;OTCachedKey&gt; pCachedKey(<span class="keyword">new</span> <a class="code" href="class_o_t_cached_key.html">OTCachedKey</a>(ascValue));
<span class="comment">//        OT_ASSERT_MSG(NULL != pCachedKey, &quot;OTPurse::ProcessXMLNode: Assert: NULL != new OTCachedKey \n&quot;);</span>
        <span class="comment">// -----------------</span>
        <span class="comment">// NOTE: In the event of any error, need to delete pCachedKey before returning.</span>
        <span class="comment">// (Or it will leak.)</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (!pCachedKey-&gt;SerializeFrom(ascValue))
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: While loading master Key for a purse, failed &quot;</span>
                          <span class="stringliteral">&quot;serializing from stored string! (Failed loading purse.)\n&quot;</span>, szFunc);
<span class="comment">//            delete pCachedKey; pCachedKey = NULL;</span>
            <span class="keywordflow">return</span> (-1);
        }
        <span class="comment">// -----------------</span>
        <span class="comment">// By this point, the symmetric key has loaded successfully from storage.</span>

        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;%s: Successfully loaded a purse&#39;s master key.\n&quot;</span>, szFunc);
        <span class="comment">// -----------------</span>
        <span class="comment">// No more worry about pSymmetricKey cleanup, now that this pointer is set.</span>

        <a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a> = pCachedKey;
        
        <span class="comment">// NOTE: Hereafter, do NOT use m_pCachedKey directly.</span>
        <span class="comment">// Instead, use OTCachedKey::It(*m_pCachedKey) (So you deal with the cached</span>
        <span class="comment">// version, and avoid forcing the user to re-type his passphrase more than</span>
        <span class="comment">// necessary according to timeouts designed in OTCachedKey class.)</span>
        <span class="comment">//</span>
        <span class="comment">// In fact, don&#39;t even use that. Instead, I&#39;ll add an OTPurse::GetPassphrase</span>
        <span class="comment">// method, which handles that for you.</span>
        <span class="comment">// -----------------</span>
        <span class="keywordflow">return</span> 1;
    }
    <span class="comment">// ----------------------------------------------</span>

    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strNodeName.Compare(<span class="stringliteral">&quot;token&quot;</span>)) 
    {       
        <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> * pArmor = <span class="keyword">new</span> <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a>;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pArmor);
        
        <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#a72ffe11fdcf2f6e3566afa9061241f30">OTContract::LoadEncodedTextField</a>(xml, *pArmor) || !pArmor-&gt;<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: token field without value.\n&quot;</span>, szFunc);
            
            <span class="keyword">delete</span> pArmor;
            pArmor = NULL;
            
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        <span class="keywordflow">else</span> 
        {           
            <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.push_front(pArmor);
        }
        
        <span class="keywordflow">return</span> 1;
    }
    <span class="comment">// ----------------------------------------------</span>

    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac6779fce5508f7d2dc2e02c22595d7e0"></a><!-- doxytag: member="OTPurse::PurseFactory" ref="ac6779fce5508f7d2dc2e02c22595d7e0" args="(OTString strInput)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html">OTPurse</a> * <a class="el" href="class_o_t_purse.html#ac6779fce5508f7d2dc2e02c22595d7e0">OTPurse::PurseFactory</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_string.html">OTString</a>&#160;</td>
          <td class="paramname"><em>strInput</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00613">613</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">//  const char * szFunc = &quot;OTPurse::PurseFactory&quot;;</span>
    <span class="comment">// --------------------------------------------------------------------</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strContract, strFirstLine; <span class="comment">// output for the below function.</span>
    <span class="keyword">const</span> <span class="keywordtype">bool</span> bProcessed = <a class="code" href="class_o_t_contract.html#a00d55a1901fa72acbbe9271b7c984d37">OTContract::DearmorAndTrim</a>(strInput, strContract, strFirstLine);
    <span class="comment">// --------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (bProcessed)
    {
        <a class="code" href="class_o_t_purse.html">OTPurse</a> * pPurse = <a class="code" href="class_o_t_purse.html#a5819d325b8fdfcda7ab2325d21705307">OTPurse::LowLevelInstantiate</a>(strFirstLine);
        
        <span class="comment">// The string didn&#39;t match any of the options in the factory.</span>
        <span class="keywordflow">if</span> (NULL == pPurse)
            <span class="keywordflow">return</span> NULL;
        
        <span class="comment">// Does the contract successfully load from the string passed in?</span>
        <span class="keywordflow">if</span> (pPurse-&gt;<a class="code" href="class_o_t_contract.html#a36300e34dcd94ed7006d98b392d46815">LoadContractFromString</a>(strContract))
            <span class="keywordflow">return</span> pPurse;
        <span class="keywordflow">else</span>
            <span class="keyword">delete</span> pPurse;
    }
    
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0f000661383e960d0e728f7af8d3d29b"></a><!-- doxytag: member="OTPurse::PurseFactory" ref="a0f000661383e960d0e728f7af8d3d29b" args="(OTString strInput, const OTIdentifier &amp;SERVER_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html">OTPurse</a> * <a class="el" href="class_o_t_purse.html#ac6779fce5508f7d2dc2e02c22595d7e0">OTPurse::PurseFactory</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_string.html">OTString</a>&#160;</td>
          <td class="paramname"><em>strInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00574">574</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFunc = <span class="stringliteral">&quot;OTPurse::PurseFactory&quot;</span>;
    <span class="comment">// --------------------------------------------------------------------</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strContract, strFirstLine; <span class="comment">// output for the below function.</span>
    <span class="keyword">const</span> <span class="keywordtype">bool</span> bProcessed = <a class="code" href="class_o_t_contract.html#a00d55a1901fa72acbbe9271b7c984d37">OTContract::DearmorAndTrim</a>(strInput, strContract, strFirstLine);
    <span class="comment">// --------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (bProcessed)
    {
        <a class="code" href="class_o_t_purse.html">OTPurse</a> * pPurse = <a class="code" href="class_o_t_purse.html#a5819d325b8fdfcda7ab2325d21705307">OTPurse::LowLevelInstantiate</a>(strFirstLine, SERVER_ID);
        
        <span class="comment">// The string didn&#39;t match any of the options in the factory.</span>
        <span class="keywordflow">if</span> (NULL == pPurse)
            <span class="keywordflow">return</span> NULL;
        
        <span class="comment">// Does the contract successfully load from the string passed in?</span>
        <span class="keywordflow">if</span> (pPurse-&gt;<a class="code" href="class_o_t_contract.html#a36300e34dcd94ed7006d98b392d46815">LoadContractFromString</a>(strContract))
        {
            <span class="keywordflow">if</span> (SERVER_ID != pPurse-&gt;<a class="code" href="class_o_t_purse.html#aa6b026618394154f1a7f80064a5e6c50">GetServerID</a>())
            {
                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strServerID(SERVER_ID), strPurseServerID(pPurse-&gt;<a class="code" href="class_o_t_purse.html#aa6b026618394154f1a7f80064a5e6c50">GetServerID</a>());
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure: ServerID on purse (%s) doesn&#39;t match expected &quot;</span>
                              <span class="stringliteral">&quot;server ID (%s).\n&quot;</span>, szFunc, strPurseServerID.Get(), strServerID.Get());
                <span class="keyword">delete</span> pPurse; pPurse = NULL;
            }
            <span class="keywordflow">else</span>
                <span class="keywordflow">return</span> pPurse;
        }
        <span class="keywordflow">else</span>
        {
            <span class="keyword">delete</span> pPurse; pPurse = NULL;
        }
    }
    
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1d619a34a0d375339daa51f5dc82dbfc"></a><!-- doxytag: member="OTPurse::PurseFactory" ref="a1d619a34a0d375339daa51f5dc82dbfc" args="(OTString strInput, const OTIdentifier &amp;SERVER_ID, const OTIdentifier &amp;ASSET_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_purse.html">OTPurse</a> * <a class="el" href="class_o_t_purse.html#ac6779fce5508f7d2dc2e02c22595d7e0">OTPurse::PurseFactory</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_string.html">OTString</a>&#160;</td>
          <td class="paramname"><em>strInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>ASSET_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00525">525</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFunc = <span class="stringliteral">&quot;OTPurse::PurseFactory&quot;</span>;
    <span class="comment">// --------------------------------------------------------------------</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strContract, strFirstLine; <span class="comment">// output for the below function.</span>
    <span class="keyword">const</span> <span class="keywordtype">bool</span> bProcessed = <a class="code" href="class_o_t_contract.html#a00d55a1901fa72acbbe9271b7c984d37">OTContract::DearmorAndTrim</a>(strInput, strContract, strFirstLine);
    <span class="comment">// --------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (bProcessed)
    {
        <a class="code" href="class_o_t_purse.html">OTPurse</a> * pPurse = <a class="code" href="class_o_t_purse.html#a5819d325b8fdfcda7ab2325d21705307">OTPurse::LowLevelInstantiate</a>(strFirstLine, SERVER_ID, ASSET_ID);
        
        <span class="comment">// The string didn&#39;t match any of the options in the factory.</span>
        <span class="keywordflow">if</span> (NULL == pPurse)
            <span class="keywordflow">return</span> NULL;
        
        <span class="comment">// Does the contract successfully load from the string passed in?</span>
        <span class="keywordflow">if</span> (pPurse-&gt;<a class="code" href="class_o_t_contract.html#a36300e34dcd94ed7006d98b392d46815">LoadContractFromString</a>(strContract))
        {
            <span class="keywordflow">if</span> (SERVER_ID != pPurse-&gt;<a class="code" href="class_o_t_purse.html#aa6b026618394154f1a7f80064a5e6c50">GetServerID</a>())
            {
                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strServerID(SERVER_ID), strPurseServerID(pPurse-&gt;<a class="code" href="class_o_t_purse.html#aa6b026618394154f1a7f80064a5e6c50">GetServerID</a>());
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure: ServerID on purse (%s) doesn&#39;t match expected &quot;</span>
                              <span class="stringliteral">&quot;server ID (%s).\n&quot;</span>, szFunc, strPurseServerID.Get(), strServerID.Get());
                <span class="keyword">delete</span> pPurse; pPurse = NULL;
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ASSET_ID != pPurse-&gt;<a class="code" href="class_o_t_purse.html#af87e5b076d8d738e6b32e56cc49737c1">GetAssetID</a>())
            {
                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strAssetID(ASSET_ID), strPurseAssetID(pPurse-&gt;<a class="code" href="class_o_t_purse.html#af87e5b076d8d738e6b32e56cc49737c1">GetAssetID</a>());
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure: AssetID on purse (%s) doesn&#39;t match expected &quot;</span>
                              <span class="stringliteral">&quot;asset ID (%s).\n&quot;</span>, szFunc, strPurseAssetID.Get(), strAssetID.Get());
                <span class="keyword">delete</span> pPurse; pPurse = NULL;
            }
            <span class="keywordflow">else</span>
                <span class="keywordflow">return</span> pPurse;
        }
        <span class="keywordflow">else</span>
        {
            <span class="keyword">delete</span> pPurse; pPurse = NULL;
        }
    }
    
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1494538d965842e3fa3d1b9ac2b6dd25"></a><!-- doxytag: member="OTPurse::Push" ref="a1494538d965842e3fa3d1b9ac2b6dd25" args="(OTNym_or_SymmetricKey theOwner, const OTToken &amp;theToken)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#a1494538d965842e3fa3d1b9ac2b6dd25">OTPurse::Push</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a>&#160;</td>
          <td class="paramname"><em>theOwner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_token.html">OTToken</a> &amp;&#160;</td>
          <td class="paramname"><em>theToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01484">1484</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (theToken.<a class="code" href="class_o_t_instrument.html#a1f6c7b528680d84dcb998d473bdd99a6">GetAssetID</a>() == <a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>)
    {
        <span class="keyword">const</span>
        <a class="code" href="class_o_t_string.html">OTString</a> strDisplay(__FUNCTION__); <span class="comment">// this is the passphrase string that will display if theOwner doesn&#39;t have one already.</span>
        <span class="comment">// -----------------------------------</span>
        <a class="code" href="class_o_t_string.html">OTString</a> strToken(theToken);
        <a class="code" href="class_o_t_envelope.html">OTEnvelope</a> theEnvelope;
        <span class="keyword">const</span> <span class="keywordtype">bool</span> bSuccess = theOwner.<a class="code" href="class_o_t_nym__or___symmetric_key.html#a5ce503bc2494e269fcdb639d559a89c7">Seal_or_Encrypt</a>(theEnvelope, strToken, &amp;strDisplay);
        <span class="comment">// -----------------------------------      </span>
        <span class="keywordflow">if</span> (bSuccess)
        {
            <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> * pArmor = <span class="keyword">new</span> <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a>(theEnvelope);

            <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.push_front(pArmor);
            <span class="comment">// -----------------------------------</span>
            <span class="comment">// We keep track of the purse&#39;s total value.</span>
            <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a> += theToken.<a class="code" href="class_o_t_token.html#a4e17470c475313139d1ed975e6c26b5a">GetDenomination</a>();
            <span class="comment">// -----------------------------------</span>
            <span class="comment">// We keep track of the expiration dates for the purse, based on the tokens within.</span>
            <span class="comment">//</span>
            <span class="keywordflow">if</span> (<a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a> &lt; theToken.<a class="code" href="class_o_t_instrument.html#a08eb5f25566832e1a67b3e33c0dcc13f">GetValidFrom</a>())
            {
                <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a> = theToken.<a class="code" href="class_o_t_instrument.html#a08eb5f25566832e1a67b3e33c0dcc13f">GetValidFrom</a>();
            }
            <span class="comment">// -----------------------------------</span>
            <span class="keywordflow">if</span> ((<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a> == <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>) ||
                (<a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a> &gt; theToken.<a class="code" href="class_o_t_instrument.html#ab83a62f51692c946ff394408026b0c18">GetValidTo</a>()))
            {
                <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a> = theToken.<a class="code" href="class_o_t_instrument.html#ab83a62f51692c946ff394408026b0c18">GetValidTo</a>();
            }
            <span class="comment">// -----------------------------------</span>
            <span class="keywordflow">if</span> (<a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a> &gt; <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>)
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: WARNING: This purse has a &#39;valid from&#39; date LATER than the &#39;valid to&#39; date. &quot;</span>
                              <span class="stringliteral">&quot;(due to different tokens with different date ranges...)\n&quot;</span>, __FUNCTION__);
                
            <span class="comment">// -----------------------------------</span>
            <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="class_o_t_string.html">OTString</a> strPurseAssetType(<a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>), strTokenAssetType(theToken.<a class="code" href="class_o_t_instrument.html#a1f6c7b528680d84dcb998d473bdd99a6">GetAssetID</a>());
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed while calling: theOwner.Seal_or_Encrypt(theEnvelope, strToken)\nPurse Asset Type:\n%s\n&quot;</span>
                          <span class="stringliteral">&quot;Token Asset Type:\n%s\n&quot;</span>, __FUNCTION__, strPurseAssetType.Get(), strTokenAssetType.Get());
        }
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="class_o_t_string.html">OTString</a> strPurseAssetType(<a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>), strTokenAssetType(theToken.<a class="code" href="class_o_t_instrument.html#a1f6c7b528680d84dcb998d473bdd99a6">GetAssetID</a>());
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: ERROR: Tried to push token with wrong asset type.\nPurse Asset Type:\n%s\n&quot;</span>
                <span class="stringliteral">&quot;Token Asset Type:\n%s\n&quot;</span>, __FUNCTION__, strPurseAssetType.Get(), strTokenAssetType.Get());
    }
    <span class="comment">// ----------------------------------------------</span>
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1a94117cce01914bb52bd923cf983291"></a><!-- doxytag: member="OTPurse::RecalculateExpirationDates" ref="a1a94117cce01914bb52bd923cf983291" args="(OTNym_or_SymmetricKey &amp;theOwner)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_purse.html#a1a94117cce01914bb52bd923cf983291">OTPurse::RecalculateExpirationDates</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_nym__or___symmetric_key.html">OTNym_or_SymmetricKey</a> &amp;&#160;</td>
          <td class="paramname"><em>theOwner</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01431">1431</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a> = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;
    <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a> = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;

    <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_purse_8hpp.html#a394fc17df8d11147a504d41fdf9f7531">dequeOfTokens</a>, <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>)
    {
        <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> * pArmor = *it;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pArmor);
        <span class="comment">// --------------------------</span>
        <a class="code" href="class_o_t_envelope.html">OTEnvelope</a> theEnvelope(*pArmor);
        <span class="comment">// ---------------</span>
        <span class="comment">// Open the envelope into a string.</span>
        <span class="comment">//</span>
        <a class="code" href="class_o_t_string.html">OTString</a> strToken;
        <span class="keyword">const</span>
        <a class="code" href="class_o_t_string.html">OTString</a> strDisplay(__FUNCTION__); <span class="comment">// this is the passphrase string that will display if theOwner doesn&#39;t have one already.</span>
        <span class="comment">// ---------------</span>
        <span class="keyword">const</span> <span class="keywordtype">bool</span> bSuccess = theOwner.<a class="code" href="class_o_t_nym__or___symmetric_key.html#a1c32b029ccef668d2058d54bc69f1b00">Open_or_Decrypt</a>(theEnvelope, strToken, &amp;strDisplay);
        <span class="comment">// ---------------</span>
        <span class="keywordflow">if</span> (bSuccess)
        {
            <span class="comment">// Create a new token with the same server and asset IDs as this purse.</span>
            <a class="code" href="class_o_t_token.html">OTToken</a> * pToken = <a class="code" href="class_o_t_token.html#ac758de04ed60991098005a7ac9578d71">OTToken::TokenFactory</a>(strToken, *<span class="keyword">this</span>);
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pToken);
            <span class="comment">// ---------------</span>
            <span class="keywordflow">if</span> (m_tLatestValidFrom &lt; pToken-&gt;GetValidFrom())
            {
                <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a> = pToken-&gt;<a class="code" href="class_o_t_instrument.html#a08eb5f25566832e1a67b3e33c0dcc13f">GetValidFrom</a>();
            }
            <span class="comment">// -----------------------------------</span>
            <span class="keywordflow">if</span> ((<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a> == <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>) ||
                (<a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a> &gt; pToken-&gt;<a class="code" href="class_o_t_instrument.html#ab83a62f51692c946ff394408026b0c18">GetValidTo</a>()))
            {
                <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a> = pToken-&gt;<a class="code" href="class_o_t_instrument.html#ab83a62f51692c946ff394408026b0c18">GetValidTo</a>();
            }
            <span class="comment">// -----------------------------------</span>
            <span class="keywordflow">if</span> (<a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a> &gt; <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>)
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: WARNING: This purse has a &#39;valid from&#39; date LATER than the &#39;valid to&#39; date. &quot;</span>
                              <span class="stringliteral">&quot;(due to different tokens with different date ranges...)\n&quot;</span>, __FUNCTION__);
            
            <span class="comment">// -----------------------------------</span>
        }
        <span class="keywordflow">else</span>
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure while trying to decrypt a token.\n&quot;</span>, __FUNCTION__);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="afb52ebfc9c608146d5e4aefa25e4e163"></a><!-- doxytag: member="OTPurse::Release" ref="afb52ebfc9c608146d5e4aefa25e4e163" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_purse.html#afb52ebfc9c608146d5e4aefa25e4e163">OTPurse::Release</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_contract.html#a15e423ca0d650858a23e54f8285feae1">OTContract</a>.</p>

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00760">760</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_purse.html#ac4e2350ed948d11ac6376381e6983701">Release_Purse</a>();
    <span class="comment">// -----------------------</span>
    <a class="code" href="class_o_t_contract.html#a15e423ca0d650858a23e54f8285feae1">ot_super::Release</a>();
    
    <a class="code" href="class_o_t_purse.html#a2333bb1f91629c7a01d90ae551a334cb">InitPurse</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac4e2350ed948d11ac6376381e6983701"></a><!-- doxytag: member="OTPurse::Release_Purse" ref="ac4e2350ed948d11ac6376381e6983701" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_purse.html#ac4e2350ed948d11ac6376381e6983701">OTPurse::Release_Purse</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00732">732</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// This sets m_lTotalValue to 0 already.</span>
    <a class="code" href="class_o_t_purse.html#a58a7e237570ec66ab1fb1d7027298ee3">ReleaseTokens</a>();
<span class="comment">//  m_lTotalValue = 0;</span>
    <span class="comment">// -----------------------</span>
    <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a> = <span class="keyword">false</span>;
    <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>   = <span class="keyword">false</span>;
    <span class="comment">// -----------------------</span>
    <span class="comment">// the Temp Nym is when a purse contains its own Nym, created just</span>
    <span class="comment">// for that purse, so that it can be password protected instead of using</span>
    <span class="comment">// one of the real Nyms in your wallet.</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (NULL != <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>)
    {
        <span class="keyword">delete</span> <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>;
        <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a> = NULL;
    }
    <span class="comment">// -----------------------</span>
<span class="comment">//    if (m_pCachedKey)</span>
<span class="comment">//    {</span>
<span class="comment">//        delete m_pCachedKey;</span>
<span class="comment">//        m_pCachedKey = NULL;</span>
<span class="comment">//    }</span>
    <span class="comment">// -----------------------</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a58a7e237570ec66ab1fb1d7027298ee3"></a><!-- doxytag: member="OTPurse::ReleaseTokens" ref="a58a7e237570ec66ab1fb1d7027298ee3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_purse.html#a58a7e237570ec66ab1fb1d7027298ee3">OTPurse::ReleaseTokens</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01554">1554</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> * pArmor = NULL;
    
    <span class="keywordflow">while</span> (!<a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.empty()) {
        pArmor = <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.front();
        <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>.pop_front();
        <span class="keyword">delete</span> pArmor;
    }
    
    <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a> = 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a12ff05c33385bec01a70fb8bacc1833f"></a><!-- doxytag: member="OTPurse::SaveContractWallet" ref="a12ff05c33385bec01a70fb8bacc1833f" args="(std::ofstream &amp;ofs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#a12ff05c33385bec01a70fb8bacc1833f">OTPurse::SaveContractWallet</a> </td>
          <td>(</td>
          <td class="paramtype">std::ofstream &amp;&#160;</td>
          <td class="paramname"><em>ofs</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="class_o_t_contract.html#af16a41ce18a9e3408fc5c9ee18315a30">OTContract</a>.</p>

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01280">1280</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a40b0557a09d2183149dfc7bbd6145e0d"></a><!-- doxytag: member="OTPurse::SavePurse" ref="a40b0557a09d2183149dfc7bbd6145e0d" args="(const char *szServerID=NULL, const char *szUserID=NULL, const char *szAssetTypeID=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#a40b0557a09d2183149dfc7bbd6145e0d">OTPurse::SavePurse</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>szServerID</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>szUserID</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>szAssetTypeID</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00841">841</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(!this-&gt;<a class="code" href="class_o_t_purse.html#a3546f66455d223a482a462c083b5713e">IsPasswordProtected</a>());
    <span class="comment">// -----------------------------------------</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#ab1e11693a38a1673037b1f29c9d84010">m_strFoldername</a>.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
        <a class="code" href="class_o_t_contract.html#ab1e11693a38a1673037b1f29c9d84010">m_strFoldername</a>.<a class="code" href="class_o_t_string.html#aa5db620fe8e60c849585d741975db991">Set</a>(<a class="code" href="class_o_t_folders.html#a2793558f559a595e6e7b7c09cfac28d7">OTFolders::Purse</a>().<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
    <span class="comment">// -----------------------------------------</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strServerID(<a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>), strUserID(<a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>), strAssetTypeID(<a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>);
    
    <span class="keywordflow">if</span> (NULL != szServerID)
        strServerID = szServerID;
    <span class="keywordflow">if</span> (NULL != szUserID)
        strUserID = szUserID;
    <span class="keywordflow">if</span> (NULL != szAssetTypeID)
        strAssetTypeID = szAssetTypeID;
    <span class="comment">// -------------------------------</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#ab7ab1f1fe7ff7e52f2c126404a8f4f92">m_strFilename</a>.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
    {
        <a class="code" href="class_o_t_contract.html#ab7ab1f1fe7ff7e52f2c126404a8f4f92">m_strFilename</a>.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%s%s%s%s%s&quot;</span>, strServerID.Get(), <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), 
                             strUserID.Get(), <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), strAssetTypeID.Get());
    }
    <span class="comment">// --------------------------------------------------------------------</span>
    
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFolder1name  = <a class="code" href="class_o_t_folders.html#a2793558f559a595e6e7b7c09cfac28d7">OTFolders::Purse</a>().<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();     <span class="comment">// purse </span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFolder2name  = strServerID.Get();        <span class="comment">// purse/SERVER_ID</span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFolder3name  = strUserID.Get();          <span class="comment">// purse/SERVER_ID/USER_ID</span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFilename     = strAssetTypeID.Get();     <span class="comment">// purse/SERVER_ID/USER_ID/ASSET_TYPE_ID</span>
        
    <span class="comment">// --------------------------------------------------------------------</span>
    
    <a class="code" href="class_o_t_string.html">OTString</a> strRawFile;
    
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#a5fd00cded794a6f96ba80d8d4081d591">SaveContractRaw</a>(strRawFile))
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;OTPurse::SavePurse: Error saving Pursefile (to string):\n%s%s%s%s%s%s%s\n&quot;</span>, 
                      szFolder1name,
                      <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFolder2name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), 
                      szFolder3name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFilename);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// --------------------------------------------------------------------</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strFinal;
    <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> ascTemp(strRawFile);
    
    <span class="keywordflow">if</span> (<span class="keyword">false</span> == ascTemp.WriteArmoredString(strFinal, <a class="code" href="class_o_t_contract.html#ac523dac7d72b72e54b1ebb5b3a3b21cc">m_strContractType</a>.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>()))
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;OTPurse::SavePurse: Error saving Pursefile (failed writing armored string):\n%s%s%s%s%s%s%s\n&quot;</span>, 
                      szFolder1name,
                      <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFolder2name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), 
                      szFolder3name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFilename);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// --------------------------------------------------------------------</span>
    <span class="keywordtype">bool</span> bSaved = <a class="code" href="namespace_o_t_d_b.html#a7ec0a905bba2c1c8ba5b1e873e12eab4">OTDB::StorePlainString</a>(strFinal.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(), szFolder1name, szFolder2name,  
                                         szFolder3name, szFilename); <span class="comment">// &lt;=== SAVING TO DATA STORE.</span>
    <span class="keywordflow">if</span> (!bSaved)
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;OTPurse::SavePurse: Error writing to file: %s%s%s%s%s%s%s\n&quot;</span>, szFolder1name,
                      <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFolder2name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), 
                      szFolder3name, <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFilename);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// --------------------------------------------------------------------</span>
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac68123e506c676e50fd07c93d6cc1b2d"></a><!-- doxytag: member="OTPurse::UpdateContents" ref="ac68123e506c676e50fd07c93d6cc1b2d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_purse.html#ac68123e506c676e50fd07c93d6cc1b2d">OTPurse::UpdateContents</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_contract.html#a78c28164555e2eb79d6b67698421638d">OTContract</a>.</p>

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l00909">909</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> SERVER_ID(<a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>), USER_ID(<a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>), ASSET_TYPE_ID(<a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>);
    <span class="comment">// ------------------------------------</span>
    int64_t lValidFrom = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(<a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a>);
    int64_t lValidTo = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(<a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>);
    <span class="comment">// ------------------------------------</span>
    <span class="comment">// I release this because I&#39;m about to repopulate it.</span>
    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#abef4b21b2170468705c58d64212d7257">Release</a>();
    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;?xml version=\&quot;%s\&quot;?&gt;\n\n&quot;</span>, <span class="stringliteral">&quot;1.0&quot;</span>);     
    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;purse version=\&quot;%s\&quot;\n&quot;</span>
                              <span class="stringliteral">&quot; totalValue=\&quot;%lld\&quot;\n&quot;</span> <span class="comment">// Total value of all the tokens within.</span>
                              <span class="comment">// --------------</span>
                              <span class="stringliteral">&quot; validFrom=\&quot;%&quot;</span> PRId64<span class="stringliteral">&quot;\&quot;\n&quot;</span> <span class="comment">// Latest &quot;valid from&quot; date of all tokens contained.</span>
                              <span class="stringliteral">&quot; validTo=\&quot;%&quot;</span> PRId64<span class="stringliteral">&quot;\&quot;\n&quot;</span>   <span class="comment">// Earliest &quot;valid to&quot; date of all tokens contained.</span>
                              <span class="comment">// --------------</span>
                              <span class="stringliteral">&quot; isPasswordProtected=\&quot;%s\&quot;\n&quot;</span>
                              <span class="stringliteral">&quot; isNymIDIncluded=\&quot;%s\&quot;\n&quot;</span>
                              <span class="comment">// --------------</span>
                              <span class="stringliteral">&quot; userID=\&quot;%s\&quot;\n&quot;</span>       <span class="comment">// UserID   is optional.</span>
                              <span class="stringliteral">&quot; assetTypeID=\&quot;%s\&quot;\n&quot;</span>  <span class="comment">// assetTypeID required.</span>
                              <span class="stringliteral">&quot; serverID=\&quot;%s\&quot;&gt;\n\n&quot;</span>, <span class="comment">// serverID is required.</span>
                              <span class="comment">// --------------</span>
                              <a class="code" href="class_o_t_contract.html#aa0d889e0e1670b56fedca245041a5ed3">m_strVersion</a>.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(), 
                              <a class="code" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">m_lTotalValue</a>,
                              <span class="comment">// --------------</span>
                              lValidFrom, lValidTo,
                              <span class="comment">// --------------</span>
                              <a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>  ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>,
                              <a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a>    ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>,
                              <span class="comment">// --------------</span>
                              <span class="comment">// USER_ID / NYM_ID of purse owner.</span>
                              <span class="comment">// IF a real NymID (from the user&#39;s wallet) is listed in the purse (which is</span>
                              <span class="comment">// optional--user&#39;s choice) we attach that NymID here...</span>
                              <span class="comment">//</span>
                              (<a class="code" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">m_bIsNymIDIncluded</a> &amp;&amp; !<a class="code" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">m_UserID</a>.<a class="code" href="class_o_t_data.html#a947528765516223eb03bee7745eb8c07">IsEmpty</a>()) <span class="comment">// (Provided that the ID even exists, of course.)</span>
                               ?  <span class="comment">// =====&gt;</span>
                                USER_ID.Get() : <span class="stringliteral">&quot;&quot;</span>, <span class="comment">// Then print the ID (otherwise print an empty string.)</span>
                              (!<a class="code" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">m_AssetID</a>.<a class="code" href="class_o_t_data.html#a947528765516223eb03bee7745eb8c07">IsEmpty</a>())  ? ASSET_TYPE_ID.Get() : <span class="stringliteral">&quot;&quot;</span>, <span class="comment">// (Should never actually be empty.) todo: Change this to just the Get()</span>
                              (!<a class="code" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">m_ServerID</a>.<a class="code" href="class_o_t_data.html#a947528765516223eb03bee7745eb8c07">IsEmpty</a>()) ? SERVER_ID.Get()     : <span class="stringliteral">&quot;&quot;</span>  <span class="comment">// (Should never actually be empty.) todo: Change this to just the Get()</span>
                              );
    <span class="comment">// ----------------------------------------------</span>
    <span class="comment">//</span>
    <span class="comment">// Save the Internal Symmetric Key here (if there IS one.)</span>
    <span class="comment">// (Some Purses own their own internal Symmetric Key, in order to &quot;password protect&quot; the purse.)</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (<a class="code" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">m_bPasswordProtected</a>)
    {
        <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>)
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: m_pCachedKey is unexpectedly NULL, even though &quot;</span>
                          <span class="stringliteral">&quot;m_bPasswordProtected is true!\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NULL == <a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>)
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: m_pSymmetricKey is unexpectedly NULL, even though &quot;</span>
                          <span class="stringliteral">&quot;m_bPasswordProtected is true!\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">else</span> <span class="comment">// m_pCachedKey and m_pSymmetricKey are good pointers. (Or at least, not-null.)</span>
        {
            <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>-&gt;IsGenerated())
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: m_pCachedKey wasn&#39;t a generated key! Even though &quot;</span>
                              <span class="stringliteral">&quot;m_bPasswordProtected is true.\n&quot;</span>, __FUNCTION__);
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>-&gt;<a class="code" href="class_o_t_symmetric_key.html#a9e2eced2ded569ff96ddace6488a7968">IsGenerated</a>())
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: m_pSymmetricKey wasn&#39;t a generated key! Even though &quot;</span>
                              <span class="stringliteral">&quot;m_bPasswordProtected is true.\n&quot;</span>, __FUNCTION__);
            <span class="keywordflow">else</span>
            {
                <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> ascCachedKey, ascSymmetricKey;
                
                <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">m_pCachedKey</a>   -&gt;SerializeTo(ascCachedKey)    || !ascCachedKey   .<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>()  ||
                    !<a class="code" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">m_pSymmetricKey</a>-&gt;<a class="code" href="class_o_t_symmetric_key.html#a9d5d084b9986a338d28d171b8721ac2a">SerializeTo</a>(ascSymmetricKey) || !ascSymmetricKey.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
                    <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: m_pCachedKey or m_pSymmetricKey failed &quot;</span>
                                  <span class="stringliteral">&quot;trying to serialize to OTASCIIArmor.\n&quot;</span>, __FUNCTION__);
                <span class="keywordflow">else</span>
                {
                    <span class="comment">// ascInternalKey is good by this point.</span>
                    <span class="comment">// Therefore, let&#39;s serialize it...</span>
                    <span class="comment">//</span>
                    <span class="comment">// -------------------------------------------</span>
                    <span class="comment">// By this point, ascInternalKey contains the Key itself.</span>
                    <span class="comment">//</span>
                    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;cachedKey&gt;\n%s&lt;/cachedKey&gt;\n\n&quot;</span>,
                                              ascCachedKey.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>()); <span class="comment">// The &quot;password&quot; for the internal symmetric key.</span>
                    
                    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;internalKey&gt;\n%s&lt;/internalKey&gt;\n\n&quot;</span>,
                                              ascSymmetricKey.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>()); <span class="comment">// The internal symmetric key, owned by the purse. ascii-armored.</span>
                }
            }
        }
    }
    <span class="comment">// ---------------------------------------</span>
    <span class="keywordflow">for</span> (int32_t i = 0; i &lt; <a class="code" href="class_o_t_purse.html#a6684af2c27ddb65d259f2b8cbdd6c361">Count</a>(); i++)
    {
        <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;token&gt;\n%s&lt;/token&gt;\n\n&quot;</span>, <a class="code" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">m_dequeTokens</a>[i]-&gt;Get());
    }
    <span class="comment">// ----------------------------------------------</span>
    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;/purse&gt;\n&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="adbd6990754de8d5b2ad9b76b49bdcdee"></a><!-- doxytag: member="OTPurse::VerifyCurrentDate" ref="adbd6990754de8d5b2ad9b76b49bdcdee" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#adbd6990754de8d5b2ad9b76b49bdcdee">OTPurse::VerifyCurrentDate</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8cpp_source.html#l01316">1316</a> of file <a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> CURRENT_TIME =   <a class="code" href="_o_t_common_8hpp.html#a1163606b2546b160d50c5f0a5afe479a">OTTimeGetCurrentTime</a>();
    
    <span class="keywordflow">if</span> ((CURRENT_TIME &gt;= <a class="code" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">m_tLatestValidFrom</a>) &amp;&amp;
        ((CURRENT_TIME &lt;= <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>) || (<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a> == <a class="code" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">m_tEarliestValidTo</a>)))
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a0feb58e5730413cf0ecc73c4c9ea9b5e"></a><!-- doxytag: member="OTPurse::m_AssetID" ref="a0feb58e5730413cf0ecc73c4c9ea9b5e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_identifier.html">OTIdentifier</a> <a class="el" href="class_o_t_purse.html#a0feb58e5730413cf0ecc73c4c9ea9b5e">OTPurse::m_AssetID</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00180">180</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae53038a3afe9de3a32298742a260b053"></a><!-- doxytag: member="OTPurse::m_bIsNymIDIncluded" ref="ae53038a3afe9de3a32298742a260b053" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#ae53038a3afe9de3a32298742a260b053">OTPurse::m_bIsNymIDIncluded</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00193">193</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a29456c80914d5b21d565e2cfa05c8282"></a><!-- doxytag: member="OTPurse::m_bPasswordProtected" ref="a29456c80914d5b21d565e2cfa05c8282" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_purse.html#a29456c80914d5b21d565e2cfa05c8282">OTPurse::m_bPasswordProtected</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00184">184</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="af95a0026bd3a582bfe86e33d526a6a5c"></a><!-- doxytag: member="OTPurse::m_dequeTokens" ref="af95a0026bd3a582bfe86e33d526a6a5c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_o_t_purse_8hpp.html#a394fc17df8d11147a504d41fdf9f7531">dequeOfTokens</a> <a class="el" href="class_o_t_purse.html#af95a0026bd3a582bfe86e33d526a6a5c">OTPurse::m_dequeTokens</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00173">173</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae83c28806ef4ba69740424e299c9e8f6"></a><!-- doxytag: member="OTPurse::m_lTotalValue" ref="ae83c28806ef4ba69740424e299c9e8f6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t <a class="el" href="class_o_t_purse.html#ae83c28806ef4ba69740424e299c9e8f6">OTPurse::m_lTotalValue</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00182">182</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a65933c2a4f0739a93b119be1fe82567a"></a><!-- doxytag: member="OTPurse::m_pCachedKey" ref="a65933c2a4f0739a93b119be1fe82567a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_r1___wrapper_8hpp.html#a4081b6aa22d0f454ce7498756ea212ff">_SharedPtr</a>&lt;<a class="el" href="class_o_t_cached_key.html">OTCachedKey</a>&gt; <a class="el" href="class_o_t_purse.html#a65933c2a4f0739a93b119be1fe82567a">OTPurse::m_pCachedKey</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00196">196</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0dcf71dc8347aa9cc84e36c434127ca1"></a><!-- doxytag: member="OTPurse::m_pSymmetricKey" ref="a0dcf71dc8347aa9cc84e36c434127ca1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_symmetric_key.html">OTSymmetricKey</a>* <a class="el" href="class_o_t_purse.html#a0dcf71dc8347aa9cc84e36c434127ca1">OTPurse::m_pSymmetricKey</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00195">195</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3a8aa44df6deb6686429ac01525ea409"></a><!-- doxytag: member="OTPurse::m_ServerID" ref="a3a8aa44df6deb6686429ac01525ea409" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_identifier.html">OTIdentifier</a> <a class="el" href="class_o_t_purse.html#a3a8aa44df6deb6686429ac01525ea409">OTPurse::m_ServerID</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00179">179</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a79b8feeca4bc890fd3487a47ca8f1884"></a><!-- doxytag: member="OTPurse::m_tEarliestValidTo" ref="a79b8feeca4bc890fd3487a47ca8f1884" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> <a class="el" href="class_o_t_purse.html#a79b8feeca4bc890fd3487a47ca8f1884">OTPurse::m_tEarliestValidTo</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00199">199</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad614b9642b4e71fadf963e196fc7a379"></a><!-- doxytag: member="OTPurse::m_tLatestValidFrom" ref="ad614b9642b4e71fadf963e196fc7a379" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> <a class="el" href="class_o_t_purse.html#ad614b9642b4e71fadf963e196fc7a379">OTPurse::m_tLatestValidFrom</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00198">198</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5799ef078aa3dce7e6af6c236503a140"></a><!-- doxytag: member="OTPurse::m_UserID" ref="a5799ef078aa3dce7e6af6c236503a140" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_identifier.html">OTIdentifier</a> <a class="el" href="class_o_t_purse.html#a5799ef078aa3dce7e6af6c236503a140">OTPurse::m_UserID</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_purse_8hpp_source.html#l00178">178</a> of file <a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/otlib/<a class="el" href="_o_t_purse_8hpp_source.html">OTPurse.hpp</a></li>
<li>src/otlib/<a class="el" href="_o_t_purse_8cpp_source.html">OTPurse.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_o_t_purse.html">OTPurse</a>      </li>

    <li class="footer">Generated on Wed May 21 2014 11:26:15 for Open-Transactions by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
