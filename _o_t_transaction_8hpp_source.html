<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Open-Transactions: include/otlib/OTTransaction.hpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Open-Transactions
   &#160;<span id="projectnumber">master/1066fb4910a63ee3f7de8e0807fee3eb663b66c7</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_o_t_transaction_8hpp.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">include/otlib/OTTransaction.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_o_t_transaction_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> *  OTTransaction.hpp</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> */</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="comment">/************************************************************</span>
<a name="l00008"></a>00008 <span class="comment"> -----BEGIN PGP SIGNED MESSAGE-----</span>
<a name="l00009"></a>00009 <span class="comment"> Hash: SHA1</span>
<a name="l00010"></a>00010 <span class="comment"></span>
<a name="l00011"></a>00011 <span class="comment"> *                 OPEN TRANSACTIONS</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> *       Financial Cryptography and Digital Cash</span>
<a name="l00014"></a>00014 <span class="comment"> *       Library, Protocol, API, Server, CLI, GUI</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> *       -- Anonymous Numbered Accounts.</span>
<a name="l00017"></a>00017 <span class="comment"> *       -- Untraceable Digital Cash.</span>
<a name="l00018"></a>00018 <span class="comment"> *       -- Triple-Signed Receipts.</span>
<a name="l00019"></a>00019 <span class="comment"> *       -- Cheques, Vouchers, Transfers, Inboxes.</span>
<a name="l00020"></a>00020 <span class="comment"> *       -- Basket Currencies, Markets, Payment Plans.</span>
<a name="l00021"></a>00021 <span class="comment"> *       -- Signed, XML, Ricardian-style Contracts.</span>
<a name="l00022"></a>00022 <span class="comment"> *       -- Scripted smart contracts.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> *  Copyright (C) 2010-2013 by &quot;Fellow Traveler&quot; (A pseudonym)</span>
<a name="l00025"></a>00025 <span class="comment"> *</span>
<a name="l00026"></a>00026 <span class="comment"> *  EMAIL:</span>
<a name="l00027"></a>00027 <span class="comment"> *  FellowTraveler@rayservers.net</span>
<a name="l00028"></a>00028 <span class="comment"> *</span>
<a name="l00029"></a>00029 <span class="comment"> *  BITCOIN:  1NtTPVVjDsUfDWybS4BwvHpG2pdS9RnYyQ</span>
<a name="l00030"></a>00030 <span class="comment"> *</span>
<a name="l00031"></a>00031 <span class="comment"> *  KEY FINGERPRINT (PGP Key in license file):</span>
<a name="l00032"></a>00032 <span class="comment"> *  9DD5 90EB 9292 4B48 0484  7910 0308 00ED F951 BB8E</span>
<a name="l00033"></a>00033 <span class="comment"> *</span>
<a name="l00034"></a>00034 <span class="comment"> *  OFFICIAL PROJECT WIKI(s):</span>
<a name="l00035"></a>00035 <span class="comment"> *  https://github.com/FellowTraveler/Moneychanger</span>
<a name="l00036"></a>00036 <span class="comment"> *  https://github.com/FellowTraveler/Open-Transactions/wiki</span>
<a name="l00037"></a>00037 <span class="comment"> *</span>
<a name="l00038"></a>00038 <span class="comment"> *  WEBSITE:</span>
<a name="l00039"></a>00039 <span class="comment"> *  http://www.OpenTransactions.org/</span>
<a name="l00040"></a>00040 <span class="comment"> *</span>
<a name="l00041"></a>00041 <span class="comment"> *  Components and licensing:</span>
<a name="l00042"></a>00042 <span class="comment"> *   -- Moneychanger..A Java client GUI.....LICENSE:.....GPLv3</span>
<a name="l00043"></a>00043 <span class="comment"> *   -- otlib.........A class library.......LICENSE:...LAGPLv3</span>
<a name="l00044"></a>00044 <span class="comment"> *   -- otapi.........A client API..........LICENSE:...LAGPLv3</span>
<a name="l00045"></a>00045 <span class="comment"> *   -- opentxs/ot....Command-line client...LICENSE:...LAGPLv3</span>
<a name="l00046"></a>00046 <span class="comment"> *   -- otserver......Server Application....LICENSE:....AGPLv3</span>
<a name="l00047"></a>00047 <span class="comment"> *  Github.com/FellowTraveler/Open-Transactions/wiki/Components</span>
<a name="l00048"></a>00048 <span class="comment"> *</span>
<a name="l00049"></a>00049 <span class="comment"> *  All of the above OT components were designed and written by</span>
<a name="l00050"></a>00050 <span class="comment"> *  Fellow Traveler, with the exception of Moneychanger, which</span>
<a name="l00051"></a>00051 <span class="comment"> *  was contracted out to Vicky C (bitcointrader4@gmail.com).</span>
<a name="l00052"></a>00052 <span class="comment"> *  The open-source community has since actively contributed.</span>
<a name="l00053"></a>00053 <span class="comment"> *</span>
<a name="l00054"></a>00054 <span class="comment"> *  -----------------------------------------------------</span>
<a name="l00055"></a>00055 <span class="comment"> *</span>
<a name="l00056"></a>00056 <span class="comment"> *   LICENSE:</span>
<a name="l00057"></a>00057 <span class="comment"> *   This program is free software: you can redistribute it</span>
<a name="l00058"></a>00058 <span class="comment"> *   and/or modify it under the terms of the GNU Affero</span>
<a name="l00059"></a>00059 <span class="comment"> *   General Public License as published by the Free Software</span>
<a name="l00060"></a>00060 <span class="comment"> *   Foundation, either version 3 of the License, or (at your</span>
<a name="l00061"></a>00061 <span class="comment"> *   option) any later version.</span>
<a name="l00062"></a>00062 <span class="comment"> *</span>
<a name="l00063"></a>00063 <span class="comment"> *   ADDITIONAL PERMISSION under the GNU Affero GPL version 3</span>
<a name="l00064"></a>00064 <span class="comment"> *   section 7: (This paragraph applies only to the LAGPLv3</span>
<a name="l00065"></a>00065 <span class="comment"> *   components listed above.) If you modify this Program, or</span>
<a name="l00066"></a>00066 <span class="comment"> *   any covered work, by linking or combining it with other</span>
<a name="l00067"></a>00067 <span class="comment"> *   code, such other code is not for that reason alone subject</span>
<a name="l00068"></a>00068 <span class="comment"> *   to any of the requirements of the GNU Affero GPL version 3.</span>
<a name="l00069"></a>00069 <span class="comment"> *   (==&gt; This means if you are only using the OT API, then you</span>
<a name="l00070"></a>00070 <span class="comment"> *   don&#39;t have to open-source your code--only your changes to</span>
<a name="l00071"></a>00071 <span class="comment"> *   Open-Transactions itself must be open source. Similar to</span>
<a name="l00072"></a>00072 <span class="comment"> *   LGPLv3, except it applies to software-as-a-service, not</span>
<a name="l00073"></a>00073 <span class="comment"> *   just to distributing binaries.)</span>
<a name="l00074"></a>00074 <span class="comment"> *</span>
<a name="l00075"></a>00075 <span class="comment"> *   Extra WAIVER for OpenSSL, Lucre, and all other libraries</span>
<a name="l00076"></a>00076 <span class="comment"> *   used by Open Transactions: This program is released under</span>
<a name="l00077"></a>00077 <span class="comment"> *   the AGPL with the additional exemption that compiling,</span>
<a name="l00078"></a>00078 <span class="comment"> *   linking, and/or using OpenSSL is allowed. The same is true</span>
<a name="l00079"></a>00079 <span class="comment"> *   for any other open source libraries included in this</span>
<a name="l00080"></a>00080 <span class="comment"> *   project: complete waiver from the AGPL is hereby granted to</span>
<a name="l00081"></a>00081 <span class="comment"> *   compile, link, and/or use them with Open-Transactions,</span>
<a name="l00082"></a>00082 <span class="comment"> *   according to their own terms, as long as the rest of the</span>
<a name="l00083"></a>00083 <span class="comment"> *   Open-Transactions terms remain respected, with regard to</span>
<a name="l00084"></a>00084 <span class="comment"> *   the Open-Transactions code itself.</span>
<a name="l00085"></a>00085 <span class="comment"> *</span>
<a name="l00086"></a>00086 <span class="comment"> *   Lucre License:</span>
<a name="l00087"></a>00087 <span class="comment"> *   This code is also &quot;dual-license&quot;, meaning that Ben Lau-</span>
<a name="l00088"></a>00088 <span class="comment"> *   rie&#39;s license must also be included and respected, since</span>
<a name="l00089"></a>00089 <span class="comment"> *   the code for Lucre is also included with Open Transactions.</span>
<a name="l00090"></a>00090 <span class="comment"> *   See Open-Transactions/src/otlib/lucre/LUCRE_LICENSE.txt</span>
<a name="l00091"></a>00091 <span class="comment"> *   The Laurie requirements are light, but if there is any</span>
<a name="l00092"></a>00092 <span class="comment"> *   problem with his license, simply remove the Lucre code.</span>
<a name="l00093"></a>00093 <span class="comment"> *   Although there are no other blind token algorithms in Open</span>
<a name="l00094"></a>00094 <span class="comment"> *   Transactions (yet. credlib is coming), the other functions</span>
<a name="l00095"></a>00095 <span class="comment"> *   will continue to operate.</span>
<a name="l00096"></a>00096 <span class="comment"> *   See Lucre on Github:  https://github.com/benlaurie/lucre</span>
<a name="l00097"></a>00097 <span class="comment"> *   -----------------------------------------------------</span>
<a name="l00098"></a>00098 <span class="comment"> *   You should have received a copy of the GNU Affero General</span>
<a name="l00099"></a>00099 <span class="comment"> *   Public License along with this program.  If not, see:</span>
<a name="l00100"></a>00100 <span class="comment"> *   http://www.gnu.org/licenses/</span>
<a name="l00101"></a>00101 <span class="comment"> *</span>
<a name="l00102"></a>00102 <span class="comment"> *   If you would like to use this software outside of the free</span>
<a name="l00103"></a>00103 <span class="comment"> *   software license, please contact FellowTraveler.</span>
<a name="l00104"></a>00104 <span class="comment"> *   (Unfortunately many will run anonymously and untraceably,</span>
<a name="l00105"></a>00105 <span class="comment"> *   so who could really stop them?)</span>
<a name="l00106"></a>00106 <span class="comment"> *</span>
<a name="l00107"></a>00107 <span class="comment"> *   DISCLAIMER:</span>
<a name="l00108"></a>00108 <span class="comment"> *   This program is distributed in the hope that it will be</span>
<a name="l00109"></a>00109 <span class="comment"> *   useful, but WITHOUT ANY WARRANTY; without even the implied</span>
<a name="l00110"></a>00110 <span class="comment"> *   warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR</span>
<a name="l00111"></a>00111 <span class="comment"> *   PURPOSE.  See the GNU Affero General Public License for</span>
<a name="l00112"></a>00112 <span class="comment"> *   more details.</span>
<a name="l00113"></a>00113 <span class="comment"></span>
<a name="l00114"></a>00114 <span class="comment"> -----BEGIN PGP SIGNATURE-----</span>
<a name="l00115"></a>00115 <span class="comment"> Version: GnuPG v1.4.9 (Darwin)</span>
<a name="l00116"></a>00116 <span class="comment"></span>
<a name="l00117"></a>00117 <span class="comment"> iQIcBAEBAgAGBQJRSsfJAAoJEAMIAO35UbuOQT8P/RJbka8etf7wbxdHQNAY+2cC</span>
<a name="l00118"></a>00118 <span class="comment"> vDf8J3X8VI+pwMqv6wgTVy17venMZJa4I4ikXD/MRyWV1XbTG0mBXk/7AZk7Rexk</span>
<a name="l00119"></a>00119 <span class="comment"> KTvL/U1kWiez6+8XXLye+k2JNM6v7eej8xMrqEcO0ZArh/DsLoIn1y8p8qjBI7+m</span>
<a name="l00120"></a>00120 <span class="comment"> aE7lhstDiD0z8mwRRLKFLN2IH5rAFaZZUvj5ERJaoYUKdn4c+RcQVei2YOl4T0FU</span>
<a name="l00121"></a>00121 <span class="comment"> LWND3YLoH8naqJXkaOKEN4UfJINCwxhe5Ke9wyfLWLUO7NamRkWD2T7CJ0xocnD1</span>
<a name="l00122"></a>00122 <span class="comment"> sjAzlVGNgaFDRflfIF4QhBx1Ddl6wwhJfw+d08bjqblSq8aXDkmFA7HeunSFKkdn</span>
<a name="l00123"></a>00123 <span class="comment"> oIEOEgyj+veuOMRJC5pnBJ9vV+7qRdDKQWaCKotynt4sWJDGQ9kWGWm74SsNaduN</span>
<a name="l00124"></a>00124 <span class="comment"> TPMyr9kNmGsfR69Q2Zq/FLcLX/j8ESxU+HYUB4vaARw2xEOu2xwDDv6jt0j3Vqsg</span>
<a name="l00125"></a>00125 <span class="comment"> x7rWv4S/Eh18FDNDkVRChiNoOIilLYLL6c38uMf1pnItBuxP3uhgY6COm59kVaRh</span>
<a name="l00126"></a>00126 <span class="comment"> nyGTYCDYD2TK+fI9o89F1297uDCwEJ62U0Q7iTDp5QuXCoxkPfv8/kX6lS6T3y9G</span>
<a name="l00127"></a>00127 <span class="comment"> M9mqIoLbIQ1EDntFv7/t6fUTS2+46uCrdZWbQ5RjYXdrzjij02nDmJAm2BngnZvd</span>
<a name="l00128"></a>00128 <span class="comment"> kamH0Y/n11lCvo1oQxM+</span>
<a name="l00129"></a>00129 <span class="comment"> =uSzz</span>
<a name="l00130"></a>00130 <span class="comment"> -----END PGP SIGNATURE-----</span>
<a name="l00131"></a>00131 <span class="comment"> **************************************************************/</span>
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="preprocessor">#ifndef __OT_TRANSACTION_HPP__</span>
<a name="l00134"></a>00134 <span class="preprocessor"></span><span class="preprocessor">#define __OT_TRANSACTION_HPP__</span>
<a name="l00135"></a>00135 <span class="preprocessor"></span>
<a name="l00136"></a>00136 <span class="preprocessor">#include &quot;<a class="code" href="_o_t_common_8hpp.html">OTCommon.hpp</a>&quot;</span>
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="preprocessor">#include &quot;<a class="code" href="_o_t_item_8hpp.html">OTItem.hpp</a>&quot;</span>
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 <span class="comment">/*</span>
<a name="l00141"></a>00141 <span class="comment">WHEN THE server receives a transaction request, it receives a MESSAGE containing an ascii-armored LEDGER.</span>
<a name="l00142"></a>00142 <span class="comment"></span>
<a name="l00143"></a>00143 <span class="comment"> The TYPE of the message might be &quot;process inbox&quot; or &quot;process these transfers&quot;.</span>
<a name="l00144"></a>00144 <span class="comment"> but either way there is a ledger bundled that contains a list of transactions (often a list of one.)</span>
<a name="l00145"></a>00145 <span class="comment"></span>
<a name="l00146"></a>00146 <span class="comment"> a ledger is stored as my inbox</span>
<a name="l00147"></a>00147 <span class="comment"></span>
<a name="l00148"></a>00148 <span class="comment"> a ledger is sent in a message to send me my inbox</span>
<a name="l00149"></a>00149 <span class="comment"></span>
<a name="l00150"></a>00150 <span class="comment"> a ledger is what I send the server when I ask it to process a couple of transactions.</span>
<a name="l00151"></a>00151 <span class="comment"> Each one of them has a transaction number.</span>
<a name="l00152"></a>00152 <span class="comment"> Therefore the ledger must have a MAP of transactions, indexed by TRANSACTION NUMBER.</span>
<a name="l00153"></a>00153 <span class="comment"></span>
<a name="l00154"></a>00154 <span class="comment"> Therefore message cannot handle transaction number.</span>
<a name="l00155"></a>00155 <span class="comment"></span>
<a name="l00156"></a>00156 <span class="comment"> Perhaps ledger is derived from message.  CMD3 is a ledger in an envelope.</span>
<a name="l00157"></a>00157 <span class="comment"> Then it can do everything that a message can do,</span>
<a name="l00158"></a>00158 <span class="comment"></span>
<a name="l00159"></a>00159 <span class="comment"></span>
<a name="l00160"></a>00160 <span class="comment"></span>
<a name="l00161"></a>00161 <span class="comment"></span>
<a name="l00162"></a>00162 <span class="comment"> A message contains a payload of a ledger</span>
<a name="l00163"></a>00163 <span class="comment"></span>
<a name="l00164"></a>00164 <span class="comment"> the ledger contains a list of transactions</span>
<a name="l00165"></a>00165 <span class="comment"></span>
<a name="l00166"></a>00166 <span class="comment">Ledger is derived from contract because you must be able to save / sign it and load from string,</span>
<a name="l00167"></a>00167 <span class="comment"> and because it must have items in it.</span>
<a name="l00168"></a>00168 <span class="comment"></span>
<a name="l00169"></a>00169 <span class="comment"></span>
<a name="l00170"></a>00170 <span class="comment"> transactions are derived from messages. a transaction is a form of message.</span>
<a name="l00171"></a>00171 <span class="comment"> (technically you could do a CMD3 and just send a transaction but the above is cleaner.)</span>
<a name="l00172"></a>00172 <span class="comment"></span>
<a name="l00173"></a>00173 <span class="comment"> Messages already have server ID, command, Account ID,</span>
<a name="l00174"></a>00174 <span class="comment"></span>
<a name="l00175"></a>00175 <span class="comment"> No a transaction is just a sibling to a message. It&#39;s it&#39;s own thing derived from contract.</span>
<a name="l00176"></a>00176 <span class="comment">  but they have similarities</span>
<a name="l00177"></a>00177 <span class="comment"></span>
<a name="l00178"></a>00178 <span class="comment"> so a ledger has a list of transactions. BOTH are derived from contract.</span>
<a name="l00179"></a>00179 <span class="comment"></span>
<a name="l00180"></a>00180 <span class="comment"> A transaction has a list of Items. a transaction can also be &quot;in reference to&quot; an item.</span>
<a name="l00181"></a>00181 <span class="comment"></span>
<a name="l00182"></a>00182 <span class="comment"> does an item need to be a contract?</span>
<a name="l00183"></a>00183 <span class="comment"></span>
<a name="l00184"></a>00184 <span class="comment"> each item has to be individually signed (because when I accept Sue&#39;s spend, that signed accepted item goes back to Sue.)</span>
<a name="l00185"></a>00185 <span class="comment"></span>
<a name="l00186"></a>00186 <span class="comment"> So the item has to be a contract. Each is signed and then put on the transaction&#39;s list of items.</span>
<a name="l00187"></a>00187 <span class="comment"></span>
<a name="l00188"></a>00188 <span class="comment"> Each transaction is also signed and includes a transaction number and is on the ledger&#39;s list of transactions.</span>
<a name="l00189"></a>00189 <span class="comment"></span>
<a name="l00190"></a>00190 <span class="comment"> The ledger itself is signed because it may be saved into a file.</span>
<a name="l00191"></a>00191 <span class="comment"></span>
<a name="l00192"></a>00192 <span class="comment"> The whole enchilada is wrapped up in ascii-armor and attached to a message and sent over the pipe.</span>
<a name="l00193"></a>00193 <span class="comment">*/</span>
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="comment">/*</span>
<a name="l00196"></a>00196 <span class="comment"></span>
<a name="l00197"></a>00197 <span class="comment"> Partially loading transactions!  (New development, born out of necessity.)</span>
<a name="l00198"></a>00198 <span class="comment"></span>
<a name="l00199"></a>00199 <span class="comment"> A few volunteers have played with OT test servers, and we (unsurprisingly) started noticing messaging</span>
<a name="l00200"></a>00200 <span class="comment"> delays where a user had accumulated a thousand receipts in his inbox, and when he tried to download it</span>
<a name="l00201"></a>00201 <span class="comment"> he would miss the message, and thus get out of sync. He can&#39;t download his inbox anymore.</span>
<a name="l00202"></a>00202 <span class="comment"></span>
<a name="l00203"></a>00203 <span class="comment"> So now, the inbox is not going to contain a copy of the actual receipts themselves, as normally with</span>
<a name="l00204"></a>00204 <span class="comment"> transactions inside a ledger. Instead, the receipts will be saved into a separate location, and they</span>
<a name="l00205"></a>00205 <span class="comment"> will be given a &quot;save to ledger&quot; function that will save the full thing (for message ledgers) or a partial</span>
<a name="l00206"></a>00206 <span class="comment"> version (for inbox/outbox/nymbox ledgers) with no attachments (MUCH smaller size) and which contains a hash</span>
<a name="l00207"></a>00207 <span class="comment"> of the actual full receipt.</span>
<a name="l00208"></a>00208 <span class="comment"></span>
<a name="l00209"></a>00209 <span class="comment"> OT should just be able to ASSUME that the client software has downloaded the relevant receipts (a message</span>
<a name="l00210"></a>00210 <span class="comment"> will be added to the protocol for downloading these receipts.) The transaction object on an inbox will have</span>
<a name="l00211"></a>00211 <span class="comment"> a flag set to false until the actual receipt has been loaded (not just the inbox placeholder) and certain</span>
<a name="l00212"></a>00212 <span class="comment"> actions will simply fail if that flag has not been set to true from the ACTUAL full receipt being loaded.</span>
<a name="l00213"></a>00213 <span class="comment"> Or the function will automatically try to load said receipt, and then fail if that action fails. If the receipt</span>
<a name="l00214"></a>00214 <span class="comment"> hash appears in the inbox, therefore the API should be able to assume that the receipt itself is available for</span>
<a name="l00215"></a>00215 <span class="comment"> inspection.</span>
<a name="l00216"></a>00216 <span class="comment"></span>
<a name="l00217"></a>00217 <span class="comment"> Todo:</span>
<a name="l00218"></a>00218 <span class="comment"> -- &quot;Save To Abbreviated form&quot; function.</span>
<a name="l00219"></a>00219 <span class="comment"></span>
<a name="l00220"></a>00220 <span class="comment"> And what does it save?</span>
<a name="l00221"></a>00221 <span class="comment"> transactionType        m_Type;     // blank, pending, processInbox, transfer, deposit, withdrawal, trade, etc.</span>
<a name="l00222"></a>00222 <span class="comment"> time64_t                   m_DATE_SIGNED;      // The date, in seconds, when the instrument was last signed.</span>
<a name="l00223"></a>00223 <span class="comment"> int64_t                    m_lTransactionNum;  // The server issues this and it must be sent with transaction request.</span>
<a name="l00224"></a>00224 <span class="comment"> int64_t                    m_lInReferenceToTransaction;</span>
<a name="l00225"></a>00225 <span class="comment"> int64_t                    m_lClosingTransactionNo; // used by finalReceipt</span>
<a name="l00226"></a>00226 <span class="comment"> also:              AMOUNT.  // GetReceiptAmount()</span>
<a name="l00227"></a>00227 <span class="comment"> int64_t                m_lAbbrevAmount; // Stored here after loading, but not saved from here in the first place (see GetReceiptAmount())</span>
<a name="l00228"></a>00228 <span class="comment"> int64_t                m_lDisplayAmount; // Just like m_lAbbrevAmount, except it stores the display amount. For example, a transferReceipt for a 5000 clam transfer has an effective value of 0 (since the transfer is already done) but it has a display amount of 5000.</span>
<a name="l00229"></a>00229 <span class="comment"> OTIdentifier       m_Hash;          // Created while saving abbreviated record, loaded back with it, then verified against actual hash when loading actual box receipt.</span>
<a name="l00230"></a>00230 <span class="comment"></span>
<a name="l00231"></a>00231 <span class="comment"> DOES NOT SAVE:</span>
<a name="l00232"></a>00232 <span class="comment"> listOfItems    m_listItems;        // the various items in this transaction.</span>
<a name="l00233"></a>00233 <span class="comment"> OTASCIIArmor   m_ascCancellationRequest; // used by finalReceipt</span>
<a name="l00234"></a>00234 <span class="comment">//  OTIdentifier    m_ID;           // Account ID. This is in OTContract (parent class). Here we use it for the REAL ACCOUNT ID (set before loading.)</span>
<a name="l00235"></a>00235 <span class="comment"> OTIdentifier   m_AcctID;       // Compare m_AcctID to m_ID after loading it from string or file. They should match, and signature should verify.</span>
<a name="l00236"></a>00236 <span class="comment"> OTIdentifier   m_ServerID;     // Server ID as used to instantiate the transaction, based on expected ServerID.</span>
<a name="l00237"></a>00237 <span class="comment"> OTIdentifier   m_AcctServerID; // Actual ServerID within the signed portion. (Compare to m_ServerID upon loading.)</span>
<a name="l00238"></a>00238 <span class="comment"> OTIdentifier   m_AcctUserID;       // NymID of the user who created this item. (In the future, this item</span>
<a name="l00239"></a>00239 <span class="comment"> OTASCIIArmor   m_ascInReferenceTo; // This item may be in reference to a different item</span>
<a name="l00240"></a>00240 <span class="comment"></span>
<a name="l00241"></a>00241 <span class="comment"> Normally we only save the &quot;purported&quot; values. But in &quot;save to ledger&quot; function I only want to save the values</span>
<a name="l00242"></a>00242 <span class="comment"> that I&#39;m EXPECTING to be in those receipts, not the values that are ACTUALLY in those receipts. (Of course they</span>
<a name="l00243"></a>00243 <span class="comment"> ARE the values that were in the receipts when first saved, but I don&#39;t know what will be in the receipts when I LOAD</span>
<a name="l00244"></a>00244 <span class="comment"> them again, until I load them and verify that they are still the right ones. Perhaps a substitution occured in the meantime.</span>
<a name="l00245"></a>00245 <span class="comment"></span>
<a name="l00246"></a>00246 <span class="comment"> In any case, when I am making the abbreviated record, I already know that information from the ledger itself</span>
<a name="l00247"></a>00247 <span class="comment"> (user ID, account ID, server ID, etc) so I don&#39;t bother storing it for each transaction at all since it&#39;s already</span>
<a name="l00248"></a>00248 <span class="comment"> stored for the ledger as a whole. I can set the expected numbers based on that, and then verify it against the purported</span>
<a name="l00249"></a>00249 <span class="comment"> numbers when the ACTUAL receipt is loaded up.</span>
<a name="l00250"></a>00250 <span class="comment"></span>
<a name="l00251"></a>00251 <span class="comment"> Hmm ProduceOutboxReportItem() and ProduceInboxReportItem() ALREADY do the work of grabbing the Type, transaction#,</span>
<a name="l00252"></a>00252 <span class="comment"> the reference #, the closing #, and the amount. Therefore I&#39;ll use that to do the work, and then iterate the balance</span>
<a name="l00253"></a>00253 <span class="comment"> item&#39;s sub-items when saving in abbreviated form. But this means I have to store the hash in the sub-items (at the time</span>
<a name="l00254"></a>00254 <span class="comment"> of their creation) which means I probably want to just keep it there for the normal balance agreements as well. But</span>
<a name="l00255"></a>00255 <span class="comment"> for normal balance agreements, the sub-items are stored on an actual item, so I&#39;ll check out that code... maybe just save</span>
<a name="l00256"></a>00256 <span class="comment"> that item itself directly in the ledger... except the balance portions aren&#39;t appropriate, only the sub-item portions.</span>
<a name="l00257"></a>00257 <span class="comment"> CHANGE OF HEART:  I won&#39;t be using the sub-items for this, the difference is great enough that I&#39;d be forcing a square</span>
<a name="l00258"></a>00258 <span class="comment"> peg into a round hole. Just adding a few functions for saving/loading in abbreviated form.</span>
<a name="l00259"></a>00259 <span class="comment"></span>
<a name="l00260"></a>00260 <span class="comment"></span>
<a name="l00261"></a>00261 <span class="comment"> NEED TO CODE:</span>
<a name="l00262"></a>00262 <span class="comment"> -- Server message for downloading &quot;box receipts.&quot;</span>
<a name="l00263"></a>00263 <span class="comment"></span>
<a name="l00264"></a>00264 <span class="comment"> -- Method on OTTransaction for saving in abbreviated format to a string. Called by...</span>
<a name="l00265"></a>00265 <span class="comment"></span>
<a name="l00266"></a>00266 <span class="comment"> -- Fix OTLedger Load/Save so it only loads/saves transactions in abbreviated format, which should only be</span>
<a name="l00267"></a>00267 <span class="comment">    useful for getting enough information in order to download the receipts. From there, the existing &quot;verify&quot;</span>
<a name="l00268"></a>00268 <span class="comment">    function should try to load them all before actually verifying. (From there, you have loaded and verified the transaction,</span>
<a name="l00269"></a>00269 <span class="comment">    which we normally do anyway before using it, so now that&#39;s all done, so we can go ahead and use it as normal.)</span>
<a name="l00270"></a>00270 <span class="comment"></span>
<a name="l00271"></a>00271 <span class="comment"> -- How does user get his box receipts? downloads from server and loads during verify process.</span>
<a name="l00272"></a>00272 <span class="comment"></span>
<a name="l00273"></a>00273 <span class="comment"> -- How does Ledger save? It calls OTTransaction::SaveToAbbreviatedForm() or some such, in a loop, and saves all their</span>
<a name="l00274"></a>00274 <span class="comment">    vitals.</span>
<a name="l00275"></a>00275 <span class="comment"></span>
<a name="l00276"></a>00276 <span class="comment"> -- How about the transactions themselves (the full &quot;box receipts&quot; and not just abbreviated versions) ?</span>
<a name="l00277"></a>00277 <span class="comment">    1. User never saves them other than when downloading from server, and he must compare them against the hash in the box.</span>
<a name="l00278"></a>00278 <span class="comment">    2. User loads them as part of verify process when verifying inbox/outbox/nymbox.</span>
<a name="l00279"></a>00279 <span class="comment">    3. Server must First Save them at the same time that they are added to the box itself.</span>
<a name="l00280"></a>00280 <span class="comment">    4. From there server can load anytime also, similar to user (verify process.) Server should never fail since it CREATED the receipt.</span>
<a name="l00281"></a>00281 <span class="comment"></span>
<a name="l00282"></a>00282 <span class="comment"> -- Server is safe to erase the box receipt at the same time that it&#39;s been removed from its box. In practice this</span>
<a name="l00283"></a>00283 <span class="comment">    should be handled by saving the box receipt with a MARKED FOR DELETION flag added.</span>
<a name="l00284"></a>00284 <span class="comment"></span>
<a name="l00285"></a>00285 <span class="comment"> -- WHERE to save? (client and server side)</span>
<a name="l00286"></a>00286 <span class="comment"></span>
<a name="l00287"></a>00287 <span class="comment"> Keeping in mind there are also &quot;cron receipts&quot; (OTCronItem is for recurring transactions like market offers/trades,</span>
<a name="l00288"></a>00288 <span class="comment"> and smart contracts) as well as &quot;transaction receipts&quot; (*every* server reply to every transaction request is automatically</span>
<a name="l00289"></a>00289 <span class="comment"> saved, success or fail, as a transaction receipt.) They are stored like so:</span>
<a name="l00290"></a>00290 <span class="comment"></span>
<a name="l00291"></a>00291 <span class="comment"> ~/.ot/client_data/receipts/tmHvLZxb13hW6OyH1oHKTmKd7fTMRsUfzqPE6KCwSjl</span>
<a name="l00292"></a>00292 <span class="comment"> &gt; ls</span>
<a name="l00293"></a>00293 <span class="comment"> 1mxwHcQvxSgqWqy2e28ZREeuVVfgs0kxE41FN10TnS3.success 2K3LoD1UxsJLO0FAfng0fgqnxnXScO8rM2eO5tdDTOE.success T1Q3wZWgeTUoaUvn9m1lzIK5tn5wITlzxzrGNI8qtaV.success vuXpQt8h6CRGcz6G5zMOXqQeIRpsOq05VLuJ5IAFS5R.success</span>
<a name="l00294"></a>00294 <span class="comment"> 2FHFr5NdT1r1XtUWVjll1uGcTKGKx4Pt1iWJ9eV0kkZ.success A6CcGwNiTtEPQnv7HLUcmf0QFaCGy862pb1SJ3zVqIU.success gys4puOdx15pknQYcVtF4DmOo2tOYouoiqcQAHKApSF.success w06QIURsSDV7sdWWvyPSxRaiv4T2MUQbJyWmIKxSmuL.success</span>
<a name="l00295"></a>00295 <span class="comment"></span>
<a name="l00296"></a>00296 <span class="comment"> basically:</span>
<a name="l00297"></a>00297 <span class="comment"> OT_DATA/receipts/SERVER_ID/ACCT_ID.success</span>
<a name="l00298"></a>00298 <span class="comment"> OT_DATA/receipts/SERVER_ID/ACCT_ID.fail</span>
<a name="l00299"></a>00299 <span class="comment"></span>
<a name="l00300"></a>00300 <span class="comment"> or:</span>
<a name="l00301"></a>00301 <span class="comment"> OT_DATA/receipts/SERVER_ID/NYM_ID.success</span>
<a name="l00302"></a>00302 <span class="comment"> OT_DATA/receipts/SERVER_ID/NYM_ID.fail</span>
<a name="l00303"></a>00303 <span class="comment"></span>
<a name="l00304"></a>00304 <span class="comment"> These receipts are related to balance agreement. These are the &quot;last signed receipt&quot; that you keep in order to</span>
<a name="l00305"></a>00305 <span class="comment"> verify later against future intermediary files, to make sure the server isn&#39;t screwing you with bad intermediary</span>
<a name="l00306"></a>00306 <span class="comment"> files. Sometimes there is a transaction statement, and sometimes there is a balance agreement (depending on whether</span>
<a name="l00307"></a>00307 <span class="comment"> both sides are merely agreeing on the list of signed-out transaction numbers, or whether they are additionally</span>
<a name="l00308"></a>00308 <span class="comment"> agreement on the balance and inbox items for a specific asset account as well.)</span>
<a name="l00309"></a>00309 <span class="comment"></span>
<a name="l00310"></a>00310 <span class="comment"> (The transaction statements are the ones stored by NYM_ID, and the balance agreements are the ones by ACCT_ID.)</span>
<a name="l00311"></a>00311 <span class="comment"></span>
<a name="l00312"></a>00312 <span class="comment"> -----------</span>
<a name="l00313"></a>00313 <span class="comment"></span>
<a name="l00314"></a>00314 <span class="comment"> In addition to &quot;cron receipts&quot; and &quot;transaction receipts&quot;, I am now adding this idea of &quot;box receipts&quot; which is really</span>
<a name="l00315"></a>00315 <span class="comment"> just your inbox items stored in a separate file, because they simply won&#39;t all fit comfortably in a getInbox message.</span>
<a name="l00316"></a>00316 <span class="comment"> How to store them?</span>
<a name="l00317"></a>00317 <span class="comment"></span>
<a name="l00318"></a>00318 <span class="comment"> Current inbox/outbox path: OT_DATA/[inbox|outbox]/SERVER_ID/ACCT_ID</span>
<a name="l00319"></a>00319 <span class="comment"> Current nymbox path:       OT_DATA/nymbox/SERVER_ID/NYM_ID</span>
<a name="l00320"></a>00320 <span class="comment"></span>
<a name="l00321"></a>00321 <span class="comment"> Therefore I propose the box receipts to be stored:</span>
<a name="l00322"></a>00322 <span class="comment"></span>
<a name="l00323"></a>00323 <span class="comment"> Inbox/outbox path: OT_DATA/inbox/SERVER_ID/ACCT_ID.r/TRANSACTION_ID.rct</span>
<a name="l00324"></a>00324 <span class="comment"> nymbox path:       OT_DATA/nymbox/SERVER_ID/NYM_ID.r/TRANSACTION_ID.rct</span>
<a name="l00325"></a>00325 <span class="comment"></span>
<a name="l00326"></a>00326 <span class="comment"> When querying the server for a box receipt, you will have to provide TYPE (inbox, outbox, etc)</span>
<a name="l00327"></a>00327 <span class="comment"> as well as ID (acct ID or Nym ID, depending on which box type) as well as transaction number,</span>
<a name="l00328"></a>00328 <span class="comment"> and the hash.</span>
<a name="l00329"></a>00329 <span class="comment"></span>
<a name="l00330"></a>00330 <span class="comment"> ------------</span>
<a name="l00331"></a>00331 <span class="comment"></span>
<a name="l00332"></a>00332 <span class="comment"> Note: When loading from string, IF IN ABBREVIATED FORM, then we must take care to verify the</span>
<a name="l00333"></a>00333 <span class="comment"> loaded values against their expected counterparts, before OVERWRITING the &quot;expected&quot; values</span>
<a name="l00334"></a>00334 <span class="comment"> with the actual ones from the box receipts. Rather than store each value separately, (as we did</span>
<a name="l00335"></a>00335 <span class="comment"> with serverID, acctID, etc in OTTransactionType) we will instead simply take care to verify them</span>
<a name="l00336"></a>00336 <span class="comment"> during loading, if the &quot;abbreviated&quot; flag is set.</span>
<a name="l00337"></a>00337 <span class="comment"></span>
<a name="l00338"></a>00338 <span class="comment"> ------------</span>
<a name="l00339"></a>00339 <span class="comment"></span>
<a name="l00340"></a>00340 <span class="comment"> THE BEST TIME to actually SAVE the box receipt, on the Server Side, is at the same time that it is first being</span>
<a name="l00341"></a>00341 <span class="comment"> added to the relevant box itself. (Look into centralizing that mechanism...)</span>
<a name="l00342"></a>00342 <span class="comment"></span>
<a name="l00343"></a>00343 <span class="comment"> */</span>
<a name="l00344"></a>00344 
<a name="l00345"></a>00345 <span class="keyword">class </span><a class="code" href="class_o_t_ledger.html">OTLedger</a>;
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 
<a name="l00348"></a><a class="code" href="class_o_t_transaction.html">00348</a> <span class="keyword">class </span><a class="code" href="class_o_t_transaction.html">OTTransaction</a> : <span class="keyword">public</span> <a class="code" href="class_o_t_transaction_type.html">OTTransactionType</a>
<a name="l00349"></a>00349 {
<a name="l00350"></a>00350 <span class="keyword">private</span>:  <span class="comment">// Private prevents erroneous use by other classes.</span>
<a name="l00351"></a>00351     <span class="keyword">typedef</span> <a class="code" href="class_o_t_transaction_type.html">OTTransactionType</a> <a class="code" href="class_o_t_transaction_type.html">ot_super</a>;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <span class="keyword">friend</span> <a class="code" href="class_o_t_transaction_type.html">OTTransactionType</a> * <a class="code" href="class_o_t_transaction_type.html#a3322a8680cb317a52691b17aa23da79d">OTTransactionType::TransactionFactory</a>(<a class="code" href="class_o_t_string.html">OTString</a> strInput);
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="keyword">public</span>:
<a name="l00356"></a>00356     <span class="comment">// a transaction can be blank (issued from server)</span>
<a name="l00357"></a>00357     <span class="comment">// or pending (in the inbox/outbox)</span>
<a name="l00358"></a>00358     <span class="comment">// or it can be a &quot;process inbox&quot; transaction</span>
<a name="l00359"></a>00359     <span class="comment">// might also be in the nymbox.</span>
<a name="l00360"></a>00360     <span class="comment">//</span>
<a name="l00361"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">00361</a>     <span class="keyword">enum</span> <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">transactionType</a>
<a name="l00362"></a>00362     {
<a name="l00363"></a>00363         <span class="comment">// ***** INBOX / OUTBOX / NYMBOX</span>
<a name="l00364"></a>00364 
<a name="l00365"></a>00365 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00366"></a>00366         <span class="comment">// NYMBOX</span>
<a name="l00367"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ad74c4b196dafbd9b1eacc19d825c6a3e">00367</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ad74c4b196dafbd9b1eacc19d825c6a3e">blank</a>,          <span class="comment">// freshly issued transaction number, not used yet</span>
<a name="l00368"></a>00368                         <span class="comment">// (the server drops these into the nymbox.)</span>
<a name="l00369"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a9505edb62ffb5da2972221c2663af52f">00369</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a9505edb62ffb5da2972221c2663af52f">message</a>,        <span class="comment">// A message from one user to another, also in the nymbox.</span>
<a name="l00370"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a34ed13120f604fbf41954473bfd896da">00370</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a34ed13120f604fbf41954473bfd896da">notice</a>,         <span class="comment">// A notice from the server. Used in Nymbox.</span>
<a name="l00371"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8acae27254bdf46d3581a3ab1038566d7c">00371</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8acae27254bdf46d3581a3ab1038566d7c">replyNotice</a>,    <span class="comment">// A copy of a server reply to a previous request you sent. (To make SURE you get the reply.)</span>
<a name="l00372"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a52282952428acc861ea6c25a3839fcc9">00372</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a52282952428acc861ea6c25a3839fcc9">successNotice</a>,  <span class="comment">// A transaction # has successfully been signed out.</span>
<a name="l00373"></a>00373 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00374"></a>00374 
<a name="l00375"></a>00375         <span class="comment">// INBOX / OUTBOX (pending transfer)</span>
<a name="l00376"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">00376</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">pending</a>,        <span class="comment">// Server puts this in your outbox (when sending) and recipient&#39;s inbox.</span>
<a name="l00377"></a>00377 
<a name="l00378"></a>00378         <span class="comment">// INBOX / receipts</span>
<a name="l00379"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ab184c4314c99d16d439c96380a4e27cb">00379</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ab184c4314c99d16d439c96380a4e27cb">transferReceipt</a>,<span class="comment">// the server drops this into your inbox, when someone accepts your transfer.</span>
<a name="l00380"></a>00380 
<a name="l00381"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a9a92eac3a7ccff17583eb089a056f5af">00381</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a9a92eac3a7ccff17583eb089a056f5af">chequeReceipt</a>,  <span class="comment">// the server drops this into your inbox, when someone deposits your cheque.</span>
<a name="l00382"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a11b89ff8cbf5b3d7c526f4d166f653c8">00382</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a11b89ff8cbf5b3d7c526f4d166f653c8">voucherReceipt</a>, <span class="comment">// the server drops this into your inbox, when someone deposits your voucher.</span>
<a name="l00383"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ad46b36946aa172b4e69558c3c5697c63">00383</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ad46b36946aa172b4e69558c3c5697c63">marketReceipt</a>,  <span class="comment">// server periodically drops this into your inbox if an offer is live.</span>
<a name="l00384"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8aac41b416522c9ba6453c787607c6c68d">00384</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8aac41b416522c9ba6453c787607c6c68d">paymentReceipt</a>, <span class="comment">// the server drops this into people&#39;s inboxes, every time a payment processes. (from a payment plan or a smart contract)</span>
<a name="l00385"></a>00385 
<a name="l00386"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a3877decda88be6b275652a6e4930ddc4">00386</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a3877decda88be6b275652a6e4930ddc4">finalReceipt</a>,   <span class="comment">// the server drops this into your in/nym box(es), when a CronItem expires or is canceled.</span>
<a name="l00387"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a2f852a3f97691d417faa322cdbbb3377">00387</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a2f852a3f97691d417faa322cdbbb3377">basketReceipt</a>,  <span class="comment">// the server drops this into your inboxes, when a basket exchange is processed.</span>
<a name="l00388"></a>00388 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00389"></a>00389 
<a name="l00390"></a>00390         <span class="comment">// PAYMENT INBOX / PAYMENT OUTBOX / RECORD BOX</span>
<a name="l00391"></a>00391 
<a name="l00392"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a3bb6c95074edec038831f5282423163f">00392</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a3bb6c95074edec038831f5282423163f">instrumentNotice</a>,       <span class="comment">// Receive these in paymentInbox (by way of Nymbox), and send in Outpayments (like Outmail).) (When done, they go to recordBox or expiredBox to await deletion.)</span>
<a name="l00393"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a47605348be0f35786bececebacd7170b">00393</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a47605348be0f35786bececebacd7170b">instrumentRejection</a>,    <span class="comment">// When someone rejects your invoice from his paymentInbox, you get one of these in YOUR paymentInbox.</span>
<a name="l00394"></a>00394 
<a name="l00395"></a>00395 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00396"></a>00396 
<a name="l00397"></a>00397         <span class="comment">// **** MESSAGES ****</span>
<a name="l00398"></a>00398 
<a name="l00399"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ac0914e62639aebd987882e21bdff890d">00399</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ac0914e62639aebd987882e21bdff890d">processNymbox</a>,  <span class="comment">// process nymbox transaction    // comes from client</span>
<a name="l00400"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8afa0ed45f263e43a61f2315dc723b13f7">00400</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8afa0ed45f263e43a61f2315dc723b13f7">atProcessNymbox</a>,<span class="comment">// process nymbox reply          // comes from server</span>
<a name="l00401"></a>00401 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00402"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a17de28d6bffb971efeebbd9a2fff5ada">00402</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a17de28d6bffb971efeebbd9a2fff5ada">processInbox</a>,   <span class="comment">// process inbox transaction     // comes from client</span>
<a name="l00403"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ab5e618f93b8a024db636a286a10c433e">00403</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ab5e618f93b8a024db636a286a10c433e">atProcessInbox</a>, <span class="comment">// process inbox reply           // comes from server</span>
<a name="l00404"></a>00404 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00405"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8af50841ed6e2bd9586ae8f6d79ee3b67d">00405</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8af50841ed6e2bd9586ae8f6d79ee3b67d">transfer</a>,       <span class="comment">// or &quot;spend&quot;. This transaction is a request to transfer from one account to another</span>
<a name="l00406"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ad6f91d122a4d04bbcd5f5ff703b17585">00406</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ad6f91d122a4d04bbcd5f5ff703b17585">atTransfer</a>,     <span class="comment">// reply from the server regarding a transfer request</span>
<a name="l00407"></a>00407 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00408"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ac4cf1c0cdeac5cb3636c34b4682ad228">00408</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8ac4cf1c0cdeac5cb3636c34b4682ad228">deposit</a>,        <span class="comment">// this transaction is a deposit (cash or cheque)</span>
<a name="l00409"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a759808a47e79ca6edde03d3dd03318f3">00409</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a759808a47e79ca6edde03d3dd03318f3">atDeposit</a>,      <span class="comment">// reply from the server regarding a deposit request</span>
<a name="l00410"></a>00410 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00411"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a9c490e1b2edddb81720905a14479d0e7">00411</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a9c490e1b2edddb81720905a14479d0e7">withdrawal</a>,     <span class="comment">// this transaction is a withdrawal (cash or voucher)</span>
<a name="l00412"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a97e769c64e9e1ea2d8e7730e7d758949">00412</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a97e769c64e9e1ea2d8e7730e7d758949">atWithdrawal</a>,   <span class="comment">// reply from the server regarding a withdrawal request</span>
<a name="l00413"></a>00413 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00414"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8acdd69363d8b62cadbfc6a8369a669bc0">00414</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8acdd69363d8b62cadbfc6a8369a669bc0">marketOffer</a>,    <span class="comment">// this transaction is a market offer</span>
<a name="l00415"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8aefb8fac2c5b63cd7cc87e4e620be5a74">00415</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8aefb8fac2c5b63cd7cc87e4e620be5a74">atMarketOffer</a>,  <span class="comment">// reply from the server regarding a market offer</span>
<a name="l00416"></a>00416 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00417"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a7b7b233a1f4438ee26116ba1bda92cb0">00417</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a7b7b233a1f4438ee26116ba1bda92cb0">paymentPlan</a>,    <span class="comment">// this transaction is a payment plan</span>
<a name="l00418"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8afdc94f6f285b3e410ed6283cfc3184cc">00418</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8afdc94f6f285b3e410ed6283cfc3184cc">atPaymentPlan</a>,  <span class="comment">// reply from the server regarding a payment plan</span>
<a name="l00419"></a>00419 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00420"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a42b743fb9d9a40ac2a77499f9d87bde0">00420</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a42b743fb9d9a40ac2a77499f9d87bde0">smartContract</a>,  <span class="comment">// this transaction is a smart contract</span>
<a name="l00421"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a97fbe1a7d3cbf4a1c2476fd0374b1363">00421</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a97fbe1a7d3cbf4a1c2476fd0374b1363">atSmartContract</a>,<span class="comment">// reply from the server regarding a smart contract</span>
<a name="l00422"></a>00422 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00423"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a30587bf83cb273ffd6a72008d2545ca5">00423</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a30587bf83cb273ffd6a72008d2545ca5">cancelCronItem</a>, <span class="comment">// this transaction is intended to cancel a market offer or payment plan.</span>
<a name="l00424"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8aeab27a75cf6eca60caae2cfc836af49d">00424</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8aeab27a75cf6eca60caae2cfc836af49d">atCancelCronItem</a>,<span class="comment">// reply from the server regarding said cancellation.</span>
<a name="l00425"></a>00425 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00426"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a7b518796457aa29ef96cccc2c861726a">00426</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a7b518796457aa29ef96cccc2c861726a">exchangeBasket</a>, <span class="comment">// this transaction is an exchange in/out of a basket currency.</span>
<a name="l00427"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a32b11ab3a1c1c2bb2f72ea79df070e61">00427</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a32b11ab3a1c1c2bb2f72ea79df070e61">atExchangeBasket</a>,<span class="comment">// reply from the server regarding said exchange.</span>
<a name="l00428"></a>00428 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00429"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a1db39a50ac27161d9be40db72bf2dcf4">00429</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a1db39a50ac27161d9be40db72bf2dcf4">payDividend</a>,    <span class="comment">// this transaction is dividend payment (to all shareholders...)</span>
<a name="l00430"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8abd4fe0db87268c965e14719347c91594">00430</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8abd4fe0db87268c965e14719347c91594">atPayDividend</a>,  <span class="comment">// reply from the server regarding said dividend payment.</span>
<a name="l00431"></a>00431 <span class="comment">// --------------------------------------------------------------------------------------</span>
<a name="l00432"></a><a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a417077fa11eb89c00074c64eb4e13c91">00432</a>         <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a417077fa11eb89c00074c64eb4e13c91">error_state</a>
<a name="l00433"></a>00433     };   <span class="comment">// If you add any types to this list, update the list of strings at the top of the .CPP file.</span>
<a name="l00434"></a>00434 
<a name="l00435"></a>00435     <span class="comment">/*</span>
<a name="l00436"></a>00436 <span class="comment">     You have to read pointer declarations right-to-left.</span>
<a name="l00437"></a>00437 <span class="comment"></span>
<a name="l00438"></a>00438 <span class="comment">        Fred const* p    means &quot;p points to a constant Fred&quot;: the Fred object can&#39;t be changed via p.</span>
<a name="l00439"></a>00439 <span class="comment">        Fred* const p    means &quot;p is a const pointer to a Fred&quot;: you can&#39;t change the pointer p, but you can change the Fred object via p.</span>
<a name="l00440"></a>00440 <span class="comment">        Fred const* const p    means &quot;p is a constant pointer to a constant Fred&quot;: you can&#39;t change the pointer p itself, nor can you change the Fred object via p.</span>
<a name="l00441"></a>00441 <span class="comment">     */</span>
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="keyword">protected</span>:
<a name="l00444"></a>00444     <span class="comment">// Usually a transaction object is inside a ledger object.</span>
<a name="l00445"></a>00445     <span class="comment">// If this is not NULL, then you can reference that object.</span>
<a name="l00446"></a>00446     <span class="comment">//</span>
<a name="l00447"></a><a class="code" href="class_o_t_transaction.html#abb869752baf350d380c0afa81d84d1de">00447</a>     <span class="keyword">const</span> <a class="code" href="class_o_t_ledger.html">OTLedger</a>  *   <a class="code" href="class_o_t_transaction.html#abb869752baf350d380c0afa81d84d1de">m_pParent</a>;
<a name="l00448"></a>00448 
<a name="l00449"></a>00449     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     <span class="comment">// Transactions can be loaded in abbreviated form from a ledger, but they are not considered &quot;actually loaded&quot;</span>
<a name="l00452"></a>00452     <span class="comment">// until their associated &quot;box receipt&quot; is also loaded up from storage, and verified against its hash.</span>
<a name="l00453"></a>00453     <span class="comment">// From the time they are loaded in abbreviated form, this flag is set true, until the box receipt is loaded.</span>
<a name="l00454"></a>00454     <span class="comment">// This value defaults to false, so if the transaction was never loaded in abbreviated form, then this is never</span>
<a name="l00455"></a>00455     <span class="comment">// set to true in the first place.</span>
<a name="l00456"></a><a class="code" href="class_o_t_transaction.html#a1298e2f51b0a9471bc6b1aa8905b70f9">00456</a>     <span class="keywordtype">bool</span>                <a class="code" href="class_o_t_transaction.html#a1298e2f51b0a9471bc6b1aa8905b70f9">m_bIsAbbreviated</a>;
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     <span class="comment">// The &quot;Amount&quot; of the transaction is not normally stored in the transaction itself, but in one of its</span>
<a name="l00461"></a>00461     <span class="comment">// transaction items. However, when saving/loading the transaction in abbreviated form, the amount is</span>
<a name="l00462"></a>00462     <span class="comment">// placed here, which makes it available for necessary calculations without being forced to load up</span>
<a name="l00463"></a>00463     <span class="comment">// all of the box receipts to do so.</span>
<a name="l00464"></a>00464 
<a name="l00465"></a><a class="code" href="class_o_t_transaction.html#ae1f24fb2a4460c4b695e7628fc78890e">00465</a>     int64_t             <a class="code" href="class_o_t_transaction.html#ae1f24fb2a4460c4b695e7628fc78890e">m_lAbbrevAmount</a>;
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     <span class="comment">// Just like m_lAbbrevAmount, except it stores the display amount. For example, a transferReceipt for</span>
<a name="l00468"></a>00468     <span class="comment">// a 5000 clam transfer has an effective value of 0 (since the transfer is already done) but it has a</span>
<a name="l00469"></a>00469     <span class="comment">// display amount of 5000.</span>
<a name="l00470"></a>00470     <span class="comment">// As with m_lAbbrevAmount, the Display amount value is calculated just before saving in abbreviated</span>
<a name="l00471"></a>00471     <span class="comment">// form, and this variable is only set upon LOADING that value in abbreviated form. The actual value</span>
<a name="l00472"></a>00472     <span class="comment">// only becomes available when loading the ACTUAL box receipt, at which time it should be compared to</span>
<a name="l00473"></a>00473     <span class="comment">// this one. (If loading the transaction fails, as a result of a failed verification there, then these</span>
<a name="l00474"></a>00474     <span class="comment">// numbers become pretty reliable and can be used in optimization, since the current process of loading</span>
<a name="l00475"></a>00475     <span class="comment">// transaction items from a string every time we need to check the amount, can be time-consuming, CPU-wise.)</span>
<a name="l00476"></a>00476     <span class="comment">//</span>
<a name="l00477"></a><a class="code" href="class_o_t_transaction.html#a0fd4b204101be3362541aa18ecdfbcfe">00477</a>     int64_t             <a class="code" href="class_o_t_transaction.html#a0fd4b204101be3362541aa18ecdfbcfe">m_lDisplayAmount</a>;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     <span class="comment">// The value of GetReferenceNumForDisplay() is saved when saving an abbreviated record of this transaction,</span>
<a name="l00480"></a>00480     <span class="comment">// and then loaded into THIS member variable when loading the abbreviated record.</span>
<a name="l00481"></a>00481     <span class="comment">//</span>
<a name="l00482"></a><a class="code" href="class_o_t_transaction.html#a73e1013374088a3a36fb83007a80c4bf">00482</a>     int64_t             <a class="code" href="class_o_t_transaction.html#a73e1013374088a3a36fb83007a80c4bf">m_lInRefDisplay</a>;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00485"></a>00485 
<a name="l00486"></a>00486     <span class="comment">// This hash is not stored inside the box receipt itself (a transaction that appears in an inbox, outbox, or nymbox)</span>
<a name="l00487"></a>00487     <span class="comment">// but rather, is set from above, and then verified against the actual box receipt once it is loaded.</span>
<a name="l00488"></a>00488     <span class="comment">// This verification occurs only when loading the box receipt, and this Hash value is not saved again to any</span>
<a name="l00489"></a>00489     <span class="comment">// location. When the abbreviated form of the box receipt is saved inside the inbox itself, it is easy to</span>
<a name="l00490"></a>00490     <span class="comment">// just create the hash at that time. Then upon loading the ledger (the box) the hash is set based on the abbreviated entry.</span>
<a name="l00491"></a>00491     <span class="comment">// The hash can then be verified against the actual box receipt by hashing that and comparing them, after which I no</span>
<a name="l00492"></a>00492     <span class="comment">// longer care about this variable at all, and do not save it again, since it can be re-calculated the next time we</span>
<a name="l00493"></a>00493     <span class="comment">// save again in abbreviated form.</span>
<a name="l00494"></a>00494     <span class="comment">//</span>
<a name="l00495"></a><a class="code" href="class_o_t_transaction.html#aecaea3ab1909c7102800ac991771b84d">00495</a>     <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>        <a class="code" href="class_o_t_transaction.html#aecaea3ab1909c7102800ac991771b84d">m_Hash</a>;         <span class="comment">// todo: make this const and force it to be set during construction.</span>
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00498"></a><a class="code" href="class_o_t_transaction.html#a88cd59fd4658e157f04e6b5b9a1868e0">00498</a>     <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>                <a class="code" href="class_o_t_transaction.html#a88cd59fd4658e157f04e6b5b9a1868e0">m_DATE_SIGNED</a>;  <span class="comment">// The date, in seconds, when the instrument was last signed.</span>
<a name="l00499"></a><a class="code" href="class_o_t_transaction.html#a11a0ffdda3eec332af5637526560ee6d">00499</a>     <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">transactionType</a>     <a class="code" href="class_o_t_transaction.html#a11a0ffdda3eec332af5637526560ee6d">m_Type</a>;         <span class="comment">// blank, pending, processInbox, transfer, deposit, withdrawal, trade, etc.</span>
<a name="l00500"></a><a class="code" href="class_o_t_transaction.html#a0a69941e6ccf8c6f399e06fbe2901c86">00500</a>     <a class="code" href="_o_t_item_8hpp.html#afed69f7c75742cc24ea837d6589e9d19">listOfItems</a>         <a class="code" href="class_o_t_transaction.html#a0a69941e6ccf8c6f399e06fbe2901c86">m_listItems</a>;    <span class="comment">// the various items in this transaction.</span>
<a name="l00501"></a>00501 
<a name="l00502"></a><a class="code" href="class_o_t_transaction.html#a3a2b17e72ec599dece6eb13208bde37c">00502</a>     int64_t         <a class="code" href="class_o_t_transaction.html#a3a2b17e72ec599dece6eb13208bde37c">m_lClosingTransactionNo</a>;    <span class="comment">// used by finalReceipt</span>
<a name="l00503"></a><a class="code" href="class_o_t_transaction.html#a115f7417f09e3e815212d770e7b60a1b">00503</a>     <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a>    <a class="code" href="class_o_t_transaction.html#a115f7417f09e3e815212d770e7b60a1b">m_ascCancellationRequest</a>;   <span class="comment">// used by finalReceipt</span>
<a name="l00504"></a>00504 
<a name="l00505"></a>00505     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00506"></a>00506     <span class="comment">// ONLY the &quot;replyNotice&quot; transaction uses this field.</span>
<a name="l00507"></a>00507     <span class="comment">// When replyNotices are dropped into your Nymbox (server notices</span>
<a name="l00508"></a>00508     <span class="comment">// of replies to messages you sent in the past) I wanted to put that</span>
<a name="l00509"></a>00509     <span class="comment">// they were &quot;in reference to&quot; a specific request number. But I don&#39;t</span>
<a name="l00510"></a>00510     <span class="comment">// want to muddy the &quot;in reference to&quot; code now which currently only</span>
<a name="l00511"></a>00511     <span class="comment">// references transaction numbers, not request numbers. Therefore I</span>
<a name="l00512"></a>00512     <span class="comment">// have added a special variable here for request numbers, so that</span>
<a name="l00513"></a>00513     <span class="comment">// replyNotices in the Nymbox can directly finger the messages they</span>
<a name="l00514"></a>00514     <span class="comment">// came from.</span>
<a name="l00515"></a>00515     <span class="comment">//</span>
<a name="l00516"></a><a class="code" href="class_o_t_transaction.html#a6fc95646e555b9c2ffb1404c6475ef56">00516</a>     int64_t    <a class="code" href="class_o_t_transaction.html#a6fc95646e555b9c2ffb1404c6475ef56">m_lRequestNumber</a>;     <span class="comment">// Unused except by &quot;replyNotice&quot; in Nymbox.</span>
<a name="l00517"></a><a class="code" href="class_o_t_transaction.html#a1631d08ab9b9759c5743fa0bfe9f7bdf">00517</a>     <span class="keywordtype">bool</span>    <a class="code" href="class_o_t_transaction.html#a1631d08ab9b9759c5743fa0bfe9f7bdf">m_bReplyTransSuccess</a>; <span class="comment">// Used only by replyNotice</span>
<a name="l00518"></a>00518     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00519"></a>00519     <span class="comment">// Unused except for @notarizeTransactions, specifically for @paymentPlan</span>
<a name="l00520"></a>00520     <span class="comment">// and @smartContract. (And maybe @depositCheque...) There are specific</span>
<a name="l00521"></a>00521     <span class="comment">// cases where the user sends through a transaction that is MEANT to be</span>
<a name="l00522"></a>00522     <span class="comment">// rejected by the server, for the purpose of cancelling that transaction.</span>
<a name="l00523"></a>00523     <span class="comment">// For example, if I sent a smart contract on to the next party, and then</span>
<a name="l00524"></a>00524     <span class="comment">// later I decided to cancel it (before the next party had the chance to</span>
<a name="l00525"></a>00525     <span class="comment">// activate it.) I send through the (incomplete) contract AS THOUGH to</span>
<a name="l00526"></a>00526     <span class="comment">// activate it, specifically so the activation will fail (and thus cancel</span>
<a name="l00527"></a>00527     <span class="comment">// the smart contract.) This prevents anyone from activating it in the</span>
<a name="l00528"></a>00528     <span class="comment">// future (thus, it&#39;s now &quot;cancelled.&quot;)</span>
<a name="l00529"></a>00529     <span class="comment">//</span>
<a name="l00530"></a>00530     <span class="comment">// In these cases, when I am &quot;cancelling&quot; something, a successful cancellation</span>
<a name="l00531"></a>00531     <span class="comment">// will result in a &quot;rejected&quot; reply from the server. A notice of this is</span>
<a name="l00532"></a>00532     <span class="comment">// sent to all the parties as well. The rejection notice causes all the</span>
<a name="l00533"></a>00533     <span class="comment">// parties to properly harvest their transaction numbers as they normally</span>
<a name="l00534"></a>00534     <span class="comment">// would when a smart contract fails activation. (Thus, a successful</span>
<a name="l00535"></a>00535     <span class="comment">// cancellation.)</span>
<a name="l00536"></a>00536     <span class="comment">//</span>
<a name="l00537"></a>00537     <span class="comment">// But how do we know the difference between a normal &quot;rejection&quot; versus</span>
<a name="l00538"></a>00538     <span class="comment">// a &quot;rejection&quot; that corresponds to a successful cancellation? That&#39;s</span>
<a name="l00539"></a>00539     <span class="comment">// what m_bCancelled is for. If the server has just successfully cancelled</span>
<a name="l00540"></a>00540     <span class="comment">// something, it will set m_bCancelled to TRUE (on the reply transaction.)</span>
<a name="l00541"></a>00541     <span class="comment">// This way the client side can tell the difference between an actual</span>
<a name="l00542"></a>00542     <span class="comment">// failed attempt marked as &quot;rejected&quot;, versus a successful cancellation</span>
<a name="l00543"></a>00543     <span class="comment">// marked as &quot;rejected.&quot; All the client has to do is check m_bCancelled</span>
<a name="l00544"></a>00544     <span class="comment">// to see if it&#39;s set to TRUE, and it will know.</span>
<a name="l00545"></a>00545 
<a name="l00546"></a><a class="code" href="class_o_t_transaction.html#ae02e3420135cba3514b4131d6427641d">00546</a>     <span class="keywordtype">bool</span>    <a class="code" href="class_o_t_transaction.html#ae02e3420135cba3514b4131d6427641d">m_bCancelled</a>;
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00549"></a>00549     <span class="comment">// Compares m_AcctID in the xml portion of the transaction</span>
<a name="l00550"></a>00550     <span class="comment">// with m_ID (supposedly the same number.)</span>
<a name="l00551"></a>00551 <span class="comment">//  bool VerifyContractID();</span>
<a name="l00552"></a>00552 
<a name="l00553"></a>00553     <span class="comment">// return -1 if error, 0 if nothing, and 1 if the node was processed.</span>
<a name="l00554"></a>00554     <span class="keyword">virtual</span> int32_t     <a class="code" href="class_o_t_transaction.html#a18d4d5da09f16aac3ccb97984ec021b1">ProcessXMLNode</a>(<a class="code" href="namespaceirr_1_1io.html#a1628edbb9d5d53f18c82d2a92b0ad27e">irr::io::IrrXMLReader</a>*&amp; xml);
<a name="l00555"></a>00555     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="class_o_t_transaction.html#a903a5b5d56e7f2856a51e2cdee6d511d">UpdateContents</a>(); <span class="comment">// Before transmission or serialization, this is where the transaction saves its contents</span>
<a name="l00556"></a>00556 
<a name="l00557"></a>00557     <a class="code" href="class_o_t_transaction.html#a0c71e0fea951a8d757e69ec369c5add0">OTTransaction</a>(); <span class="comment">// only the factory gets to use this one.</span>
<a name="l00558"></a>00558     <span class="comment">// -------------------------------------------</span>
<a name="l00559"></a>00559 <span class="keyword">public</span>:
<a name="l00560"></a>00560 
<a name="l00561"></a><a class="code" href="class_o_t_transaction.html#aeabba0a2b6a52c8f50a329f7d14a1ba1">00561</a> EXPORT    <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#aeabba0a2b6a52c8f50a329f7d14a1ba1">IsCancelled</a>()    { <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#ae02e3420135cba3514b4131d6427641d">m_bCancelled</a>; }
<a name="l00562"></a><a class="code" href="class_o_t_transaction.html#a897714409d64aefd879ea08ec2e1731a">00562</a> EXPORT    <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#a897714409d64aefd879ea08ec2e1731a">SetAsCancelled</a>() { <a class="code" href="class_o_t_transaction.html#ae02e3420135cba3514b4131d6427641d">m_bCancelled</a> = <span class="keyword">true</span>; }
<a name="l00563"></a>00563     <span class="comment">// -------------------------------------------</span>
<a name="l00564"></a><a class="code" href="class_o_t_transaction.html#aceb0b4c83da5f50512bf6045fef6583b">00564</a>     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#aceb0b4c83da5f50512bf6045fef6583b">SetParent</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_ledger.html">OTLedger</a> &amp; theParent) { <a class="code" href="class_o_t_transaction.html#abb869752baf350d380c0afa81d84d1de">m_pParent</a> = &amp;theParent; } <span class="comment">// a pointer of convenience.</span>
<a name="l00565"></a>00565     <span class="comment">// -------------------------------------------</span>
<a name="l00566"></a>00566     <span class="comment">// For &quot;OTTransaction::blank&quot; and &quot;OTTransaction::successNotice&quot;</span>
<a name="l00567"></a>00567     <span class="comment">//</span>
<a name="l00568"></a>00568 EXPORT    <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a492f3f835f309bd2e76e5d7cc4dc10a1">AddNumbersToTransaction</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_num_list.html">OTNumList</a> &amp; theAddition);
<a name="l00569"></a>00569     <span class="comment">// -------------------------------------------</span>
<a name="l00570"></a>00570     <span class="keyword">static</span>
<a name="l00571"></a>00571     int32_t <a class="code" href="class_o_t_transaction.html#aa0726f273b313b03bad0390ed2b8bb19">LoadAbbreviatedRecord</a>(<a class="code" href="namespaceirr_1_1io.html#a1628edbb9d5d53f18c82d2a92b0ad27e">irr::io::IrrXMLReader</a>*&amp; xml,
<a name="l00572"></a>00572                               int64_t   &amp; lNumberOfOrigin,
<a name="l00573"></a>00573                               int64_t   &amp; lTransactionNum,
<a name="l00574"></a>00574                               int64_t   &amp; lInRefTo,
<a name="l00575"></a>00575                               int64_t   &amp; lInRefDisplay,
<a name="l00576"></a>00576                               <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>  &amp; the_DATE_SIGNED,
<a name="l00577"></a>00577                               <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">OTTransaction::transactionType</a> &amp; theType,
<a name="l00578"></a>00578                               <a class="code" href="class_o_t_string.html">OTString</a> &amp; strHash,
<a name="l00579"></a>00579                               int64_t   &amp; lAdjustment,
<a name="l00580"></a>00580                               int64_t   &amp; lDisplayValue,
<a name="l00581"></a>00581                               int64_t   &amp; lClosingNum,
<a name="l00582"></a>00582                               int64_t   &amp; lRequestNum,
<a name="l00583"></a>00583                               <span class="keywordtype">bool</span>  &amp; bReplyTransSuccess,
<a name="l00584"></a>00584                               <a class="code" href="class_o_t_num_list.html">OTNumList</a> * pNumList=NULL);
<a name="l00585"></a>00585 
<a name="l00586"></a><a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">00586</a>     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#a1298e2f51b0a9471bc6b1aa8905b70f9">m_bIsAbbreviated</a>; }
<a name="l00587"></a>00587 
<a name="l00588"></a><a class="code" href="class_o_t_transaction.html#a26f3f7cf81e9b5fdd2c66646713a4e95">00588</a>     int64_t <a class="code" href="class_o_t_transaction.html#a26f3f7cf81e9b5fdd2c66646713a4e95">GetAbbrevAdjustment</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#ae1f24fb2a4460c4b695e7628fc78890e">m_lAbbrevAmount</a>; }
<a name="l00589"></a><a class="code" href="class_o_t_transaction.html#aa068df53b397fd48fe4af07910eeb86d">00589</a>     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#aa068df53b397fd48fe4af07910eeb86d">SetAbbrevAdjustment</a>(<span class="keyword">const</span> int64_t lAmount) { <a class="code" href="class_o_t_transaction.html#ae1f24fb2a4460c4b695e7628fc78890e">m_lAbbrevAmount</a> = lAmount; }
<a name="l00590"></a>00590 
<a name="l00591"></a><a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">00591</a>     int64_t <a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#a0fd4b204101be3362541aa18ecdfbcfe">m_lDisplayAmount</a>; }
<a name="l00592"></a><a class="code" href="class_o_t_transaction.html#a93386652206ed5d439ed03abf9798d92">00592</a>     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#a93386652206ed5d439ed03abf9798d92">SetAbbrevDisplayAmount</a>(<span class="keyword">const</span> int64_t lAmount) { <a class="code" href="class_o_t_transaction.html#a0fd4b204101be3362541aa18ecdfbcfe">m_lDisplayAmount</a> = lAmount; }
<a name="l00593"></a>00593 
<a name="l00594"></a><a class="code" href="class_o_t_transaction.html#a5d52aa9eeff78830b9ba53585e36a2ad">00594</a>     int64_t <a class="code" href="class_o_t_transaction.html#a5d52aa9eeff78830b9ba53585e36a2ad">GetAbbrevInRefDisplay</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#a73e1013374088a3a36fb83007a80c4bf">m_lInRefDisplay</a>; }
<a name="l00595"></a><a class="code" href="class_o_t_transaction.html#a46dc320ee8a88d5a647c014a1cdbbd65">00595</a>     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#a46dc320ee8a88d5a647c014a1cdbbd65">SetAbbrevInRefDisplay</a>(<span class="keyword">const</span> int64_t lAmount) { <a class="code" href="class_o_t_transaction.html#a73e1013374088a3a36fb83007a80c4bf">m_lInRefDisplay</a> = lAmount; }
<a name="l00596"></a>00596     <span class="comment">// -------------------------------------------</span>
<a name="l00597"></a>00597     <span class="comment">// These are used exclusively by replyNotice (so you can tell</span>
<a name="l00598"></a>00598     <span class="comment">// which reply message it&#39;s a notice of.)</span>
<a name="l00599"></a>00599     <span class="comment">//</span>
<a name="l00600"></a><a class="code" href="class_o_t_transaction.html#aa90624fb50b1b0edb72c6d4bd7b01a4c">00600</a>     <span class="keyword">const</span> int64_t &amp; <a class="code" href="class_o_t_transaction.html#aa90624fb50b1b0edb72c6d4bd7b01a4c">GetRequestNum</a>()<span class="keyword"> const            </span>{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#a6fc95646e555b9c2ffb1404c6475ef56">m_lRequestNumber</a>; }
<a name="l00601"></a><a class="code" href="class_o_t_transaction.html#a8db20f109eab5bf715673bfcf3b3bb4f">00601</a>     <span class="keywordtype">void</span>         <a class="code" href="class_o_t_transaction.html#a8db20f109eab5bf715673bfcf3b3bb4f">SetRequestNum</a>(<span class="keyword">const</span> int64_t &amp; lNum) { <a class="code" href="class_o_t_transaction.html#a6fc95646e555b9c2ffb1404c6475ef56">m_lRequestNumber</a> = lNum; }
<a name="l00602"></a>00602 
<a name="l00603"></a><a class="code" href="class_o_t_transaction.html#aa2d20865cc45e7b94df2cc4b84cb5911">00603</a>     <span class="keywordtype">bool</span>         <a class="code" href="class_o_t_transaction.html#aa2d20865cc45e7b94df2cc4b84cb5911">GetReplyTransSuccess</a>()                { <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#a1631d08ab9b9759c5743fa0bfe9f7bdf">m_bReplyTransSuccess</a>; }
<a name="l00604"></a><a class="code" href="class_o_t_transaction.html#a3099413a51aa3ec99b783a4e89144150">00604</a>     <span class="keywordtype">void</span>         <a class="code" href="class_o_t_transaction.html#a3099413a51aa3ec99b783a4e89144150">SetReplyTransSuccess</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> bVal) {  <a class="code" href="class_o_t_transaction.html#a1631d08ab9b9759c5743fa0bfe9f7bdf">m_bReplyTransSuccess</a> = bVal;  }
<a name="l00605"></a>00605     <span class="comment">// -------------------------------------------</span>
<a name="l00606"></a>00606     <span class="comment">// These are used for finalReceipt and basketReceipt</span>
<a name="l00607"></a>00607 EXPORT  int64_t <a class="code" href="class_o_t_transaction.html#aeaa0c946e4a737e0144cbbf102f37ed4">GetClosingNum</a>() <span class="keyword">const</span>;
<a name="l00608"></a>00608 EXPORT  <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#af3c025bbdeb70a053c6149a32d8b9940">SetClosingNum</a>(<span class="keyword">const</span> int64_t lClosingNum);
<a name="l00609"></a>00609     <span class="comment">// -------------------------------------------</span>
<a name="l00610"></a>00610 EXPORT  <span class="keyword">virtual</span> int64_t <a class="code" href="class_o_t_transaction.html#ad39211b22193f35493b07e2eea92d3f5">GetNumberOfOrigin</a>(); <span class="comment">// Calculates if necessary.</span>
<a name="l00611"></a>00611 EXPORT  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#ac20ace2092e06d5bf3d624b03eb6d623">CalculateNumberOfOrigin</a>();
<a name="l00612"></a>00612     <span class="comment">// -------------------------------------------</span>
<a name="l00613"></a>00613 EXPORT  int64_t <a class="code" href="class_o_t_transaction.html#a7a4463450cc735aea9b924011f073bb3">GetReferenceNumForDisplay</a>(); 
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 EXPORT  <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a1091822e3072f014a8b2f64b93917ca7" title="For display purposes. The &quot;ref #&quot; you actually display (versus the one you use internally) might chan...">GetSenderUserIDForDisplay</a>   (<a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theReturnID);
<a name="l00616"></a>00616 EXPORT  <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(<a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theReturnID);
<a name="l00617"></a>00617 
<a name="l00618"></a>00618 EXPORT  <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#acf66d9f8f5d3a6e4ee0a418a41db6019">GetSenderAcctIDForDisplay</a>   (<a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theReturnID);
<a name="l00619"></a>00619 EXPORT  <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(<a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theReturnID);
<a name="l00620"></a>00620     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00621"></a>00621 EXPORT  <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#abc54a3c74c5235cfe1debe4a2f97c2cd">GetMemo</a>(<a class="code" href="class_o_t_string.html">OTString</a> &amp; strMemo);
<a name="l00622"></a>00622     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00623"></a>00623         <span class="keyword">inline</span>
<a name="l00624"></a><a class="code" href="class_o_t_transaction.html#afb069b9f7ab72f90e9e42aed0ba3b17c">00624</a>         <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>  <a class="code" href="class_o_t_transaction.html#afb069b9f7ab72f90e9e42aed0ba3b17c">GetDateSigned</a>()<span class="keyword">   const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#a88cd59fd4658e157f04e6b5b9a1868e0">m_DATE_SIGNED</a>; }
<a name="l00625"></a>00625 EXPORT  <span class="keywordtype">bool</span>    <a class="code" href="class_o_t_transaction.html#ac5ffc9f0e274bbc617185a5335c061a3">GetSuccess</a>(); <span class="comment">// Tries to determine, based on items within, whether it was a success or fail.</span>
<a name="l00626"></a>00626 EXPORT  int64_t    <a class="code" href="class_o_t_transaction.html#a7a01fdc95811465496f953c5a50dcef6">GetReceiptAmount</a>(); <span class="comment">// Tries to determine IF there is an amount (depending on type) and return it.</span>
<a name="l00627"></a>00627     <span class="comment">// ----------------------------------------------------------------</span>
<a name="l00628"></a>00628         <a class="code" href="class_o_t_transaction.html#a0c71e0fea951a8d757e69ec369c5add0">OTTransaction</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_ledger.html">OTLedger</a> &amp; theOwner);
<a name="l00629"></a>00629 EXPORT  <a class="code" href="class_o_t_transaction.html#a0c71e0fea951a8d757e69ec369c5add0">OTTransaction</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theUserID, <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAccountID, <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theServerID);
<a name="l00630"></a>00630         <a class="code" href="class_o_t_transaction.html#a0c71e0fea951a8d757e69ec369c5add0">OTTransaction</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theUserID, <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAccountID, <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theServerID, int64_t lTransactionNum);
<a name="l00631"></a>00631 
<a name="l00632"></a>00632     <span class="comment">// THIS constructor only used when loading an abbreviated box receipt (inbox, nymbox, or outbox receipt).</span>
<a name="l00633"></a>00633     <span class="comment">// The full receipt is loaded only after the abbreviated ones are loaded, and verified against them.</span>
<a name="l00634"></a>00634     <span class="comment">//</span>
<a name="l00635"></a>00635     <a class="code" href="class_o_t_transaction.html#a0c71e0fea951a8d757e69ec369c5add0">OTTransaction</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theUserID,
<a name="l00636"></a>00636                   <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAccountID,
<a name="l00637"></a>00637                   <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theServerID,
<a name="l00638"></a>00638                   <span class="keyword">const</span> int64_t &amp; lNumberOfOrigin,
<a name="l00639"></a>00639                   <span class="keyword">const</span> int64_t &amp; lTransactionNum,
<a name="l00640"></a>00640                   <span class="keyword">const</span> int64_t &amp; lInRefTo,
<a name="l00641"></a>00641                   <span class="keyword">const</span> int64_t &amp; lInRefDisplay,
<a name="l00642"></a>00642                   <span class="keyword">const</span> <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> the_DATE_SIGNED,
<a name="l00643"></a>00643                   <span class="keyword">const</span> <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">transactionType</a> theType,
<a name="l00644"></a>00644                   <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> &amp; strHash,
<a name="l00645"></a>00645                   <span class="keyword">const</span> int64_t &amp; lAdjustment,
<a name="l00646"></a>00646                   <span class="keyword">const</span> int64_t &amp; lDisplayValue,
<a name="l00647"></a>00647                   <span class="keyword">const</span> int64_t &amp; lClosingNum,
<a name="l00648"></a>00648                   <span class="keyword">const</span> int64_t &amp; lRequestNum,
<a name="l00649"></a>00649                   <span class="keywordtype">bool</span>         bReplyTransSuccess,
<a name="l00650"></a>00650                   <a class="code" href="class_o_t_num_list.html">OTNumList</a> * pNumList=NULL);
<a name="l00651"></a>00651 
<a name="l00652"></a>00652 EXPORT  <span class="keyword">virtual</span> <a class="code" href="class_o_t_transaction.html#a428b050396c72e438cd39349f6ea8948">~OTTransaction</a>();
<a name="l00653"></a>00653     <span class="comment">// ----------------------------------</span>
<a name="l00654"></a>00654     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a5bfc7ce34aa67cf9dad96e661e118020">GenerateTransaction</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAccountID, <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theServerID, int64_t lTransactionNum);
<a name="l00655"></a>00655 
<a name="l00656"></a>00656 EXPORT  <span class="keyword">static</span>
<a name="l00657"></a>00657     <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * <a class="code" href="class_o_t_transaction.html#a5bfc7ce34aa67cf9dad96e661e118020">GenerateTransaction</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theUserID, <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAccountID,
<a name="l00658"></a>00658                                         <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theServerID, <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">transactionType</a> theType,
<a name="l00659"></a>00659                                         int64_t lTransactionNum=0);
<a name="l00660"></a>00660 EXPORT  <span class="keyword">static</span>
<a name="l00661"></a>00661     <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * <a class="code" href="class_o_t_transaction.html#a5bfc7ce34aa67cf9dad96e661e118020">GenerateTransaction</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_ledger.html">OTLedger</a> &amp; theOwner, <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">transactionType</a> theType, int64_t lTransactionNum=0);
<a name="l00662"></a>00662     <span class="comment">// ----------------------------------</span>
<a name="l00663"></a>00663     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#af41d3b8e4611e5a9e4d7f729a61a6478">InitTransaction</a>();
<a name="l00664"></a>00664     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#af729ee60ed39ff6f918873aedfc7a0af">ReleaseItems</a>();
<a name="l00665"></a>00665     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#a4f9c8be70e01dfcd7bedbac7d6af887b">Release</a>();
<a name="l00666"></a>00666     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#a6548cbe73252c7554db6f6ceddebc5ae">Release_Transaction</a>();
<a name="l00667"></a>00667     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00668"></a>00668     <span class="keyword">inline</span>
<a name="l00669"></a><a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">00669</a>     <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">transactionType</a>  <a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#a11a0ffdda3eec332af5637526560ee6d">m_Type</a>; }
<a name="l00670"></a>00670     <span class="keyword">inline</span>
<a name="l00671"></a><a class="code" href="class_o_t_transaction.html#a12494b5a0460ce08f67033e0523caf97">00671</a>     <span class="keywordtype">void</span>             <a class="code" href="class_o_t_transaction.html#a12494b5a0460ce08f67033e0523caf97">SetType</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">transactionType</a> theType) { <a class="code" href="class_o_t_transaction.html#a11a0ffdda3eec332af5637526560ee6d">m_Type</a> = theType; }
<a name="l00672"></a>00672     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00673"></a>00673     <span class="comment">// This function assumes that theLedger is the owner of this transaction.</span>
<a name="l00674"></a>00674     <span class="comment">// We pass the ledger in so we can determine the proper directory we&#39;re</span>
<a name="l00675"></a>00675     <span class="comment">// reading from.</span>
<a name="l00676"></a>00676 EXPORT    <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a2f991feb7c6178ffabefc7fef312d26e">SaveBoxReceipt</a>     (<span class="keyword">const</span> int64_t lLedgerType);
<a name="l00677"></a>00677 EXPORT    <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a2f991feb7c6178ffabefc7fef312d26e">SaveBoxReceipt</a>     (<a class="code" href="class_o_t_ledger.html">OTLedger</a> &amp; theLedger);
<a name="l00678"></a>00678 EXPORT    <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#ac2e9b2e8e4a00f439109273b6a7ea658">DeleteBoxReceipt</a>   (<a class="code" href="class_o_t_ledger.html">OTLedger</a> &amp; theLedger);
<a name="l00679"></a>00679     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00680"></a>00680     <span class="comment">// Caller IS responsible to delete.</span>
<a name="l00681"></a>00681     <span class="keyword">static</span>
<a name="l00682"></a>00682     <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * <a class="code" href="class_o_t_transaction.html#ae97bc794fe820f4f2e864c29c42df8eb">LoadBoxReceipt</a>(<a class="code" href="class_o_t_transaction.html">OTTransaction</a> &amp; theAbbrev, <a class="code" href="class_o_t_ledger.html">OTLedger</a> &amp; theLedger);
<a name="l00683"></a>00683 EXPORT  <span class="keyword">static</span>
<a name="l00684"></a>00684     <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * <a class="code" href="class_o_t_transaction.html#ae97bc794fe820f4f2e864c29c42df8eb">LoadBoxReceipt</a>(<a class="code" href="class_o_t_transaction.html">OTTransaction</a> &amp; theAbbrev, <span class="keyword">const</span> int64_t lLedgerType);
<a name="l00685"></a>00685 
<a name="l00686"></a>00686     <span class="comment">// Call on abbreviated version, and pass in the purported full version.</span>
<a name="l00687"></a>00687     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a51fc66087f5a0acdfc4a1054298b23b7">VerifyBoxReceipt</a>(<a class="code" href="class_o_t_transaction.html">OTTransaction</a> &amp; theFullVersion);
<a name="l00688"></a>00688     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00689"></a>00689 EXPORT <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#acf756f8e3b1d1b9f1e9d2bcb48cbe927">VerifyBoxReceiptExists</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; SERVER_ID,
<a name="l00690"></a>00690                                           <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; USER_ID,
<a name="l00691"></a>00691                                           <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; ACCOUNT_ID,    <span class="comment">// If for Nymbox (vs inbox/outbox) then pass USER_ID in this field also.</span>
<a name="l00692"></a>00692                                           <span class="keyword">const</span> int32_t         nBoxType,       <span class="comment">// 0/nymbox, 1/inbox, 2/outbox</span>
<a name="l00693"></a>00693                                           <span class="keyword">const</span> int64_t       &amp; lTransactionNum);
<a name="l00694"></a>00694     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00695"></a>00695     <span class="keyword">static</span>
<a name="l00696"></a>00696     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a186d091553baa52c0d1e252b05432e4d">SetupBoxReceiptFilename</a>(<span class="keyword">const</span> int64_t lLedgerType,
<a name="l00697"></a>00697                                  <a class="code" href="class_o_t_transaction.html">OTTransaction</a> &amp; theTransaction,
<a name="l00698"></a>00698                                  <span class="keyword">const</span> <span class="keywordtype">char</span> * szCaller,
<a name="l00699"></a>00699                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFolder1name,
<a name="l00700"></a>00700                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFolder2name,
<a name="l00701"></a>00701                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFolder3name,
<a name="l00702"></a>00702                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFilename);
<a name="l00703"></a>00703     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00704"></a>00704     <span class="keyword">static</span>
<a name="l00705"></a>00705     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a186d091553baa52c0d1e252b05432e4d">SetupBoxReceiptFilename</a>(<a class="code" href="class_o_t_ledger.html">OTLedger</a> &amp; theLedger,
<a name="l00706"></a>00706                                  <a class="code" href="class_o_t_transaction.html">OTTransaction</a> &amp; theTransaction,
<a name="l00707"></a>00707                                  <span class="keyword">const</span> <span class="keywordtype">char</span> * szCaller,
<a name="l00708"></a>00708                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFolder1name,
<a name="l00709"></a>00709                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFolder2name,
<a name="l00710"></a>00710                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFolder3name,
<a name="l00711"></a>00711                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFilename);
<a name="l00712"></a>00712     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00713"></a>00713     <span class="keyword">static</span>
<a name="l00714"></a>00714     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a186d091553baa52c0d1e252b05432e4d">SetupBoxReceiptFilename</a>(<span class="keyword">const</span> int64_t        lLedgerType,
<a name="l00715"></a>00715                                  <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> &amp; strUserOrAcctID,
<a name="l00716"></a>00716                                  <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> &amp; strServerID,
<a name="l00717"></a>00717                                  <span class="keyword">const</span> int64_t      &amp; lTransactionNum,
<a name="l00718"></a>00718                                  <span class="keyword">const</span> <span class="keywordtype">char</span> * szCaller,
<a name="l00719"></a>00719                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFolder1name,
<a name="l00720"></a>00720                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFolder2name,
<a name="l00721"></a>00721                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFolder3name,
<a name="l00722"></a>00722                                  <a class="code" href="class_o_t_string.html">OTString</a> &amp; strFilename);
<a name="l00723"></a>00723     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00724"></a>00724 
<a name="l00725"></a>00725     <span class="comment">// Balance receipts are used in transactions that change an account balance.</span>
<a name="l00726"></a>00726 EXPORT  <span class="keyword">static</span>
<a name="l00727"></a>00727     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#ae4bcd8edaf9b3cb72b0a68d503af804c">VerifyBalanceReceipt</a>(<a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; SERVER_NYM,
<a name="l00728"></a>00728                               <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; THE_NYM,
<a name="l00729"></a>00729                               <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; SERVER_ID,
<a name="l00730"></a>00730                               <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; ACCT_ID);
<a name="l00731"></a>00731 
<a name="l00732"></a>00732     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#ae4bcd8edaf9b3cb72b0a68d503af804c">VerifyBalanceReceipt</a>(<a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; SERVER_NYM, <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; THE_NYM);
<a name="l00733"></a>00733     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00734"></a>00734     <span class="comment">// Transaction receipts are used where you don&#39;t need to change an account balance,</span>
<a name="l00735"></a>00735     <span class="comment">// but you still need to have an agreement about which transaction numbers are</span>
<a name="l00736"></a>00736     <span class="comment">// signed out.</span>
<a name="l00737"></a>00737     <span class="comment">//</span>
<a name="l00738"></a>00738     <span class="keyword">static</span>
<a name="l00739"></a>00739     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a3ce6cac1f366f808f0296473138363eb">VerifyTransactionReceipt</a>(<a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; SERVER_NYM,
<a name="l00740"></a>00740                                   <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; THE_NYM,
<a name="l00741"></a>00741                                   <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; SERVER_ID);
<a name="l00742"></a>00742 
<a name="l00743"></a>00743     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a3ce6cac1f366f808f0296473138363eb">VerifyTransactionReceipt</a>(<a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; SERVER_NYM, <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; THE_NYM);
<a name="l00744"></a>00744     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00745"></a>00745     <span class="comment">// First VerifyContractID() is performed already on all the items when</span>
<a name="l00746"></a>00746     <span class="comment">// they are first loaded up. ServerID and AccountID have been verified.</span>
<a name="l00747"></a>00747     <span class="comment">// Now we check ownership, and signatures, and transaction #s, etc.</span>
<a name="l00748"></a>00748     <span class="comment">// (We go deeper.)</span>
<a name="l00749"></a>00749 EXPORT  <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a196bf845f57deaf4e04493e462fd6d97">VerifyItems</a>(<a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; theNym);
<a name="l00750"></a>00750     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00751"></a>00751     <span class="comment">// This calls VerifyContractID() as well as VerifySignature()</span>
<a name="l00752"></a>00752     <span class="comment">// Use this instead of OTContract::VerifyContract, which expects/uses a pubkey from inside the contract.</span>
<a name="l00753"></a>00753     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#afba0d981b40568e307178f908788fd7b">VerifyAccount</a>(<a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; theNym);  <span class="comment">// This overrides OTTransactionType::VerifyAccount()</span>
<a name="l00754"></a>00754     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00755"></a>00755 
<a name="l00756"></a>00756     <span class="keyword">inline</span>
<a name="l00757"></a><a class="code" href="class_o_t_transaction.html#aab7ec90e81dc8f273b8c29617e40bab6">00757</a>     int32_t <a class="code" href="class_o_t_transaction.html#aab7ec90e81dc8f273b8c29617e40bab6">GetItemCount</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> (<a class="code" href="class_o_t_transaction.html#a0a69941e6ccf8c6f399e06fbe2901c86">m_listItems</a>.size()); }
<a name="l00758"></a>00758     int32_t <a class="code" href="class_o_t_transaction.html#a95246c5281488bbde41f3be2cc096a5f">GetItemCountInRefTo</a>(<span class="keyword">const</span> int64_t lReference); <span class="comment">// Count the number of items that are IN REFERENCE TO some transaction#.</span>
<a name="l00759"></a>00759 
<a name="l00760"></a>00760     <span class="comment">// While processing a transaction, you may wish to query it for items of a certain type.</span>
<a name="l00761"></a>00761 EXPORT  <a class="code" href="class_o_t_item.html">OTItem</a> * <a class="code" href="class_o_t_transaction.html#a62bf5069d7a7fda92fa1d6746a75bb49">GetItem</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_item.html#a03db091faaab100aadc455f4ebe2c5d1">OTItem::itemType</a> theType);
<a name="l00762"></a>00762 EXPORT  <a class="code" href="class_o_t_item.html">OTItem</a> * <a class="code" href="class_o_t_transaction.html#a45f5abaf0110fbd5abe7ab3a00699703">GetItemInRefTo</a>(<span class="keyword">const</span> int64_t lReference);
<a name="l00763"></a>00763 
<a name="l00764"></a>00764 EXPORT  <span class="keywordtype">void</span>    <a class="code" href="class_o_t_transaction.html#a5abc071b7eeddc40ea151cccd011e4d6">AddItem</a>(<a class="code" href="class_o_t_item.html">OTItem</a> &amp; theItem);  <span class="comment">// You have to allocate the item on the heap and then pass it in as a reference.</span>
<a name="l00765"></a>00765                                             <span class="comment">// OTTransaction will take care of it from there and will delete it in destructor.</span>
<a name="l00766"></a>00766     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00767"></a>00767     <span class="comment">// used for looping through the items in a few places.</span>
<a name="l00768"></a>00768     <span class="keyword">inline</span>
<a name="l00769"></a><a class="code" href="class_o_t_transaction.html#a9821c541d3d5f92e378320c6aa190c18">00769</a>     <a class="code" href="_o_t_item_8hpp.html#afed69f7c75742cc24ea837d6589e9d19">listOfItems</a> &amp;   <a class="code" href="class_o_t_transaction.html#a9821c541d3d5f92e378320c6aa190c18">GetItemList</a>() { <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#a0a69941e6ccf8c6f399e06fbe2901c86">m_listItems</a>; }
<a name="l00770"></a>00770     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00771"></a>00771 <span class="comment">//  virtual bool SaveContractWallet(FILE * fl);</span>
<a name="l00772"></a>00772     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a23e270a9dfc3b85d48d64582814232e5">SaveContractWallet</a>(std::ofstream &amp; ofs);
<a name="l00773"></a>00773     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00774"></a>00774     <span class="comment">// Because all of the actual receipts cannot fit into the single inbox</span>
<a name="l00775"></a>00775     <span class="comment">// file, you must put their hash, and then store the receipt itself</span>
<a name="l00776"></a>00776     <span class="comment">// separately...</span>
<a name="l00777"></a>00777     <span class="comment">//</span>
<a name="l00778"></a>00778     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#add17ff12beaf8f0ba84b73b6b564f5b0">SaveAbbreviatedNymboxRecord</a>(<a class="code" href="class_o_t_string.html">OTString</a> &amp; strOutput);
<a name="l00779"></a>00779     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#a0ea6c7483a961acfdef55cd992e4065d">SaveAbbreviatedOutboxRecord</a>(<a class="code" href="class_o_t_string.html">OTString</a> &amp; strOutput);
<a name="l00780"></a>00780     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#ab15380c235814aeb89779fb5f42401d4">SaveAbbreviatedInboxRecord</a>(<a class="code" href="class_o_t_string.html">OTString</a> &amp; strOutput);
<a name="l00781"></a>00781     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00782"></a>00782     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#ac30eb05906f92766b5ce895854e682a3">SaveAbbrevPaymentInboxRecord</a>(<a class="code" href="class_o_t_string.html">OTString</a> &amp; strOutput);
<a name="l00783"></a>00783     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#a08424e75b8906896335609d7ca45c729">SaveAbbrevRecordBoxRecord</a>(<a class="code" href="class_o_t_string.html">OTString</a> &amp; strOutput);
<a name="l00784"></a>00784     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#af73fe383da8254ef5cd2c8a27de79a29">SaveAbbrevExpiredBoxRecord</a>(<a class="code" href="class_o_t_string.html">OTString</a> &amp; strOutput);
<a name="l00785"></a>00785     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00786"></a>00786     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#a4a89382fb0a9a3500c19fe9107df3122">ProduceInboxReportItem</a>(<a class="code" href="class_o_t_item.html">OTItem</a> &amp; theBalanceItem);
<a name="l00787"></a>00787     <span class="keywordtype">void</span> <a class="code" href="class_o_t_transaction.html#a1820ab7e64e5cd46baf19f21ce2f0bf0">ProduceOutboxReportItem</a>(<a class="code" href="class_o_t_item.html">OTItem</a> &amp; theBalanceItem);
<a name="l00788"></a>00788     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00789"></a>00789     <span class="keyword">static</span>
<a name="l00790"></a>00790     <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">transactionType</a> <a class="code" href="class_o_t_transaction.html#a806b1bd373a5777b5a41d5141e9e914d">GetTypeFromString</a>(<span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> &amp; strType);
<a name="l00791"></a>00791     <span class="comment">// --------------------------------------------------------------</span>
<a name="l00792"></a>00792 EXPORT  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="class_o_t_transaction.html#ab32a4098c75d0e48616e65caafa60fe0">_GetTypeString</a>(<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8">transactionType</a> theType);
<a name="l00793"></a>00793 
<a name="l00794"></a><a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">00794</a>     <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_transaction.html#ab32a4098c75d0e48616e65caafa60fe0">OTTransaction::_GetTypeString</a>(<a class="code" href="class_o_t_transaction.html#a11a0ffdda3eec332af5637526560ee6d">m_Type</a>); }
<a name="l00795"></a>00795     <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00796"></a>00796     <span class="comment">// These functions are fairly smart about which transaction types are harvestable,</span>
<a name="l00797"></a>00797     <span class="comment">// in which situations (based on the bools.) As long as you use the bools correctly,</span>
<a name="l00798"></a>00798     <span class="comment">// you aren&#39;t likely to accidentally harvest an opening number unless you are SUPPOSED</span>
<a name="l00799"></a>00799     <span class="comment">// to harvest it, based on its type and the circumstances. Just make sure you are accurate</span>
<a name="l00800"></a>00800     <span class="comment">// when you tell it the circumstances (bools!)</span>
<a name="l00801"></a>00801     <span class="comment">//</span>
<a name="l00802"></a>00802     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#ac8a30dd62230f12131a77471796fd88a">HarvestOpeningNumber</a>(<a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; theNym,
<a name="l00803"></a>00803                               <span class="keyword">const</span> <span class="keywordtype">bool</span>    bHarvestingForRetry,     <span class="comment">// exchangeBasket, on retry, needs to clawback the opening # because it will be using another opening # the next time OT_API_exchangeBasket() is called.</span>
<a name="l00804"></a>00804                               <span class="keyword">const</span> <span class="keywordtype">bool</span>    bReplyWasSuccess,        <span class="comment">// false until positively asserted.</span>
<a name="l00805"></a>00805                               <span class="keyword">const</span> <span class="keywordtype">bool</span>    bReplyWasFailure,        <span class="comment">// false until positively asserted.</span>
<a name="l00806"></a>00806                               <span class="keyword">const</span> <span class="keywordtype">bool</span>    bTransactionWasSuccess,  <span class="comment">// false until positively asserted.</span>
<a name="l00807"></a>00807                               <span class="keyword">const</span> <span class="keywordtype">bool</span>    bTransactionWasFailure); <span class="comment">// false until positively asserted.</span>
<a name="l00808"></a>00808 
<a name="l00809"></a>00809     <span class="comment">// NOTE: IN CASE it&#39;s not obvious, the NYM is harvesting numbers from the TRANSACTION, and</span>
<a name="l00810"></a>00810     <span class="comment">// not the other way around!</span>
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     <span class="comment">// Normally do this if your transaction ran--and failed--so you can get most of</span>
<a name="l00813"></a>00813     <span class="comment">// your transaction numbers back. (The opening number is already gone, but any</span>
<a name="l00814"></a>00814     <span class="comment">// others are still salvageable.)</span>
<a name="l00815"></a>00815     <span class="comment">//</span>
<a name="l00816"></a>00816     <span class="keywordtype">bool</span> <a class="code" href="class_o_t_transaction.html#a024827b70ceaf1f9fbf10bd505de348a">HarvestClosingNumbers</a>(<a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp; theNym,
<a name="l00817"></a>00817                                <span class="keyword">const</span> <span class="keywordtype">bool</span>    bHarvestingForRetry,     <span class="comment">// exchangeBasket, on retry, needs to clawback the opening # because it will be using another opening # the next time OT_API_exchangeBasket() is called.</span>
<a name="l00818"></a>00818                                <span class="keyword">const</span> <span class="keywordtype">bool</span>    bReplyWasSuccess,        <span class="comment">// false until positively asserted.</span>
<a name="l00819"></a>00819                                <span class="keyword">const</span> <span class="keywordtype">bool</span>    bReplyWasFailure,        <span class="comment">// false until positively asserted.</span>
<a name="l00820"></a>00820                                <span class="keyword">const</span> <span class="keywordtype">bool</span>    bTransactionWasSuccess,  <span class="comment">// false until positively asserted.</span>
<a name="l00821"></a>00821                                <span class="keyword">const</span> <span class="keywordtype">bool</span>    bTransactionWasFailure); <span class="comment">// false until positively asserted.</span>
<a name="l00822"></a>00822 };
<a name="l00823"></a>00823 
<a name="l00824"></a>00824 
<a name="l00825"></a>00825 <span class="preprocessor">#endif // __OT_TRANSACTION_HPP__</span>
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_o_t_transaction_8hpp.html">OTTransaction.hpp</a>      </li>

    <li class="footer">Generated on Wed May 21 2014 11:26:01 for Open-Transactions by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
