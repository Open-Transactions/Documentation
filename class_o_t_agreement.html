<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Open-Transactions: OTAgreement Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Open-Transactions
   &#160;<span id="projectnumber">master/1066fb4910a63ee3f7de8e0807fee3eb663b66c7</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_o_t_agreement.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">OTAgreement Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="OTAgreement" --><!-- doxytag: inherits="OTCronItem" -->
<p><code>#include &lt;<a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OTAgreement:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_o_t_agreement.png" usemap="#OTAgreement_map" alt=""/>
  <map id="OTAgreement_map" name="OTAgreement_map">
<area href="class_o_t_cron_item.html" alt="OTCronItem" shape="rect" coords="0,224,102,248"/>
<area href="class_o_t_trackable.html" alt="OTTrackable" shape="rect" coords="0,168,102,192"/>
<area href="class_o_t_instrument.html" alt="OTInstrument" shape="rect" coords="0,112,102,136"/>
<area href="class_o_t_scriptable.html" alt="OTScriptable" shape="rect" coords="0,56,102,80"/>
<area href="class_o_t_contract.html" alt="OTContract" shape="rect" coords="0,0,102,24"/>
<area href="class_o_t_payment_plan.html" alt="OTPaymentPlan" shape="rect" coords="0,336,102,360"/>
</map>
 </div></div>

<p><a href="class_o_t_agreement-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_o_t_string.html">OTString</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a242e72e1d0344a0ca85892468ded3dea">GetConsideration</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a483302de5b64e685700bbfea308adc8c">SetMerchantSignedCopy</a> (const <a class="el" href="class_o_t_string.html">OTString</a> &amp;strMerchantCopy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_o_t_string.html">OTString</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#add50cdc545b8aca495467dd099e23027">GetMerchantSignedCopy</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#ac02afd651c21e1df34c97061c30706fe">SetProposal</a> (<a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;MERCHANT_NYM, const <a class="el" href="class_o_t_string.html">OTString</a> &amp;strConsideration, const <a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> VALID_FROM=<a class="el" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>, const <a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> VALID_TO=<a class="el" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#aa58d2054b933bffe9c2b2ca5564b7f49">Confirm</a> (<a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;PAYER_NYM, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *pMERCHANT_NYM=NULL, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> *p_id_MERCHANT_NYM=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a77490299358ae40664773d63306a77f1">VerifyAgreement</a> (<a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;RECIPIENT_NYM, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;SENDER_NYM)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#ad5193325ef6c742f15980fb966a504cf">CompareAgreement</a> (const <a class="el" href="class_o_t_agreement.html">OTAgreement</a> &amp;rhs) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a66300d99a12d32b6825e7e11dfca8614">GetRecipientAcctID</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a06eed084ec0ad88e07df120943b1db0d">SetRecipientAcctID</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;ACCT_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a919c05371fb8f1e0038b2576c5c6fc6b">SetRecipientUserID</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;USER_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#ad3fc1d1fa52b89c95ec16cb69660028f">GetRecipientClosingTransactionNoAt</a> (uint32_t nIndex) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a8e9c210a43af7950d610868900141b35">GetRecipientCountClosingNumbers</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#ad5a72997f44c814fb95a344b1ff140e3">AddRecipientClosingTransactionNo</a> (const int64_t &amp;lClosingTransactionNo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a3602a1424347da4b23e06b65005148f9">GetRecipientOpeningNum</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a5cbac600e627010f50e876e3250530ec">GetRecipientClosingNum</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a0d2171ea6d37b37f284c9f1a9a2b9f13">CanRemoveItemFromCron</a> (<a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theNym)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a181efb58949ade53e690f4ebb0f4cfab">HarvestOpeningNumber</a> (<a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theNym)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a098b7e9e0bd808bd1e40863d5404f243">HarvestClosingNumbers</a> (<a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theNym)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#ac4bda43247e9bac150c197fd5f0db7b2">ProcessCron</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#ad8620736d3cf904a6aef47e48bad0f2c">HasTransactionNum</a> (const int64_t &amp;lInput) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#ae35163519320dde9c7ba32a9ece6537c">GetAllTransactionNumbers</a> (<a class="el" href="class_o_t_num_list.html">OTNumList</a> &amp;numlistOutput) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a55854189c875ce691374dd49f8de0494">VerifyNymAsAgent</a> (<a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theNym, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theSignerNym, <a class="el" href="_o_t_agent_8hpp.html#ac89892658f6bc83e354078647b704e8f">mapOfNyms</a> *pmap_ALREADY_LOADED=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a306ad448347dffd754fa04ca41473f4b">VerifyNymAsAgentForAccount</a> (<a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theNym, <a class="el" href="class_o_t_account.html">OTAccount</a> &amp;theAccount)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a871b6c2a80d4187aac0e4ce520c92bbf">SendNoticeToAllParties</a> (bool bSuccessMsg, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theServerNym, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;theServerID, const int64_t &amp;lNewTransactionNumber, const <a class="el" href="class_o_t_string.html">OTString</a> &amp;strReference, <a class="el" href="class_o_t_string.html">OTString</a> *pstrNote=NULL, <a class="el" href="class_o_t_string.html">OTString</a> *pstrAttachment=NULL, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *pActualNym=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#aa49f4ab64af5e115aa94efb94d5966a9">OTAgreement</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#ad04536b80209232ff1e692c4120cb3bf">OTAgreement</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;ASSET_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#aee09f23b84c919e8c8fe339bf759e27a">OTAgreement</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;ASSET_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SENDER_ACCT_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SENDER_USER_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;RECIPIENT_ACCT_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;RECIPIENT_USER_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a26e417c053bc4a4dacc486bc2fdfe6f2">~OTAgreement</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a74ae81af9bc9492dc9d7b1954f587a45">InitAgreement</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#aad6f21095f2ea95a1ced567ffc17d2eb">Release</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a84907a20bdf4b6690ba654e54ac8e65b">Release_Agreement</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a9519a69017a69b0de357bf8f802ee903">IsValidOpeningNumber</a> (const int64_t &amp;lOpeningNum) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual EXPORT int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a809937fd06b26ff5791094592be68b0d">GetOpeningNumber</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;theNymID) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#ab9ff6bc2d5f152a9e3f2203a067af40b">GetClosingNumber</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;theAcctID) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#aba122af21b536d24bfb178074f843ff5">ProcessXMLNode</a> (<a class="el" href="namespaceirr_1_1io.html#a1628edbb9d5d53f18c82d2a92b0ad27e">irr::io::IrrXMLReader</a> *&amp;xml)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a6b6a960a3cf2ea5dace23b9107b829cf">UpdateContents</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a463dad42bf5d7cc342dd42c5989f6492">SaveContractWallet</a> (std::ofstream &amp;ofs)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#abb0d8deeb8a1c112d313134b21bde8ce">DropServerNoticeToNymbox</a> (bool bSuccessMsg, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theServerNym, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;USER_ID, const int64_t &amp;lNewTransactionNumber, const int64_t &amp;lInReferenceTo, const <a class="el" href="class_o_t_string.html">OTString</a> &amp;strReference, <a class="el" href="class_o_t_string.html">OTString</a> *pstrNote=NULL, <a class="el" href="class_o_t_string.html">OTString</a> *pstrAttachment=NULL, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *pActualNym=NULL)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a2e1d1848b71b3cad25b595190e30be71">onFinalReceipt</a> (<a class="el" href="class_o_t_cron_item.html">OTCronItem</a> &amp;theOrigCronItem, const int64_t &amp;lNewTransactionNumber, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theOriginator, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *pRemover)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a85e6deabc025decf63a7ab0ee372c747">onRemovalFromCron</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_o_t_string.html">OTString</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a2190324be86fd30f04f4ff88d1a14578">m_strConsideration</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_o_t_string.html">OTString</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#a9cf1cc739b7a4aedc56f09b0956f593c">m_strMerchantSignedCopy</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::deque&lt; int64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00162">162</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa49f4ab64af5e115aa94efb94d5966a9"></a><!-- doxytag: member="OTAgreement::OTAgreement" ref="aa49f4ab64af5e115aa94efb94d5966a9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_agreement.html#aa49f4ab64af5e115aa94efb94d5966a9">OTAgreement::OTAgreement</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01338">1338</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                         : ot_super()
{
    <a class="code" href="class_o_t_agreement.html#a74ae81af9bc9492dc9d7b1954f587a45">InitAgreement</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad04536b80209232ff1e692c4120cb3bf"></a><!-- doxytag: member="OTAgreement::OTAgreement" ref="ad04536b80209232ff1e692c4120cb3bf" args="(const OTIdentifier &amp;SERVER_ID, const OTIdentifier &amp;ASSET_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_agreement.html#aa49f4ab64af5e115aa94efb94d5966a9">OTAgreement::OTAgreement</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>ASSET_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01344">1344</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                      :
            ot_super(SERVER_ID, ASSET_ID)
{
    <a class="code" href="class_o_t_agreement.html#a74ae81af9bc9492dc9d7b1954f587a45">InitAgreement</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="aee09f23b84c919e8c8fe339bf759e27a"></a><!-- doxytag: member="OTAgreement::OTAgreement" ref="aee09f23b84c919e8c8fe339bf759e27a" args="(const OTIdentifier &amp;SERVER_ID, const OTIdentifier &amp;ASSET_ID, const OTIdentifier &amp;SENDER_ACCT_ID, const OTIdentifier &amp;SENDER_USER_ID, const OTIdentifier &amp;RECIPIENT_ACCT_ID, const OTIdentifier &amp;RECIPIENT_USER_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_agreement.html#aa49f4ab64af5e115aa94efb94d5966a9">OTAgreement::OTAgreement</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>ASSET_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SENDER_ACCT_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SENDER_USER_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>RECIPIENT_ACCT_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>RECIPIENT_USER_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01351">1351</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                            :
            ot_super(SERVER_ID, ASSET_ID, SENDER_ACCT_ID, SENDER_USER_ID)
{
    <a class="code" href="class_o_t_agreement.html#a74ae81af9bc9492dc9d7b1954f587a45">InitAgreement</a>();
    
    <a class="code" href="class_o_t_agreement.html#a06eed084ec0ad88e07df120943b1db0d">SetRecipientAcctID</a>(RECIPIENT_ACCT_ID);
    <a class="code" href="class_o_t_agreement.html#a919c05371fb8f1e0038b2576c5c6fc6b">SetRecipientUserID</a>(RECIPIENT_USER_ID);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a26e417c053bc4a4dacc486bc2fdfe6f2"></a><!-- doxytag: member="OTAgreement::~OTAgreement" ref="a26e417c053bc4a4dacc486bc2fdfe6f2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_agreement.html#a26e417c053bc4a4dacc486bc2fdfe6f2">OTAgreement::~OTAgreement</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01363">1363</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_agreement.html#a84907a20bdf4b6690ba654e54ac8e65b">Release_Agreement</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ad5a72997f44c814fb95a344b1ff140e3"></a><!-- doxytag: member="OTAgreement::AddRecipientClosingTransactionNo" ref="ad5a72997f44c814fb95a344b1ff140e3" args="(const int64_t &amp;lClosingTransactionNo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#ad5a72997f44c814fb95a344b1ff140e3">OTAgreement::AddRecipientClosingTransactionNo</a> </td>
          <td>(</td>
          <td class="paramtype">const int64_t &amp;&#160;</td>
          <td class="paramname"><em>lClosingTransactionNo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00946">946</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>.push_back(lClosingTransactionNo);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0d2171ea6d37b37f284c9f1a9a2b9f13"></a><!-- doxytag: member="OTAgreement::CanRemoveItemFromCron" ref="a0d2171ea6d37b37f284c9f1a9a2b9f13" args="(OTPseudonym &amp;theNym)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#a0d2171ea6d37b37f284c9f1a9a2b9f13">OTAgreement::CanRemoveItemFromCron</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theNym</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>See if theNym has rights to remove this item from Cron. </p>

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#ae79115b7343f9b2700aa59d2701f2334">OTCronItem</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00982">982</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// You don&#39;t just go willy-nilly and remove a cron item from a market unless you check first</span>
    <span class="comment">// and make sure the Nym who requested it actually has said number (or a related closing number)</span>
    <span class="comment">// signed out to him on his last receipt...</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (<span class="keyword">true</span> == <a class="code" href="class_o_t_cron_item.html#ae79115b7343f9b2700aa59d2701f2334">ot_super::CanRemoveItemFromCron</a>(theNym))
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    
    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strServerID(<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>());

    <span class="comment">// Usually the Nym is the originator. (Meaning GetTransactionNum() on this agreement</span>
    <span class="comment">// is still verifiable as an issued number on theNum, and belongs to him.) In that case,</span>
    <span class="comment">// the above call will discover this, and return true.</span>
    <span class="comment">// In other cases, theNym has the right to Remove the item even though theNym didn&#39;t originate it.</span>
    <span class="comment">// (Like if he is the recipient -- not the sender -- in a payment plan.) We check such things</span>
    <span class="comment">// HERE in this function (see below.)</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (<span class="keyword">false</span> == theNym.<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>()))
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;OTAgreement::%s Weird: Nym tried to remove agreement (payment plan), even &quot;</span>
                      <span class="stringliteral">&quot;though he apparently wasn&#39;t the sender OR recipient.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_o_t_agreement.html#a8e9c210a43af7950d610868900141b35">GetRecipientCountClosingNumbers</a>() &lt; 2)
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;OTAgreement::%s: Weird: Recipient tried to remove agreement &quot;</span>
                       <span class="stringliteral">&quot;(or payment plan); expected 2 closing numbers to be available--that weren&#39;t. (Found %d).\n&quot;</span>,
                       __FUNCTION__, this-&gt;<a class="code" href="class_o_t_agreement.html#a8e9c210a43af7950d610868900141b35">GetRecipientCountClosingNumbers</a>());
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    
    <span class="keywordflow">if</span> (<span class="keyword">false</span> == theNym.<a class="code" href="class_o_t_pseudonym.html#a66cf3b97f1769f9d422bad8787a6c1a0">VerifyIssuedNum</a>(strServerID, this-&gt;GetRecipientClosingNum()))
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;OTAgreement::%s: Recipient Closing number didn&#39;t verify (for removal from cron).\n&quot;</span>,
                       __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    
    <span class="comment">// By this point, we KNOW theNym is the sender, and we KNOW there are the proper number of transaction</span>
    <span class="comment">// numbers available to close. We also know that this cron item really was on the cron object, since</span>
    <span class="comment">// that is where it was looked up from, when this function got called! So I&#39;m pretty sure, at this point,</span>
    <span class="comment">// to authorize removal, as long as the transaction num is still issued to theNym (this check here.)</span>
    <span class="comment">//</span>
    <span class="keywordflow">return</span> theNym.<a class="code" href="class_o_t_pseudonym.html#a66cf3b97f1769f9d422bad8787a6c1a0">VerifyIssuedNum</a>(strServerID, this-&gt;<a class="code" href="class_o_t_agreement.html#a3602a1424347da4b23e06b65005148f9">GetRecipientOpeningNum</a>());
    
    <span class="comment">// Normally this will be all we need to check. The originator will have the transaction</span>
    <span class="comment">// number signed-out to him still, if he is trying to close it. BUT--in some cases, someone</span>
    <span class="comment">// who is NOT the originator can cancel. Like in a payment plan, the sender is also the depositor,</span>
    <span class="comment">// who would normally be the person cancelling the plan. But technically, the RECIPIENT should</span>
    <span class="comment">// also have the ability to cancel that payment plan.  BUT: the transaction number isn&#39;t signed</span>
    <span class="comment">// out to the RECIPIENT... In THAT case, the below VerifyIssuedNum() won&#39;t work! In those cases,</span>
    <span class="comment">// expect that the special code will be in the subclasses override of this function. (OTPaymentPlan::CanRemoveItem() etc)</span>
    
    <span class="comment">// P.S. If you override this function, MAKE SURE to call the parent (OTCronItem::CanRemoveItem) first, </span>
    <span class="comment">// for the VerifyIssuedNum call above. Only if that fails, do you need to dig deeper...</span>

}
</pre></div>
</div>
</div>
<a class="anchor" id="ad5193325ef6c742f15980fb966a504cf"></a><!-- doxytag: member="OTAgreement::CompareAgreement" ref="ad5193325ef6c742f15980fb966a504cf" args="(const OTAgreement &amp;rhs) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#ad5193325ef6c742f15980fb966a504cf">OTAgreement::CompareAgreement</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_agreement.html">OTAgreement</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented in <a class="el" href="class_o_t_payment_plan.html#a68573ce197db1202db869045a332b1e8">OTPaymentPlan</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01043">1043</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// Compare OTAgreement specific info here.</span>
    
    <span class="keywordflow">if</span> ( 
        (   <a class="code" href="class_o_t_agreement.html#a2190324be86fd30f04f4ff88d1a14578">m_strConsideration</a>.<a class="code" href="class_o_t_string.html#a03401b39fb66d63696342c4f61ea8bf5">Compare</a>(rhs.<a class="code" href="class_o_t_agreement.html#a2190324be86fd30f04f4ff88d1a14578">m_strConsideration</a>) ) &amp;&amp;
        (   <a class="code" href="class_o_t_agreement.html#a66300d99a12d32b6825e7e11dfca8614">GetRecipientAcctID</a>() == rhs.<a class="code" href="class_o_t_agreement.html#a66300d99a12d32b6825e7e11dfca8614">GetRecipientAcctID</a>()   ) &amp;&amp;
        (   <a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>() == rhs.<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>()   ) &amp;&amp;
<span class="comment">//        (   m_dequeClosingNumbers == rhs.m_dequeClosingNumbers ) &amp;&amp; // The merchant wouldn&#39;t know the customer&#39;s trans#s.</span>
                                                                      <span class="comment">// (Thus wouldn&#39;t expect them to be set in BOTH versions...)</span>
        (   <a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a> == rhs.<a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>   ) &amp;&amp;
<span class="comment">//      (   GetTransactionNum()  == rhs.GetTransactionNum()   ) &amp;&amp; // (commented out for same reason as above.)</span>
<span class="comment">//      (   GetSenderAcctID()    == rhs.GetSenderAcctID()     ) &amp;&amp; // Same here -- we should let the merchant leave these blank,</span>
<span class="comment">//      (   GetSenderUserID()    == rhs.GetSenderUserID()     ) &amp;&amp; // and then allow the customer to add them in his version, </span>
        (   <a class="code" href="class_o_t_instrument.html#a1f6c7b528680d84dcb998d473bdd99a6">GetAssetID</a>()         == rhs.<a class="code" href="class_o_t_instrument.html#a1f6c7b528680d84dcb998d473bdd99a6">GetAssetID</a>()          ) &amp;&amp; <span class="comment">// (and this Compare function still still verify it.)</span>
        (   <a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>()        == rhs.<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>()         ) &amp;&amp;
        (   <a class="code" href="class_o_t_instrument.html#a08eb5f25566832e1a67b3e33c0dcc13f">GetValidFrom</a>()       == rhs.<a class="code" href="class_o_t_instrument.html#a08eb5f25566832e1a67b3e33c0dcc13f">GetValidFrom</a>()        ) &amp;&amp;
        (   <a class="code" href="class_o_t_instrument.html#ab83a62f51692c946ff394408026b0c18">GetValidTo</a>()         == rhs.<a class="code" href="class_o_t_instrument.html#ab83a62f51692c946ff394408026b0c18">GetValidTo</a>()          )
       )
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa58d2054b933bffe9c2b2ca5564b7f49"></a><!-- doxytag: member="OTAgreement::Confirm" ref="aa58d2054b933bffe9c2b2ca5564b7f49" args="(OTPseudonym &amp;PAYER_NYM, OTPseudonym *pMERCHANT_NYM=NULL, const OTIdentifier *p_id_MERCHANT_NYM=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#aa58d2054b933bffe9c2b2ca5564b7f49">OTAgreement::Confirm</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>PAYER_NYM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *&#160;</td>
          <td class="paramname"><em>pMERCHANT_NYM</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> *&#160;</td>
          <td class="paramname"><em>p_id_MERCHANT_NYM</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01181">1181</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// ----------------------------------------------------------------------------</span>
    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> id_PAYER_NYM;
    PAYER_NYM.<a class="code" href="class_o_t_pseudonym.html#a1775c7aedd0dd25b2faf3f78dcccabe7">GetIdentifier</a>(id_PAYER_NYM);
    
    <span class="keywordflow">if</span> (<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>() == <a class="code" href="class_o_t_trackable.html#aaf5d36407abeeb35eea54f7acb0c3148">GetSenderUserID</a>())
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Error: Sender and recipient have the same Nym ID (not allowed.)\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;        
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((NULL != p_id_MERCHANT_NYM) &amp;&amp; (this-&gt;<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>() != *p_id_MERCHANT_NYM))
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Merchant has wrong NymID (should be same as RecipientUserID.)\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((NULL != pMERCHANT_NYM) &amp;&amp; (this-&gt;<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>() != pMERCHANT_NYM-&gt;<a class="code" href="class_o_t_pseudonym.html#a8167f1e2d532ab18227c5c170922c611">GetConstID</a>()))
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Merchant has wrong NymID (should be same as RecipientUserID.)\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_o_t_trackable.html#aaf5d36407abeeb35eea54f7acb0c3148">GetSenderUserID</a>() != id_PAYER_NYM)
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Payer has wrong NymID (should be same as SenderUserID.)\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;        
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PAYER_NYM.<a class="code" href="class_o_t_pseudonym.html#adee7eef0a51e8e94522c43ac898c2308">GetTransactionNumCount</a>(<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>()) &lt; 2) <span class="comment">// Need opening and closing numbers (that&#39;s 2)... </span>
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failure. You need at least 2 transaction numbers available to do this.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_o_t_agreement.html#a8e9c210a43af7950d610868900141b35">GetRecipientCountClosingNumbers</a>() &lt; 2)
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failure. (The merchant was supposed to attach 2 transaction numbers.)\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// ----------------------------------------------------------------------------</span>
    <span class="comment">// This is the single reason why MERCHANT_NYM was even passed in here!</span>
    <span class="comment">// Supposedly merchant has already signed.  Let&#39;s verify this!!</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> ((NULL != pMERCHANT_NYM) &amp;&amp; (<span class="keyword">false</span> == this-&gt;<a class="code" href="class_o_t_contract.html#a38f51d593b6dfc8a75d1c5a535965392">VerifySignature</a>(*pMERCHANT_NYM)))
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Merchant&#39;s signature failed to verify.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// ----------------------------------------------------------------------------</span>
    
    <span class="comment">// Now that we KNOW the merchant signed it... SAVE MERCHANT&#39;s COPY.</span>
    <span class="comment">// Let&#39;s save a copy of the one the merchant signed, before changing it and re-signing it,</span>
    <span class="comment">// (to add my own transaction numbers...)</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
    this-&gt;<a class="code" href="class_o_t_contract.html#a5fd00cded794a6f96ba80d8d4081d591">SaveContractRaw</a>(strTemp);
    this-&gt;<a class="code" href="class_o_t_agreement.html#a483302de5b64e685700bbfea308adc8c">SetMerchantSignedCopy</a>(strTemp);

    <span class="comment">// *******************************************************************</span>
    
    <span class="comment">// The payer has to submit TWO transaction numbers in order to activate this agreement...</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strServerID(<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>());
    int64_t lTransactionNumber=0, lClosingTransactionNo=0;
    
    <span class="keywordflow">if</span> (<span class="keyword">false</span> == PAYER_NYM.<a class="code" href="class_o_t_pseudonym.html#a82c5ec5457947738c807bffd581181ac">GetNextTransactionNum</a>(PAYER_NYM, strServerID, lTransactionNumber))
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Strangely unable to get a transaction number.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">false</span> == PAYER_NYM.<a class="code" href="class_o_t_pseudonym.html#a82c5ec5457947738c807bffd581181ac">GetNextTransactionNum</a>(PAYER_NYM, strServerID, lClosingTransactionNo))
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Strangely unable to get a closing transaction number.\n&quot;</span>, __FUNCTION__);
        PAYER_NYM.<a class="code" href="class_o_t_pseudonym.html#a2771ea8cf77d2ac05d942e149c2bc3e6">AddTransactionNum</a>(PAYER_NYM, strServerID, lTransactionNumber, <span class="keyword">true</span>); <span class="comment">// bSave=true</span>
        <span class="comment">// (Since the first one was successful, we just put it back before returning.)</span>
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    
    <span class="comment">// At this point we now HAVE 2 transaction numbers (for payer / sender)...</span>
    <span class="comment">// We can&#39;t return without USING THEM or PUTTING THEM BACK.</span>
    <span class="comment">//</span>
    <span class="comment">// ---------------------------------------------------------</span>
    this-&gt;<a class="code" href="class_o_t_trackable.html#a6ef06e21f2ad3616ab6b3a303662846d">SetTransactionNum</a>(lTransactionNumber); <span class="comment">// Set the Transaction Number</span>
    this-&gt;<a class="code" href="class_o_t_cron_item.html#a310153e4e82ec7fbc887e93c4d12220d">AddClosingTransactionNo</a>(lClosingTransactionNo); <span class="comment">// and the Closing Number (both for sender)...</span>
    <span class="comment">// ------------------------------------------- </span>
    <span class="comment">// CREATION DATE was set in the Merchant&#39;s proposal, and it&#39;s RESET here in the Confirm.</span>
    <span class="comment">// This way, (since we still have the original proposal) we can see BOTH times.</span>
    <span class="comment">//</span>
    <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> CURRENT_TIME = <a class="code" href="_o_t_common_8hpp.html#a1163606b2546b160d50c5f0a5afe479a">OTTimeGetCurrentTime</a>();
    <span class="comment">// Set the Creation Date.</span>
    <a class="code" href="class_o_t_cron_item.html#a7668dc44368861c09a47de0f420cf2fa">SetCreationDate</a>(CURRENT_TIME);
    <span class="comment">// -------------------------------------------</span>
    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(4, <span class="stringliteral">&quot;%s(): Success!\n&quot;</span>, __FUNCTION__);
    
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="abb0d8deeb8a1c112d313134b21bde8ce"></a><!-- doxytag: member="OTAgreement::DropServerNoticeToNymbox" ref="abb0d8deeb8a1c112d313134b21bde8ce" args="(bool bSuccessMsg, OTPseudonym &amp;theServerNym, const OTIdentifier &amp;SERVER_ID, const OTIdentifier &amp;USER_ID, const int64_t &amp;lNewTransactionNumber, const int64_t &amp;lInReferenceTo, const OTString &amp;strReference, OTString *pstrNote=NULL, OTString *pstrAttachment=NULL, OTPseudonym *pActualNym=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#abb0d8deeb8a1c112d313134b21bde8ce">OTAgreement::DropServerNoticeToNymbox</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bSuccessMsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theServerNym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>USER_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t &amp;&#160;</td>
          <td class="paramname"><em>lNewTransactionNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t &amp;&#160;</td>
          <td class="paramname"><em>lInReferenceTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_string.html">OTString</a> &amp;&#160;</td>
          <td class="paramname"><em>strReference</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_string.html">OTString</a> *&#160;</td>
          <td class="paramname"><em>pstrNote</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_string.html">OTString</a> *&#160;</td>
          <td class="paramname"><em>pstrAttachment</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *&#160;</td>
          <td class="paramname"><em>pActualNym</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00275">275</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_ledger.html">OTLedger</a> theLedger(USER_ID, USER_ID, SERVER_ID);
    
    <span class="comment">// Inbox will receive notification of something ALREADY DONE.</span>
    <span class="comment">//</span>
    <span class="keywordtype">bool</span> bSuccessLoading = theLedger.LoadNymbox();
    <span class="comment">// -------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (<span class="keyword">true</span> == bSuccessLoading)
        bSuccessLoading     = theLedger.VerifyAccount(theServerNym);
    <span class="keywordflow">else</span>
        bSuccessLoading     = theLedger.GenerateLedger(USER_ID, SERVER_ID, <a class="code" href="class_o_t_ledger.html#ac03f2514d0c6ae00147c5d53bf19591aae7427339a1b7566f46fb6d60c66bbfae">OTLedger::nymbox</a>, <span class="keyword">true</span>); <span class="comment">// bGenerateFile=true</span>
    <span class="comment">// --------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (<span class="keyword">false</span> == bSuccessLoading)
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed loading or generating a nymbox. (FAILED WRITING RECEIPT!!) \n&quot;</span>,
                      __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// --------------------------------------------------------------------</span>
    <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * pTransaction = <a class="code" href="class_o_t_transaction.html#a5bfc7ce34aa67cf9dad96e661e118020">OTTransaction::GenerateTransaction</a>(theLedger,
                                                                      <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8a34ed13120f604fbf41954473bfd896da">OTTransaction::notice</a>,
                                                                      lNewTransactionNumber);
    
    <span class="keywordflow">if</span> (NULL != pTransaction) <span class="comment">// The above has an OT_ASSERT within, but I just like to check my pointers.</span>
    {
        <span class="comment">// The nymbox will get a receipt with the new transaction ID.</span>
        <span class="comment">// That receipt has an &quot;in reference to&quot; field containing the original OTScriptable</span>
        
        <span class="comment">// Set up the transaction items (each transaction may have multiple items... but not in this case.)</span>
        <span class="comment">//</span>
        <a class="code" href="class_o_t_item.html">OTItem</a> * pItem1 = <a class="code" href="class_o_t_item.html#a2376ee56b6c536a63a59e2bfebada0b3">OTItem::CreateItemFromTransaction</a>(*pTransaction, <a class="code" href="class_o_t_item.html#a03db091faaab100aadc455f4ebe2c5d1a72e8b39a09399b486754d11771f5dc56">OTItem::notice</a>);
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pItem1); <span class="comment">// This may be unnecessary, I&#39;ll have to check CreateItemFromTransaction. I&#39;ll leave it for now.</span>
        <span class="comment">// -------------------------------------------------------------</span>
        pItem1-&gt;<a class="code" href="class_o_t_item.html#a789aa4148a0add3092e16c4221bf5844">SetStatus</a>(bSuccessMsg ? <a class="code" href="class_o_t_item.html#a61e86f5b6c64a518664123907235f376aa099f14a8a9ef5987b1161b764895cdf">OTItem::acknowledgement</a> : <a class="code" href="class_o_t_item.html#a61e86f5b6c64a518664123907235f376adbeae2ab1504a5ef318da097d21119db">OTItem::rejection</a>); <span class="comment">// ACKNOWLEDGMENT or REJECTION ?</span>
        <span class="comment">// -------------------------------------------------------------</span>
        <span class="comment">//</span>
        <span class="comment">// Here I make sure that the receipt (the nymbox notice) references the</span>
        <span class="comment">// transaction number that the trader originally used to issue the cron item...</span>
        <span class="comment">// This number is used to match up offers to trades, and used to track all cron items.</span>
        <span class="comment">// (All Cron items require a transaction from the user to add them to Cron in the</span>
        <span class="comment">// first place.)</span>
        <span class="comment">//</span>
        pTransaction-&gt;<a class="code" href="class_o_t_transaction_type.html#ab0f87cd43699c20eddd70b5970c092d1">SetReferenceToNum</a>(lInReferenceTo);
        <span class="comment">// -------------------------------------------------</span>
        <span class="comment">// The reference on the transaction probably contains a the original cron item or entity contract.</span>
        <span class="comment">// Versus the updated item (which, if it exists, is stored on the pItem1 just below.)</span>
        <span class="comment">//</span>
        pTransaction-&gt;<a class="code" href="class_o_t_transaction_type.html#a9dd50265579347d2e8fa3ea36ca66320">SetReferenceString</a>(strReference);
        <span class="comment">// --------------------------------------------</span>
        <span class="comment">// The notice ITEM&#39;s NOTE probably contains the UPDATED SCRIPTABLE</span>
        <span class="comment">// (usually a CRON ITEM. But maybe soon: Entity.)</span>
        <span class="keywordflow">if</span> (NULL != pstrNote)
        {
            pItem1-&gt;<a class="code" href="class_o_t_item.html#ac0a3c73f3c09f2fdbd83a381898360df">SetNote</a>(*pstrNote);    <span class="comment">// in markets, this is updated trade.</span>
        }
        <span class="comment">// -----------------------------------------------------------------</span>
        <span class="comment">// Nothing is special stored here so far for OTTransaction::notice, but the option is always there.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (NULL != pstrAttachment)
        {
            pItem1-&gt;<a class="code" href="class_o_t_item.html#a6e5e9b0c04cb1eca8acaec5b0be1d641">SetAttachment</a>(*pstrAttachment);
        }
        <span class="comment">// -----------------------------------------------------------------</span>
        <span class="comment">// sign the item</span>
        <span class="comment">//</span>
        pItem1-&gt;<a class="code" href="class_o_t_contract.html#abd60037fe655ee8cae9a3ece5d1e2ea6">SignContract</a>(theServerNym);
        pItem1-&gt;<a class="code" href="class_o_t_contract.html#a363ae430d4fd9256ab8364dbafb95444">SaveContract</a>();
        
        <span class="comment">// the Transaction &quot;owns&quot; the item now and will handle cleaning it up.</span>
        pTransaction-&gt;<a class="code" href="class_o_t_transaction.html#a5abc071b7eeddc40ea151cccd011e4d6">AddItem</a>(*pItem1);
        
        pTransaction-&gt;<a class="code" href="class_o_t_contract.html#abd60037fe655ee8cae9a3ece5d1e2ea6">SignContract</a>(theServerNym);
        pTransaction-&gt;<a class="code" href="class_o_t_contract.html#a363ae430d4fd9256ab8364dbafb95444">SaveContract</a>();
        
        <span class="comment">// Here the transaction we just created is actually added to the ledger.</span>
        theLedger.AddTransaction(*pTransaction);
        
        <span class="comment">// Release any signatures that were there before (They won&#39;t</span>
        <span class="comment">// verify anymore anyway, since the content has changed.)</span>
        theLedger.ReleaseSignatures();
        
        <span class="comment">// Sign and save.</span>
        theLedger.SignContract(theServerNym);
        theLedger.SaveContract();
        
        <span class="comment">// TODO: Better rollback capabilities in case of failures here:</span>
        <span class="comment">// --------------------</span>
        <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theNymboxHash;
        
        <span class="comment">// Save nymbox to storage. (File, DB, wherever it goes.)</span>
        theLedger.  SaveNymbox(&amp;theNymboxHash);
        
        <span class="comment">// Corresponds to the AddTransaction() call just above. These</span>
        <span class="comment">// are stored in a separate file now.</span>
        <span class="comment">//</span>
        pTransaction-&gt;<a class="code" href="class_o_t_transaction.html#a2f991feb7c6178ffabefc7fef312d26e">SaveBoxReceipt</a>(theLedger);
        <span class="comment">// --------------------------------------------------------</span>
        <span class="comment">// Update the NymboxHash (in the nymfile.)</span>
        <span class="comment">//</span>
        <span class="keyword">const</span>
        <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>    ACTUAL_NYM_ID = USER_ID;
        <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a>     theActualNym; <span class="comment">// unused unless it&#39;s really not already loaded. (use pActualNym.)</span>
        
        <span class="comment">// We couldn&#39;t find the Nym among those already loaded--so we have to load</span>
        <span class="comment">// it ourselves (so we can update its NymboxHash value.)</span>
        
        <span class="keywordflow">if</span> (NULL == pActualNym)
        {
            <span class="keywordflow">if</span> ( theServerNym.<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(ACTUAL_NYM_ID) )
                pActualNym = &amp;theServerNym;
            <span class="comment">// --------------------------</span>
            <span class="keywordflow">else</span>
            {
                theActualNym.<a class="code" href="class_o_t_pseudonym.html#a4b5f98378bb2ff1c48c5410f7283aff6">SetIdentifier</a>(ACTUAL_NYM_ID);
                
                <span class="keywordflow">if</span> (<span class="keyword">false</span> == theActualNym.<a class="code" href="class_o_t_pseudonym.html#aeb1c675ec72d6450e5c151d1f3eb95bf">LoadPublicKey</a>()) <span class="comment">// Note: this step may be unnecessary since we are only updating his Nymfile, not his key.</span>
                {
                    <a class="code" href="class_o_t_string.html">OTString</a> strNymID(ACTUAL_NYM_ID);
                    <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure loading public key for Nym: %s. &quot;</span>
                                  <span class="stringliteral">&quot;(To update his NymboxHash.) \n&quot;</span>, __FUNCTION__, strNymID.Get());
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theActualNym.<a class="code" href="class_o_t_pseudonym.html#aae8a707c7799efb6944d485be31a7c3e">VerifyPseudonym</a>() &amp;&amp; <span class="comment">// this line may be unnecessary.</span>
                         theActualNym.<a class="code" href="class_o_t_pseudonym.html#ad24db39caa89399f659f414b19903f90">LoadSignedNymfile</a>(theServerNym)) <span class="comment">// ServerNym here is not theActualNym&#39;s identity, but merely the signer on this file.</span>
                {
                    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(3, <span class="stringliteral">&quot;%s: Loading actual Nym, since he wasn&#39;t already loaded. &quot;</span>
                                   <span class="stringliteral">&quot;(To update his NymboxHash.)\n&quot;</span>, __FUNCTION__);
                    pActualNym = &amp;theActualNym; <span class="comment">//  &lt;=====</span>
                }
                <span class="keywordflow">else</span>
                {
                    <a class="code" href="class_o_t_string.html">OTString</a> strNymID(ACTUAL_NYM_ID);
                    <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure loading or verifying Actual Nym public key: %s. &quot;</span>
                                  <span class="stringliteral">&quot;(To update his NymboxHash.)\n&quot;</span>, __FUNCTION__, strNymID.Get());
                }
            }
        }
        <span class="comment">// -------------</span>
        <span class="comment">// By this point we&#39;ve made every possible effort to get the proper Nym loaded,</span>
        <span class="comment">// so that we can update his NymboxHash appropriately.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (NULL != pActualNym)
        {
            pActualNym-&gt;<a class="code" href="class_o_t_pseudonym.html#ab3b725b4837a88a8d273d5ca1ad636a0">SetNymboxHashServerSide</a>( theNymboxHash );
            pActualNym-&gt;<a class="code" href="class_o_t_pseudonym.html#a5d08ef86097db038c2c4fd30034f5dc8">SaveSignedNymfile</a>(theServerNym);
        }
        <span class="comment">// -------------</span>
        <span class="comment">// Really this true should be predicated on ALL the above functions returning true.</span>
        <span class="comment">// Right?</span>
        <span class="comment">//</span>
        <span class="keywordflow">return</span> <span class="keyword">true</span>;    <span class="comment">// Really this true should be predicated on ALL the above functions returning true. Right?</span>
    }
    <span class="keywordflow">else</span>
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%x: Failed trying to create Nymbox.\n&quot;</span>, __FUNCTION__);
    
    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// unreachable.</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae35163519320dde9c7ba32a9ece6537c"></a><!-- doxytag: member="OTAgreement::GetAllTransactionNumbers" ref="ae35163519320dde9c7ba32a9ece6537c" args="(OTNumList &amp;numlistOutput) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#ae35163519320dde9c7ba32a9ece6537c">OTAgreement::GetAllTransactionNumbers</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_num_list.html">OTNumList</a> &amp;&#160;</td>
          <td class="paramname"><em>numlistOutput</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_trackable.html#a665238c671ce6b084538141550f9a67d">OTTrackable</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00469">469</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// --------------------------------------------------</span>
    <span class="keywordflow">if</span> (<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>() &gt; 0)
        numlistOutput.Add(<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>());
    <span class="comment">// --------------------------------------------------</span>
    <span class="keyword">const</span> <span class="keywordtype">size_t</span> nSizeClosing = <a class="code" href="class_o_t_cron_item.html#a16711e4ee405a3a27375c633a33edc60">m_dequeClosingNumbers</a>.size();
    
    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> nIndex = 0; nIndex &lt; nSizeClosing; ++nIndex)
    {
        <span class="keyword">const</span> int64_t lTemp = <a class="code" href="class_o_t_cron_item.html#a16711e4ee405a3a27375c633a33edc60">m_dequeClosingNumbers</a>.at(nIndex);
        <span class="keywordflow">if</span> (lTemp &gt; 0)
            numlistOutput.Add(lTemp);
    }
    <span class="comment">// --------------------------------------------------</span>
    <span class="keyword">const</span> <span class="keywordtype">size_t</span> nSizeRecipient = <a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>.size();
    
    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> nIndex = 0; nIndex &lt; nSizeRecipient; ++nIndex)
    {
        <span class="keyword">const</span> int64_t lTemp = <a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>.at(nIndex);
        <span class="keywordflow">if</span> (lTemp &gt; 0)
            numlistOutput.Add(lTemp);
    }
    <span class="comment">// --------------------------------------------------</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab9ff6bc2d5f152a9e3f2203a067af40b"></a><!-- doxytag: member="OTAgreement::GetClosingNumber" ref="ab9ff6bc2d5f152a9e3f2203a067af40b" args="(const OTIdentifier &amp;theAcctID) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t <a class="el" href="class_o_t_agreement.html#ab9ff6bc2d5f152a9e3f2203a067af40b">OTAgreement::GetClosingNumber</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>theAcctID</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#acb5f09af7950df9591c267031745a3e7">OTCronItem</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00902">902</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theRecipientAcctID = this-&gt;<a class="code" href="class_o_t_agreement.html#a66300d99a12d32b6825e7e11dfca8614">GetRecipientAcctID</a>();
    
    <span class="keywordflow">if</span> (theAcctID == theRecipientAcctID)
        <span class="keywordflow">return</span> <a class="code" href="class_o_t_agreement.html#a5cbac600e627010f50e876e3250530ec">GetRecipientClosingNum</a>();
    <span class="comment">// else...</span>
    <span class="keywordflow">return</span> <a class="code" href="class_o_t_cron_item.html#acb5f09af7950df9591c267031745a3e7">ot_super::GetClosingNumber</a>(theAcctID);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a242e72e1d0344a0ca85892468ded3dea"></a><!-- doxytag: member="OTAgreement::GetConsideration" ref="a242e72e1d0344a0ca85892468ded3dea" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_o_t_string.html">OTString</a>&amp; <a class="el" href="class_o_t_agreement.html#a242e72e1d0344a0ca85892468ded3dea">OTAgreement::GetConsideration</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00188">188</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_agreement.html#a2190324be86fd30f04f4ff88d1a14578">m_strConsideration</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="add50cdc545b8aca495467dd099e23027"></a><!-- doxytag: member="OTAgreement::GetMerchantSignedCopy" ref="add50cdc545b8aca495467dd099e23027" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_o_t_string.html">OTString</a>&amp; <a class="el" href="class_o_t_agreement.html#add50cdc545b8aca495467dd099e23027">OTAgreement::GetMerchantSignedCopy</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00191">191</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="class_o_t_agreement.html#a9cf1cc739b7a4aedc56f09b0956f593c">m_strMerchantSignedCopy</a>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a809937fd06b26ff5791094592be68b0d"></a><!-- doxytag: member="OTAgreement::GetOpeningNumber" ref="a809937fd06b26ff5791094592be68b0d" args="(const OTIdentifier &amp;theNymID) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t <a class="el" href="class_o_t_agreement.html#a809937fd06b26ff5791094592be68b0d">OTAgreement::GetOpeningNumber</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>theNymID</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#a8f59139b6000733ec3c1df6d1dbc7632">OTCronItem</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00891">891</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theRecipientNymID = this-&gt;<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>();
    
    <span class="keywordflow">if</span> (theNymID == theRecipientNymID)
        <span class="keywordflow">return</span> <a class="code" href="class_o_t_agreement.html#a3602a1424347da4b23e06b65005148f9">GetRecipientOpeningNum</a>();
    <span class="comment">// else...</span>
    <span class="keywordflow">return</span> <a class="code" href="class_o_t_cron_item.html#a8f59139b6000733ec3c1df6d1dbc7632">ot_super::GetOpeningNumber</a>(theNymID);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a66300d99a12d32b6825e7e11dfca8614"></a><!-- doxytag: member="OTAgreement::GetRecipientAcctID" ref="a66300d99a12d32b6825e7e11dfca8614" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a>&amp; <a class="el" href="class_o_t_agreement.html#a66300d99a12d32b6825e7e11dfca8614">OTAgreement::GetRecipientAcctID</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00293">293</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> m_RECIPIENT_ACCT_ID; }
</pre></div>
</div>
</div>
<a class="anchor" id="a5cbac600e627010f50e876e3250530ec"></a><!-- doxytag: member="OTAgreement::GetRecipientClosingNum" ref="a5cbac600e627010f50e876e3250530ec" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t <a class="el" href="class_o_t_agreement.html#a5cbac600e627010f50e876e3250530ec">OTAgreement::GetRecipientClosingNum</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00919">919</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> (<a class="code" href="class_o_t_agreement.html#a8e9c210a43af7950d610868900141b35">GetRecipientCountClosingNumbers</a>() &gt; 1) ? <a class="code" href="class_o_t_agreement.html#ad3fc1d1fa52b89c95ec16cb69660028f">GetRecipientClosingTransactionNoAt</a>(1) : 0; <span class="comment">// todo stop hardcoding.</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad3fc1d1fa52b89c95ec16cb69660028f"></a><!-- doxytag: member="OTAgreement::GetRecipientClosingTransactionNoAt" ref="ad3fc1d1fa52b89c95ec16cb69660028f" args="(uint32_t nIndex) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t <a class="el" href="class_o_t_agreement.html#ad3fc1d1fa52b89c95ec16cb69660028f">OTAgreement::GetRecipientClosingTransactionNoAt</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nIndex</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00931">931</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_o_t_assert_8hpp.html#a033b133f48e61f2b227c52ad2be0c882">OT_ASSERT_MSG</a>((nIndex &lt; <a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>.size()) &amp;&amp; (nIndex &gt;= 0),
                  <span class="stringliteral">&quot;OTAgreement::GetClosingTransactionNoAt: index out of bounds.&quot;</span>);
    
    <span class="keywordflow">return</span> <a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>.at(nIndex);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8e9c210a43af7950d610868900141b35"></a><!-- doxytag: member="OTAgreement::GetRecipientCountClosingNumbers" ref="a8e9c210a43af7950d610868900141b35" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t <a class="el" href="class_o_t_agreement.html#a8e9c210a43af7950d610868900141b35">OTAgreement::GetRecipientCountClosingNumbers</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00940">940</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> (<a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>.size());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3602a1424347da4b23e06b65005148f9"></a><!-- doxytag: member="OTAgreement::GetRecipientOpeningNum" ref="a3602a1424347da4b23e06b65005148f9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t <a class="el" href="class_o_t_agreement.html#a3602a1424347da4b23e06b65005148f9">OTAgreement::GetRecipientOpeningNum</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00913">913</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> (<a class="code" href="class_o_t_agreement.html#a8e9c210a43af7950d610868900141b35">GetRecipientCountClosingNumbers</a>() &gt; 0) ? <a class="code" href="class_o_t_agreement.html#ad3fc1d1fa52b89c95ec16cb69660028f">GetRecipientClosingTransactionNoAt</a>(0) : 0; <span class="comment">// todo stop hardcoding.</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a87e9b6e7028af7ddfebaee86925e8e7b"></a><!-- doxytag: member="OTAgreement::GetRecipientUserID" ref="a87e9b6e7028af7ddfebaee86925e8e7b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a>&amp; <a class="el" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">OTAgreement::GetRecipientUserID</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00294">294</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> m_RECIPIENT_USER_ID; }
</pre></div>
</div>
</div>
<a class="anchor" id="a098b7e9e0bd808bd1e40863d5404f243"></a><!-- doxytag: member="OTAgreement::HarvestClosingNumbers" ref="a098b7e9e0bd808bd1e40863d5404f243" args="(OTPseudonym &amp;theNym)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a098b7e9e0bd808bd1e40863d5404f243">OTAgreement::HarvestClosingNumbers</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theNym</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#aeeaf2e2f8c54e7eb3e072336d07b2879">OTCronItem</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00853">853</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// Since we overrode the parent, we give it a chance to harvest also.</span>
    <span class="comment">// If theNym is the sender, then his closing numbers will be harvested</span>
    <span class="comment">// inside here. But what if the transaction was a success? The numbers</span>
    <span class="comment">// will still be harvested, since they are still on the sender&#39;s issued</span>
    <span class="comment">// list, but they should not have been harvested, regardless, since the</span>
    <span class="comment">// transaction was a success and the server therefore has them marked as</span>
    <span class="comment">// &quot;used.&quot; So clearly you cannot just blindly call this function unless</span>
    <span class="comment">// you know beforehand whether the message and transaction were a success.</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_cron_item.html#aeeaf2e2f8c54e7eb3e072336d07b2879">ot_super::HarvestClosingNumbers</a>(theNym);

    <span class="comment">// The Nym is the original recipient. (If Compares true).</span>
    <span class="comment">// FYI, if Nym is the original sender, then the above call will handle him.</span>
    <span class="comment">//</span>
    <span class="comment">// GetTransactionNum() is burned, but we can harvest the closing</span>
    <span class="comment">// numbers from the &quot;Closing&quot; list, which is only for the sender&#39;s numbers.</span>
    <span class="comment">// Subclasses will have to override this function for recipients, etc.</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (theNym.<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>()))
    {
<span class="comment">//      OTLog::vOutput(0, &quot;%s: Harvesting RECIPIENT...\n&quot;, __FUNCTION__);</span>
        
        <span class="comment">// This function will only &quot;add it back&quot; if it was really there in the first place.</span>
        <span class="comment">// (Verifies it is on issued list first, before adding to available list.)</span>
        <span class="comment">//</span>
        <span class="keyword">const</span> <span class="keywordtype">bool</span> bClawedBack =
            theNym.<a class="code" href="class_o_t_pseudonym.html#a29c787987f96abc9de8f3b268596a79e">ClawbackTransactionNumber</a>(<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>(), <a class="code" href="class_o_t_agreement.html#a5cbac600e627010f50e876e3250530ec">GetRecipientClosingNum</a>(), <span class="keyword">true</span>); <span class="comment">//bSave=true</span>

        <span class="keywordflow">if</span> (!bClawedBack)
        {
<span class="comment">//          OTLog::vError(&quot;OTAgreement::HarvestClosingNumbers: Number (%lld) failed as issued. (Thus didn&#39;t bother &#39;adding it back&#39;.)\n&quot;, GetRecipientClosingTransactionNoAt(i));</span>
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a181efb58949ade53e690f4ebb0f4cfab"></a><!-- doxytag: member="OTAgreement::HarvestOpeningNumber" ref="a181efb58949ade53e690f4ebb0f4cfab" args="(OTPseudonym &amp;theNym)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a181efb58949ade53e690f4ebb0f4cfab">OTAgreement::HarvestOpeningNumber</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theNym</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#ab4adba19339e539c05bba94717c481cc">OTCronItem</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00814">814</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// since we overrode the parent, we give it a chance to harvest also.</span>
    <span class="comment">// IF theNym is the original sender, the opening number will be harvested</span>
    <span class="comment">// inside this call.</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_cron_item.html#ab4adba19339e539c05bba94717c481cc">ot_super::HarvestOpeningNumber</a>(theNym);

    <span class="comment">// The Nym is the original recipient. (If Compares true).</span>
    <span class="comment">// IN CASES where GetTransactionNum() isn&#39;t already burned, we can harvest it here.</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (theNym.<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>()))
    {
        <span class="comment">// This function will only &quot;add it back&quot; if it was really there in the first place.</span>
        <span class="comment">// (Verifies it is on issued list first, before adding to available list.)</span>
        <span class="comment">//</span>
        <span class="keyword">const</span> <span class="keywordtype">bool</span> bClawedBack =
            theNym.<a class="code" href="class_o_t_pseudonym.html#a29c787987f96abc9de8f3b268596a79e">ClawbackTransactionNumber</a>(<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>(), <a class="code" href="class_o_t_agreement.html#a3602a1424347da4b23e06b65005148f9">GetRecipientOpeningNum</a>(), <span class="keyword">true</span>); <span class="comment">//bSave=true</span>
        
        <span class="keywordflow">if</span> (!bClawedBack)
        {
<span class="comment">//          OTLog::vError(&quot;OTAgreement::HarvestOpeningNumber: Number (%lld) failed as issued. (Thus didn&#39;t bother &#39;adding it back&#39;.)\n&quot;, GetRecipientOpeningNum());</span>
        }
    }
    
    <span class="comment">// NOTE: if the message failed (transaction never actually ran) then the sender AND recipient</span>
    <span class="comment">// can both reclaim their opening numbers. But if the message SUCCEEDED and the transaction FAILED,</span>
    <span class="comment">// then only the recipient can claim his opening number -- the sender&#39;s is already burned. So then,</span>
    <span class="comment">// what if you mistakenly call this function and pass the sender, when that number is already burned?</span>
    <span class="comment">// There&#39;s nothing this function can do, because we have no way of telling, from inside here,</span>
    <span class="comment">// whether the message succeeded or not, and whether the transaction succeeded or not. Therefore,</span>
    <span class="comment">// ==&gt; we MUST rely on the CALLER to know this, and to avoid calling this function in the first place, </span>
    <span class="comment">// if he&#39;s sitting on a sender with a failed transaction.</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad8620736d3cf904a6aef47e48bad0f2c"></a><!-- doxytag: member="OTAgreement::HasTransactionNum" ref="ad8620736d3cf904a6aef47e48bad0f2c" args="(const int64_t &amp;lInput) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#ad8620736d3cf904a6aef47e48bad0f2c">OTAgreement::HasTransactionNum</a> </td>
          <td>(</td>
          <td class="paramtype">const int64_t &amp;&#160;</td>
          <td class="paramname"><em>lInput</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_trackable.html#a7f0e0f97f77da9cf7f49c0ce1be1b6db">OTTrackable</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00444">444</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (lInput == <a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>())
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    <span class="comment">// --------------------------------------------------</span>
    <span class="keyword">const</span> <span class="keywordtype">size_t</span> nSizeClosing = <a class="code" href="class_o_t_cron_item.html#a16711e4ee405a3a27375c633a33edc60">m_dequeClosingNumbers</a>.size();
    
    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> nIndex = 0; nIndex &lt; nSizeClosing; ++nIndex)
    {
        <span class="keywordflow">if</span> (lInput == <a class="code" href="class_o_t_cron_item.html#a16711e4ee405a3a27375c633a33edc60">m_dequeClosingNumbers</a>.at(nIndex))
            <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
    <span class="comment">// --------------------------------------------------</span>
    <span class="keyword">const</span> <span class="keywordtype">size_t</span> nSizeRecipient = <a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>.size();
    
    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> nIndex = 0; nIndex &lt; nSizeRecipient; ++nIndex)
    {
        <span class="keywordflow">if</span> (lInput == <a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>.at(nIndex))
            <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
    <span class="comment">// --------------------------------------------------    </span>
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a74ae81af9bc9492dc9d7b1954f587a45"></a><!-- doxytag: member="OTAgreement::InitAgreement" ref="a74ae81af9bc9492dc9d7b1954f587a45" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a74ae81af9bc9492dc9d7b1954f587a45">OTAgreement::InitAgreement</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01369">1369</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_contract.html#ac523dac7d72b72e54b1ebb5b3a3b21cc">m_strContractType</a> = <span class="stringliteral">&quot;AGREEMENT&quot;</span>;
    
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9519a69017a69b0de357bf8f802ee903"></a><!-- doxytag: member="OTAgreement::IsValidOpeningNumber" ref="a9519a69017a69b0de357bf8f802ee903" args="(const int64_t &amp;lOpeningNum) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#a9519a69017a69b0de357bf8f802ee903">OTAgreement::IsValidOpeningNumber</a> </td>
          <td>(</td>
          <td class="paramtype">const int64_t &amp;&#160;</td>
          <td class="paramname"><em>lOpeningNum</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#a9fd34100c4c79adf325c61ba268008ef">OTCronItem</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00791">791</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="class_o_t_agreement.html#a3602a1424347da4b23e06b65005148f9">GetRecipientOpeningNum</a>() == lOpeningNum)
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    
    <span class="keywordflow">return</span> <a class="code" href="class_o_t_cron_item.html#a9fd34100c4c79adf325c61ba268008ef">ot_super::IsValidOpeningNumber</a>(lOpeningNum);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2e1d1848b71b3cad25b595190e30be71"></a><!-- doxytag: member="OTAgreement::onFinalReceipt" ref="a2e1d1848b71b3cad25b595190e30be71" args="(OTCronItem &amp;theOrigCronItem, const int64_t &amp;lNewTransactionNumber, OTPseudonym &amp;theOriginator, OTPseudonym *pRemover)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a2e1d1848b71b3cad25b595190e30be71">OTAgreement::onFinalReceipt</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_cron_item.html">OTCronItem</a> &amp;&#160;</td>
          <td class="paramname"><em>theOrigCronItem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t &amp;&#160;</td>
          <td class="paramname"><em>lNewTransactionNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theOriginator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *&#160;</td>
          <td class="paramname"><em>pRemover</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#ac24d58b1aec6a6471a79f30146e7a300">OTCronItem</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00519">519</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{    
    <span class="comment">// -------------------------------------------------</span>
    <a class="code" href="class_o_t_cron.html">OTCron</a> * pCron  = <a class="code" href="class_o_t_cron_item.html#af734ad5d309fcc9b4a60d40d6c30f55a">GetCron</a>();
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pCron);
    
    <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> * pServerNym = pCron-&gt;<a class="code" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a>();
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pServerNym);
    <span class="comment">// -------------------------------------------------</span>
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFunc = <span class="stringliteral">&quot;OTAgreement::onFinalReceipt&quot;</span>;
    <span class="comment">// -------------------------------------------------</span>
    <span class="comment">// The finalReceipt Item&#39;s ATTACHMENT contains the UPDATED Cron Item.</span>
    <span class="comment">// (With the SERVER&#39;s signature on it!)</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strUpdatedCronItem(*<span class="keyword">this</span>);
    <a class="code" href="class_o_t_string.html">OTString</a> * pstrAttachment=&amp;strUpdatedCronItem;
    
    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strOrigCronItem(theOrigCronItem);
    <span class="comment">// -----------------------------------------------------------------</span>
    <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> theRecipientNym; <span class="comment">// Don&#39;t use this... use the pointer just below.</span>
    
    <span class="comment">// The Nym who is actively requesting to remove a cron item will be passed in as pRemover.</span>
    <span class="comment">// However, sometimes there is no Nym... perhaps it just expired and pRemover is NULL.</span>
    <span class="comment">// The originating Nym (if different than remover) is loaded up. Otherwise the originator</span>
    <span class="comment">// pointer just pointers to *pRemover.</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> * pRecipient = NULL;
    
    <span class="keywordflow">if</span> (pServerNym-&gt;<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(this-&gt;GetRecipientUserID()))
    {
        pRecipient = pServerNym; <span class="comment">// Just in case the recipient Nym is also the server Nym.</span>
    }
    <span class="comment">// *******************************************************</span>
    <span class="comment">//</span>
    <span class="comment">// If pRemover is NOT NULL, and he has the Recipient&#39;s ID...</span>
    <span class="comment">// then set the pointer accordingly.</span>
    <span class="comment">//</span>
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((NULL != pRemover) &amp;&amp; (<span class="keyword">true</span> == pRemover-&gt;<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(this-&gt;<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>())))
    {
        pRecipient = pRemover; <span class="comment">// &lt;======== now both pointers are set (to same Nym). DONE!</span>
    }
    <span class="comment">// --------------------------------------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (NULL == pRecipient)
    {
        <span class="comment">// GetSenderUserID() should be the same on THIS (updated version of the same cron item) </span>
        <span class="comment">// but for whatever reason, I&#39;m checking the userID on the original version. Sue me.</span>
        <span class="comment">//</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> NYM_ID(this-&gt;<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>());
        
        theRecipientNym.<a class="code" href="class_o_t_pseudonym.html#a4b5f98378bb2ff1c48c5410f7283aff6">SetIdentifier</a>(NYM_ID);  
        
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == theRecipientNym.<a class="code" href="class_o_t_pseudonym.html#aeb1c675ec72d6450e5c151d1f3eb95bf">LoadPublicKey</a>())
        {
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strNymID(NYM_ID);
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure loading Recipient&#39;s public key:\n%s\n&quot;</span>, 
                          szFunc, strNymID.Get());
        }       
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theRecipientNym.<a class="code" href="class_o_t_pseudonym.html#aae8a707c7799efb6944d485be31a7c3e">VerifyPseudonym</a>() &amp;&amp; 
                 theRecipientNym.<a class="code" href="class_o_t_pseudonym.html#ad24db39caa89399f659f414b19903f90">LoadSignedNymfile</a>(*pServerNym)) <span class="comment">// ServerNym here is merely the signer on this file.</span>
        {
            pRecipient = &amp;theRecipientNym; <span class="comment">//  &lt;=====</span>
        }
        <span class="keywordflow">else</span> 
        {
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strNymID(NYM_ID);
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure verifying Recipient&#39;s public key or loading signed nymfile: %s\n&quot;</span>,
                          szFunc, strNymID.Get());
        }
    }
    <span class="comment">// -------------------------------</span>
    <span class="comment">// First, we are closing the transaction number ITSELF, of this cron item,</span>
    <span class="comment">// as an active issued number on the originating nym. (Changing it to CLOSED.)</span>
    <span class="comment">//</span>
    <span class="comment">// Second, we&#39;re verifying the CLOSING number, and using it as the closing number</span>
    <span class="comment">// on the FINAL RECEIPT (with that receipt being &quot;InReferenceTo&quot; this-&gt;GetTransactionNum())</span>
    <span class="comment">//</span>
    <span class="keyword">const</span> int64_t lRecipientOpeningNumber = this-&gt;<a class="code" href="class_o_t_agreement.html#a3602a1424347da4b23e06b65005148f9">GetRecipientOpeningNum</a>();
    <span class="keyword">const</span> int64_t lRecipientClosingNumber = this-&gt;<a class="code" href="class_o_t_agreement.html#a5cbac600e627010f50e876e3250530ec">GetRecipientClosingNum</a>();
    <span class="comment">// -----------------------------------------------------------------------------------</span>
    <span class="keyword">const</span> int64_t lSenderOpeningNumber = theOrigCronItem.<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>();

    <span class="keyword">const</span> int64_t lSenderClosingNumber = (theOrigCronItem.<a class="code" href="class_o_t_cron_item.html#a96d3ae7898526a317dd503daecbf10af">GetCountClosingNumbers</a>() &gt; 0) ? 
        theOrigCronItem.<a class="code" href="class_o_t_cron_item.html#ab4bd4e606ddbb49d3f36248f18391ec1">GetClosingTransactionNoAt</a>(0) : 0; <span class="comment">// index 0 is closing number for sender, since GetTransactionNum() is his opening #.</span>
    <span class="comment">// ----------------------------------</span>
    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strServerID(<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>());
    <span class="comment">// -----------------------------------------------------------------</span>
    <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> *   pActualNym    = NULL; <span class="comment">// use this. DON&#39;T use theActualNym.</span>
    <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a>     theActualNym;         <span class="comment">// unused unless it&#39;s really not already loaded. (use pActualNym.)</span>
    <span class="comment">// -----------------------------------------------------------------</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> ((lSenderOpeningNumber &gt; 0) &amp;&amp;
        theOriginator.<a class="code" href="class_o_t_pseudonym.html#a66cf3b97f1769f9d422bad8787a6c1a0">VerifyIssuedNum</a>(strServerID, lSenderOpeningNumber))
    {
        <span class="comment">// The Nym (server side) stores a list of all opening and closing cron #s.</span>
        <span class="comment">// So when the number is released from the Nym, we also take it off that list.</span>
        <span class="comment">//</span>
        std::set&lt;int64_t&gt; &amp; theIDSet = theOriginator.<a class="code" href="class_o_t_pseudonym.html#a92abc7a6b6253681f3379f135597f5a9">GetSetOpenCronItems</a>();
        theIDSet.erase(lSenderOpeningNumber);
        
        <span class="comment">// the RemoveIssued call means the original transaction# (to find this cron item on cron) is now CLOSED.</span>
        <span class="comment">// But the Transaction itself is still OPEN. How? Because the CLOSING number is still signed out.</span>
        <span class="comment">// The closing number is also USED, since the NotarizePaymentPlan or NotarizeMarketOffer call, but it</span>
        <span class="comment">// remains ISSUED, until the final receipt itself is accepted during a process inbox.</span>
        <span class="comment">//</span>
        theOriginator.<a class="code" href="class_o_t_pseudonym.html#a17f25f5eb52440cc3ffc139dcbff75fe">RemoveIssuedNum</a>(*pServerNym, strServerID, lSenderOpeningNumber, <span class="keyword">false</span>); <span class="comment">//bSave=false</span>
        theOriginator.<a class="code" href="class_o_t_pseudonym.html#a5d08ef86097db038c2c4fd30034f5dc8">SaveSignedNymfile</a>(*pServerNym);
        <span class="comment">// ------------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> ACTUAL_NYM_ID = <a class="code" href="class_o_t_trackable.html#aaf5d36407abeeb35eea54f7acb0c3148">GetSenderUserID</a>();
        
        <span class="keywordflow">if</span> ( (NULL != pServerNym) &amp;&amp; pServerNym-&gt;<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(ACTUAL_NYM_ID) )
            pActualNym = pServerNym;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theOriginator.<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(ACTUAL_NYM_ID))
            pActualNym = &amp;theOriginator;
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (NULL != pRemover) &amp;&amp; pRemover-&gt;<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(ACTUAL_NYM_ID) )
            pActualNym = pRemover;
        <span class="comment">// --------------------------</span>
        <span class="keywordflow">else</span>    <span class="comment">// We couldn&#39;t find the Nym among those already loaded--so we have to load</span>
        {       <span class="comment">// it ourselves (so we can update its NymboxHash value.)</span>
            theActualNym.<a class="code" href="class_o_t_pseudonym.html#a4b5f98378bb2ff1c48c5410f7283aff6">SetIdentifier</a>(ACTUAL_NYM_ID);
            
            <span class="keywordflow">if</span> (<span class="keyword">false</span> == theActualNym.<a class="code" href="class_o_t_pseudonym.html#aeb1c675ec72d6450e5c151d1f3eb95bf">LoadPublicKey</a>()) <span class="comment">// Note: this step may be unnecessary since we are only updating his Nymfile, not his key.</span>
            {
                <a class="code" href="class_o_t_string.html">OTString</a> strNymID(ACTUAL_NYM_ID);
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure loading public key for Nym: %s. &quot;</span>
                              <span class="stringliteral">&quot;(To update his NymboxHash.) \n&quot;</span>, szFunc, strNymID.Get());
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theActualNym.<a class="code" href="class_o_t_pseudonym.html#aae8a707c7799efb6944d485be31a7c3e">VerifyPseudonym</a>() &amp;&amp; <span class="comment">// this line may be unnecessary.</span>
                     theActualNym.<a class="code" href="class_o_t_pseudonym.html#ad24db39caa89399f659f414b19903f90">LoadSignedNymfile</a>(*pServerNym)) <span class="comment">// ServerNym here is not theActualNym&#39;s identity, but merely the signer on this file.</span>
            {
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(3, <span class="stringliteral">&quot;%s: Loading actual Nym, since he wasn&#39;t already loaded. &quot;</span>
                              <span class="stringliteral">&quot;(To update his NymboxHash.)\n&quot;</span>, szFunc);
                pActualNym = &amp;theActualNym; <span class="comment">//  &lt;=====</span>
            }
            <span class="keywordflow">else</span>
            {
                <a class="code" href="class_o_t_string.html">OTString</a> strNymID(ACTUAL_NYM_ID);
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure loading or verifying Actual Nym public key: %s. &quot;</span>
                              <span class="stringliteral">&quot;(To update his NymboxHash.)\n&quot;</span>, szFunc, strNymID.Get());
            }
        }
        <span class="comment">// -------------</span>
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == this-&gt;<a class="code" href="class_o_t_cron_item.html#a4ed44ef1289676261061180691359bad">DropFinalReceiptToNymbox</a>(<a class="code" href="class_o_t_trackable.html#aaf5d36407abeeb35eea54f7acb0c3148">GetSenderUserID</a>(),
                                                    lNewTransactionNumber,
                                                    strOrigCronItem,
                                                    NULL,
                                                    pstrAttachment,
                                                    pActualNym))
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure dropping sender final receipt into nymbox.\n&quot;</span>, szFunc);
        }        
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure verifying sender&#39;s opening number.\n&quot;</span>, szFunc);
    }
    
    <span class="comment">// -----------------------------------------------------------------</span>
    
    <span class="keywordflow">if</span> ((lSenderClosingNumber &gt; 0) &amp;&amp;
        theOriginator.<a class="code" href="class_o_t_pseudonym.html#a66cf3b97f1769f9d422bad8787a6c1a0">VerifyIssuedNum</a>(strServerID, lSenderClosingNumber)         
        ) <span class="comment">// ---------------------------------------------------------------</span>
    {        
        <span class="comment">// In this case, I&#39;m passing NULL for pstrNote, since there is no note.</span>
        <span class="comment">// (Additional information would normally be stored in the note.) </span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == this-&gt;<a class="code" href="class_o_t_cron_item.html#a32b2f6d524b7a0b9cacff58845b2161c">DropFinalReceiptToInbox</a>(<a class="code" href="class_o_t_trackable.html#aaf5d36407abeeb35eea54f7acb0c3148">GetSenderUserID</a>(),
                                                   <a class="code" href="class_o_t_trackable.html#a3149b0da54958e8da4cf15d26f47711f">GetSenderAcctID</a>(),
                                                   lNewTransactionNumber,
                                                   lSenderClosingNumber, <span class="comment">// The closing transaction number to put on the receipt.</span>
                                                   strOrigCronItem,
                                                   NULL, 
                                                   pstrAttachment)) <span class="comment">// pActualAcct=NULL by default. (This call will load it up and update its inbox hash.)</span>
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure dropping receipt into sender&#39;s inbox.\n&quot;</span>, szFunc);

        <span class="comment">// This part below doesn&#39;t happen until theOriginator ACCEPTS the final receipt (when processing his inbox.)</span>
        <span class="comment">//</span>
<span class="comment">//      theOriginator.RemoveIssuedNum(strServerID, lSenderClosingNumber, true); //bSave=false</span>
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed verifying lSenderClosingNumber=theOrigCronItem.GetClosingTransactionNoAt(0)&gt;0 &amp;&amp;  &quot;</span>
                      <span class="stringliteral">&quot;theOriginator.VerifyTransactionNum(lSenderClosingNumber)\n&quot;</span>, szFunc);
    }
    <span class="comment">// -----------------------------------------------------------------</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> ((NULL != pRecipient) &amp;&amp; (lRecipientOpeningNumber &gt; 0) &amp;&amp; 
        pRecipient-&gt;<a class="code" href="class_o_t_pseudonym.html#a66cf3b97f1769f9d422bad8787a6c1a0">VerifyIssuedNum</a>(strServerID, lRecipientOpeningNumber)
        )
    {
        <span class="comment">// The Nym (server side) stores a list of all opening and closing cron #s.</span>
        <span class="comment">// So when the number is released from the Nym, we also take it off that list.</span>
        <span class="comment">//</span>
        std::set&lt;int64_t&gt; &amp; theIDSet = pRecipient-&gt;<a class="code" href="class_o_t_pseudonym.html#a92abc7a6b6253681f3379f135597f5a9">GetSetOpenCronItems</a>();
        theIDSet.erase(lRecipientOpeningNumber);
        
        <span class="comment">// the RemoveIssued call means the original transaction# (to find this cron item on cron) is now CLOSED.</span>
        <span class="comment">// But the Transaction itself is still OPEN. How? Because the CLOSING number is still signed out.</span>
        <span class="comment">// The closing number is also USED, since the NotarizePaymentPlan or NotarizeMarketOffer call, but it</span>
        <span class="comment">// remains ISSUED, until the final receipt itself is accepted during a process inbox.</span>
        <span class="comment">//</span>
        pRecipient-&gt;<a class="code" href="class_o_t_pseudonym.html#a17f25f5eb52440cc3ffc139dcbff75fe">RemoveIssuedNum</a>(*pServerNym, strServerID, lRecipientOpeningNumber, <span class="keyword">false</span>); <span class="comment">//bSave=false       </span>
<span class="comment">//      pRecipient-&gt;SaveSignedNymfile(*pServerNym); // Moved lower.</span>
        <span class="comment">// -----------------------------------------------------</span>
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == this-&gt;<a class="code" href="class_o_t_cron_item.html#a4ed44ef1289676261061180691359bad">DropFinalReceiptToNymbox</a>(<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>(),
                                                    lNewTransactionNumber,
                                                    strOrigCronItem,
                                                    NULL,
                                                    pstrAttachment,
                                                    pRecipient)) <span class="comment">// NymboxHash is updated here in pRecipient.</span>
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure dropping recipient final receipt into nymbox.\n&quot;</span>, szFunc);
        }
        <span class="comment">// -----------------------------------------------------</span>

        <span class="comment">// Saving both the Removed Issued Number, as well as the new NymboxHash.</span>
        <span class="comment">// NOTE: Todo: if the NymboxHash WAS updated (as it should have been) then</span>
        <span class="comment">// it was probably saved at that time. Below is therefore a redundant save.</span>
        <span class="comment">// Need to fix by making certain objects savable and dirty, and then let them</span>
        <span class="comment">// autosave before destruction, IF they are dirty.</span>
        <span class="comment">//</span>
        pRecipient-&gt;<a class="code" href="class_o_t_pseudonym.html#a5d08ef86097db038c2c4fd30034f5dc8">SaveSignedNymfile</a>(*pServerNym); 
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed verifying &quot;</span>
                      <span class="stringliteral">&quot;lRecipientClosingNumber=this-&gt;GetRecipientClosingTransactionNoAt(1)&gt;0 &amp;&amp;  &quot;</span>
                      <span class="stringliteral">&quot;pRecipient-&gt;VerifyTransactionNum(lRecipientClosingNumber) &amp;&amp; VerifyIssuedNum(lRecipientOpeningNumber)\n&quot;</span>,
                      szFunc);
    }
    <span class="comment">// -----------------------------------------------------------------</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> ((NULL != pRecipient) &amp;&amp; (lRecipientClosingNumber &gt; 0) &amp;&amp; 
        pRecipient-&gt;<a class="code" href="class_o_t_pseudonym.html#a66cf3b97f1769f9d422bad8787a6c1a0">VerifyIssuedNum</a>(strServerID, lRecipientClosingNumber)
        )
    {
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == this-&gt;<a class="code" href="class_o_t_cron_item.html#a32b2f6d524b7a0b9cacff58845b2161c">DropFinalReceiptToInbox</a>(<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>(),
                                                   <a class="code" href="class_o_t_agreement.html#a66300d99a12d32b6825e7e11dfca8614">GetRecipientAcctID</a>(),
                                                   lNewTransactionNumber,
                                                   lRecipientClosingNumber, <span class="comment">// The closing transaction number to put on the receipt.</span>
                                                   strOrigCronItem,
                                                   NULL,
                                                   pstrAttachment))
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure dropping receipt into recipient&#39;s inbox.\n&quot;</span>, szFunc);

        <span class="comment">// This part below doesn&#39;t happen until pRecipient ACCEPTs the final receipt (when processing his inbox.)</span>
        <span class="comment">//</span>
<span class="comment">//      pRecipient-&gt;RemoveIssuedNum(strServerID, lRecipientClosingNumber, true); //bSave=false</span>
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed verifying &quot;</span>
                      <span class="stringliteral">&quot;lRecipientClosingNumber=this-&gt;GetRecipientClosingTransactionNoAt(1)&gt;0 &amp;&amp;  &quot;</span>
                      <span class="stringliteral">&quot;pRecipient-&gt;VerifyTransactionNum(lRecipientClosingNumber) &amp;&amp; VerifyIssuedNum(lRecipientOpeningNumber)\n&quot;</span>,
                      szFunc);
    }
    
    <span class="comment">// QUESTION: Won&#39;t there be Cron Items that have no asset account at all?</span>
    <span class="comment">// In which case, there&#39;d be no need to drop a final receipt, but I don&#39;t think</span>
    <span class="comment">// that&#39;s the case, since you have to use a transaction number to get onto cron</span>
    <span class="comment">// in the first place.</span>
    <span class="comment">// -----------------------------------------------------------------</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a85e6deabc025decf63a7ab0ee372c747"></a><!-- doxytag: member="OTAgreement::onRemovalFromCron" ref="a85e6deabc025decf63a7ab0ee372c747" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a85e6deabc025decf63a7ab0ee372c747">OTAgreement::onRemovalFromCron</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#ad7aa9b289746ab01661997a19b1335b1">OTCronItem</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00800">800</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// Not much needed here.</span>
    <span class="comment">// Actually: Todo:  (unless it goes in payment plan code) need to set receipts</span>
    <span class="comment">// in inboxes, and close out the closing transaction numbers.</span>
    <span class="comment">//</span>
    
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac4bda43247e9bac150c197fd5f0db7b2"></a><!-- doxytag: member="OTAgreement::ProcessCron" ref="ac4bda43247e9bac150c197fd5f0db7b2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#ac4bda43247e9bac150c197fd5f0db7b2">OTAgreement::ProcessCron</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#afe5c6a9af86b637fd8b2b3459825565b">OTCronItem</a>.</p>

<p>Reimplemented in <a class="el" href="class_o_t_payment_plan.html#aaec9c2740849989bfbf4f312a0ab201d">OTPaymentPlan</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00954">954</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// END DATE --------------------------------</span>
    <span class="comment">// First call the parent&#39;s version (which this overrides) so it has</span>
    <span class="comment">// a chance to check its stuff. Currently it checks IsExpired().</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_cron_item.html#afe5c6a9af86b637fd8b2b3459825565b">ot_super::ProcessCron</a>())
        <span class="keywordflow">return</span> <span class="keyword">false</span>;   <span class="comment">// It&#39;s expired or flagged--removed it from Cron.</span>
    
    
    <span class="comment">// START DATE --------------------------------</span>
    <span class="comment">// Okay, so it&#39;s NOT expired. But might not have reached START DATE yet...</span>
    <span class="comment">// (If not expired, yet current date is not verified, that means it hasn&#39;t</span>
    <span class="comment">// ENTERED the date range YET.)</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_instrument.html#a8a90b4e37984058d8e6fb836311c5dd9">VerifyCurrentDate</a>())
        <span class="keywordflow">return</span> <span class="keyword">true</span>;    <span class="comment">// The Trade is not yet valid, so we return. BUT, we return </span>
                        <span class="comment">//  true, so it will stay on Cron until it BECOMES valid.</span>
    
    
    <span class="comment">// Process my Agreement-specific stuff below.--------------------------------</span>
    
    
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aba122af21b536d24bfb178074f843ff5"></a><!-- doxytag: member="OTAgreement::ProcessXMLNode" ref="aba122af21b536d24bfb178074f843ff5" args="(irr::io::IrrXMLReader *&amp;xml)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t <a class="el" href="class_o_t_agreement.html#aba122af21b536d24bfb178074f843ff5">OTAgreement::ProcessXMLNode</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceirr_1_1io.html#a1628edbb9d5d53f18c82d2a92b0ad27e">irr::io::IrrXMLReader</a> *&amp;&#160;</td>
          <td class="paramname"><em>xml</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#a6b7eec23353a8ed49ee40a742c391aa3">OTCronItem</a>.</p>

<p>Reimplemented in <a class="el" href="class_o_t_payment_plan.html#af1c7a24817b3367f2c76c9867effd557">OTPaymentPlan</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01414">1414</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    int32_t nReturnVal = 0;
    
    <span class="comment">// Here we call the parent class first.</span>
    <span class="comment">// If the node is found there, or there is some error,</span>
    <span class="comment">// then we just return either way.  But if it comes back</span>
    <span class="comment">// as &#39;0&#39;, then nothing happened, and we&#39;ll continue executing.</span>
    <span class="comment">//</span>
    <span class="comment">// -- Note you can choose not to call the parent if</span>
    <span class="comment">// you don&#39;t want to use any of those xml tags.</span>
    <span class="comment">// As I do below, in the case of OTAccount.</span>
    <span class="keywordflow">if</span> (0 != (nReturnVal = <a class="code" href="class_o_t_cron_item.html#a6b7eec23353a8ed49ee40a742c391aa3">ot_super::ProcessXMLNode</a>(xml)))
        <span class="keywordflow">return</span> nReturnVal;

    <span class="comment">// -------------------------------------------------</span>
    
    <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;agreement&quot;</span>, xml-&gt;getNodeName())) 
    {       
        <a class="code" href="class_o_t_contract.html#aa0d889e0e1670b56fedca245041a5ed3">m_strVersion</a>           = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;version&quot;</span>);
        <a class="code" href="class_o_t_trackable.html#a6ef06e21f2ad3616ab6b3a303662846d">SetTransactionNum</a>(  atol(xml-&gt;getAttributeValue(<span class="stringliteral">&quot;transactionNum&quot;</span>)) );
        <span class="comment">// -------------------------------------------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strCreation = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;creationDate&quot;</span>);
        int64_t tCreation = strCreation.<a class="code" href="class_o_t_string.html#a18ca8f42f6e90ab7801c019611d9dca8">ToLong</a>();
        
        <a class="code" href="class_o_t_cron_item.html#a7668dc44368861c09a47de0f420cf2fa">SetCreationDate</a>(<a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(tCreation));
        <span class="comment">// -------------------------------------------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> str_valid_from = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;validFrom&quot;</span>);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> str_valid_to   = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;validTo&quot;</span>);
        
        int64_t tValidFrom = str_valid_from.<a class="code" href="class_o_t_string.html#a18ca8f42f6e90ab7801c019611d9dca8">ToLong</a>();
        int64_t tValidTo   = str_valid_to.<a class="code" href="class_o_t_string.html#a18ca8f42f6e90ab7801c019611d9dca8">ToLong</a>();
        
        <a class="code" href="class_o_t_instrument.html#af8e356f6956ad222a1766435edca8374">SetValidFrom</a>(<a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(tValidFrom));
        <a class="code" href="class_o_t_instrument.html#a5baef9beffaf6627cd9d5277fdbb14c3">SetValidTo</a>(<a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(tValidTo));
        <span class="comment">// ---------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>  strServerID       (xml-&gt;getAttributeValue(<span class="stringliteral">&quot;serverID&quot;</span>)),
                        strAssetTypeID    (xml-&gt;getAttributeValue(<span class="stringliteral">&quot;assetTypeID&quot;</span>)),
                        strSenderAcctID   (xml-&gt;getAttributeValue(<span class="stringliteral">&quot;senderAcctID&quot;</span>)),
                        strSenderUserID   (xml-&gt;getAttributeValue(<span class="stringliteral">&quot;senderUserID&quot;</span>)),
                        strRecipientAcctID(xml-&gt;getAttributeValue(<span class="stringliteral">&quot;recipientAcctID&quot;</span>)),
                        strRecipientUserID(xml-&gt;getAttributeValue(<span class="stringliteral">&quot;recipientUserID&quot;</span>)),
                        strCanceled       (xml-&gt;getAttributeValue(<span class="stringliteral">&quot;canceled&quot;</span>)),
                        strCancelerUserID (xml-&gt;getAttributeValue(<span class="stringliteral">&quot;cancelerUserID&quot;</span>));
        <span class="comment">// ----------------------</span>
        <span class="keywordflow">if</span> (strCanceled.Exists() &amp;&amp; strCanceled.Compare(<span class="stringliteral">&quot;true&quot;</span>))
        {
            <a class="code" href="class_o_t_cron_item.html#abe9ce5c7b4d2fe652908e1f81f2f3b67">m_bCanceled</a> = <span class="keyword">true</span>;
            
            <span class="keywordflow">if</span> (strCancelerUserID.Exists())
                <a class="code" href="class_o_t_cron_item.html#af7bb48c16e16f664b938a7f235d2872d">m_pCancelerNymID</a>-&gt;<a class="code" href="class_o_t_identifier.html#ae29aa1245d3831a207aabc9b8a493bfc">SetString</a>(strCancelerUserID);
            <span class="comment">// else log</span>
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="class_o_t_cron_item.html#abe9ce5c7b4d2fe652908e1f81f2f3b67">m_bCanceled</a> = <span class="keyword">false</span>;
            <a class="code" href="class_o_t_cron_item.html#af7bb48c16e16f664b938a7f235d2872d">m_pCancelerNymID</a>-&gt;<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>();
        }
        <span class="comment">// ----------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>  SERVER_ID(strServerID),                 ASSET_ID(strAssetTypeID),
                            SENDER_ACCT_ID(strSenderAcctID),        SENDER_USER_ID(strSenderUserID),
                            RECIPIENT_ACCT_ID(strRecipientAcctID),  RECIPIENT_USER_ID(strRecipientUserID);
        
        <a class="code" href="class_o_t_instrument.html#a80fc5560fdedf911ec0c184ab9fbb5b7">SetServerID</a>(SERVER_ID);
        <a class="code" href="class_o_t_instrument.html#a155933617602731fc5d1ff459961dc24">SetAssetID</a>(ASSET_ID);
        <a class="code" href="class_o_t_trackable.html#a75814babcec8eb5cfed15047d4dfb4f6">SetSenderAcctID</a>(SENDER_ACCT_ID);
        <a class="code" href="class_o_t_trackable.html#a689cca3d471d7e85bec084d302f3cd83">SetSenderUserID</a>(SENDER_USER_ID);
        <a class="code" href="class_o_t_agreement.html#a06eed084ec0ad88e07df120943b1db0d">SetRecipientAcctID</a>(RECIPIENT_ACCT_ID);
        <a class="code" href="class_o_t_agreement.html#a919c05371fb8f1e0038b2576c5c6fc6b">SetRecipientUserID</a>(RECIPIENT_USER_ID);
        <span class="comment">// ---------------------</span>
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;\n\n%sgreement. Transaction Number: %lld\n&quot;</span>,
                       <a class="code" href="class_o_t_cron_item.html#abe9ce5c7b4d2fe652908e1f81f2f3b67">m_bCanceled</a> ? <span class="stringliteral">&quot;Canceled a&quot;</span> : <span class="stringliteral">&quot;A&quot;</span>, <a class="code" href="class_o_t_trackable.html#a90bc18f9b5d6b3c8059a83685b86674e">m_lTransactionNum</a>);
        
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(2,
                       <span class="stringliteral">&quot; Creation Date: %&quot;</span> PRId64<span class="stringliteral">&quot;   Valid From: %&quot;</span> PRId64<span class="stringliteral">&quot;\n Valid To: %&quot;</span> PRId64<span class="stringliteral">&quot;\n&quot;</span>
                       <span class="stringliteral">&quot; AssetTypeID: %s\n ServerID: %s\n&quot;</span>
                       <span class="stringliteral">&quot; senderAcctID: %s\n senderUserID: %s\n &quot;</span>
                       <span class="stringliteral">&quot; recipientAcctID: %s\n recipientUserID: %s\n &quot;</span>, 
                       tCreation, tValidFrom, tValidTo,
                       strAssetTypeID.Get(), strServerID.Get(),
                       strSenderAcctID.Get(), strSenderUserID.Get(), 
                       strRecipientAcctID.Get(), strRecipientUserID.Get());
        
        nReturnVal = 1;
    }
    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;consideration&quot;</span>, xml-&gt;getNodeName())) 
    {       
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == <a class="code" href="class_o_t_contract.html#a72ffe11fdcf2f6e3566afa9061241f30">OTContract::LoadEncodedTextField</a>(xml, <a class="code" href="class_o_t_agreement.html#a2190324be86fd30f04f4ff88d1a14578">m_strConsideration</a>))
        {
            <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Error in OTPaymentPlan::ProcessXMLNode: consideration field without value.\n&quot;</span>);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        
        nReturnVal = 1;
    }
    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;merchantSignedCopy&quot;</span>, xml-&gt;getNodeName())) 
    {       
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == <a class="code" href="class_o_t_contract.html#a72ffe11fdcf2f6e3566afa9061241f30">OTContract::LoadEncodedTextField</a>(xml, <a class="code" href="class_o_t_agreement.html#a9cf1cc739b7a4aedc56f09b0956f593c">m_strMerchantSignedCopy</a>))
        {
            <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Error in OTPaymentPlan::ProcessXMLNode: merchant_signed_copy field without value.\n&quot;</span>);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        
        nReturnVal = 1;
    }

    <span class="comment">// -------------------------------------------</span>
<span class="comment">//  std::deque&lt;int64_t&gt;   m_dequeRecipientClosingNumbers; // Numbers used for CLOSING a transaction. (finalReceipt.)</span>

    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;closingRecipientNumber&quot;</span>, xml-&gt;getNodeName())) 
    {       
        <a class="code" href="class_o_t_string.html">OTString</a> strClosingNumber = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;value&quot;</span>);
        
        <span class="keywordflow">if</span> (strClosingNumber.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
        {
            <span class="keyword">const</span> int64_t lClosingNumber = atol(strClosingNumber.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());                    

            this-&gt;<a class="code" href="class_o_t_agreement.html#ad5a72997f44c814fb95a344b1ff140e3">AddRecipientClosingTransactionNo</a>(lClosingNumber);
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Error in OTAgreement::ProcessXMLNode: closingRecipientNumber field without value.\n&quot;</span>);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        
        nReturnVal = 1;
    }

    <span class="keywordflow">return</span> nReturnVal;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aad6f21095f2ea95a1ced567ffc17d2eb"></a><!-- doxytag: member="OTAgreement::Release" ref="aad6f21095f2ea95a1ced567ffc17d2eb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#aad6f21095f2ea95a1ced567ffc17d2eb">OTAgreement::Release</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_cron_item.html#a11e9851acefc9162bb5f107a1952ffb7">OTCronItem</a>.</p>

<p>Reimplemented in <a class="el" href="class_o_t_payment_plan.html#a231d9ec26ad3f267bf68cbc5f51c62ac">OTPaymentPlan</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01392">1392</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_agreement.html#a84907a20bdf4b6690ba654e54ac8e65b">Release_Agreement</a>();
    
    <span class="comment">// -----------------------</span>
    
    <a class="code" href="class_o_t_cron_item.html#a11e9851acefc9162bb5f107a1952ffb7">ot_super::Release</a>(); <span class="comment">// since I&#39;ve overridden the base class (OTCronItem), so I call it now...</span>
    
    <span class="comment">// -----------------------</span>

    <span class="comment">// Then I call this to re-initialize everything</span>
    <a class="code" href="class_o_t_agreement.html#a74ae81af9bc9492dc9d7b1954f587a45">InitAgreement</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a84907a20bdf4b6690ba654e54ac8e65b"></a><!-- doxytag: member="OTAgreement::Release_Agreement" ref="a84907a20bdf4b6690ba654e54ac8e65b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a84907a20bdf4b6690ba654e54ac8e65b">OTAgreement::Release_Agreement</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01376">1376</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// If there were any dynamically allocated objects, clean them up here.</span>
    <span class="comment">//</span>
    m_RECIPIENT_ACCT_ID.<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>();  
    m_RECIPIENT_USER_ID.<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>();
    
    <a class="code" href="class_o_t_agreement.html#a2190324be86fd30f04f4ff88d1a14578">m_strConsideration</a>.<a class="code" href="class_o_t_string.html#abef4b21b2170468705c58d64212d7257">Release</a>();
    <a class="code" href="class_o_t_agreement.html#a9cf1cc739b7a4aedc56f09b0956f593c">m_strMerchantSignedCopy</a>.<a class="code" href="class_o_t_string.html#abef4b21b2170468705c58d64212d7257">Release</a>();
    
    <a class="code" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">m_dequeRecipientClosingNumbers</a>.clear();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a463dad42bf5d7cc342dd42c5989f6492"></a><!-- doxytag: member="OTAgreement::SaveContractWallet" ref="a463dad42bf5d7cc342dd42c5989f6492" args="(std::ofstream &amp;ofs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#a463dad42bf5d7cc342dd42c5989f6492">OTAgreement::SaveContractWallet</a> </td>
          <td>(</td>
          <td class="paramtype">std::ofstream &amp;&#160;</td>
          <td class="paramname"><em>ofs</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_trackable.html#a85b7622124dd3d103cb50498cddac2b2">OTTrackable</a>.</p>

<p>Reimplemented in <a class="el" href="class_o_t_payment_plan.html#ac05bb3d3f77b90edfa3259c182c57f2b">OTPaymentPlan</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01548">1548</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a871b6c2a80d4187aac0e4ce520c92bbf"></a><!-- doxytag: member="OTAgreement::SendNoticeToAllParties" ref="a871b6c2a80d4187aac0e4ce520c92bbf" args="(bool bSuccessMsg, OTPseudonym &amp;theServerNym, const OTIdentifier &amp;theServerID, const int64_t &amp;lNewTransactionNumber, const OTString &amp;strReference, OTString *pstrNote=NULL, OTString *pstrAttachment=NULL, OTPseudonym *pActualNym=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#a871b6c2a80d4187aac0e4ce520c92bbf">OTAgreement::SendNoticeToAllParties</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bSuccessMsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theServerNym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>theServerID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t &amp;&#160;</td>
          <td class="paramname"><em>lNewTransactionNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_string.html">OTString</a> &amp;&#160;</td>
          <td class="paramname"><em>strReference</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_string.html">OTString</a> *&#160;</td>
          <td class="paramname"><em>pstrNote</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_string.html">OTString</a> *&#160;</td>
          <td class="paramname"><em>pstrAttachment</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *&#160;</td>
          <td class="paramname"><em>pActualNym</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_scriptable.html#a03d724ec348f2dc140c9ed45d6133429">OTScriptable</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00149">149</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">bool</span> bSuccess = <span class="keyword">true</span>;  <span class="comment">// Success is defined as ALL parties receiving a notice</span>
    <span class="comment">// -------------------------------------------------------</span>
    <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a>   theRecipientNym; <span class="comment">// Don&#39;t use this... use the pointer just below.</span>
    <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> * pRecipient = NULL;
    
    <span class="keywordflow">if</span> (theServerNym.<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(this-&gt;GetRecipientUserID()))
    {
        pRecipient = &amp;theServerNym; <span class="comment">// Just in case the recipient Nym is also the server Nym.</span>
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((NULL != pActualNym) &amp;&amp; pActualNym-&gt;<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(this-&gt;<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>()))
    {
        pRecipient = pActualNym;
    }
    <span class="comment">// --------------------------------------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (NULL == pRecipient)
    {
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> NYM_ID(this-&gt;<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>());
        theRecipientNym.<a class="code" href="class_o_t_pseudonym.html#a4b5f98378bb2ff1c48c5410f7283aff6">SetIdentifier</a>(NYM_ID);
        
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == theRecipientNym.<a class="code" href="class_o_t_pseudonym.html#aeb1c675ec72d6450e5c151d1f3eb95bf">LoadPublicKey</a>())
        {
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strNymID(NYM_ID);
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure loading Recipient&#39;s public key: %s\n&quot;</span>,
                          __FUNCTION__, strNymID.Get());
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theRecipientNym.<a class="code" href="class_o_t_pseudonym.html#aae8a707c7799efb6944d485be31a7c3e">VerifyPseudonym</a>() &amp;&amp;
                 theRecipientNym.<a class="code" href="class_o_t_pseudonym.html#ad24db39caa89399f659f414b19903f90">LoadSignedNymfile</a>(theServerNym)) <span class="comment">// ServerNym here is merely the signer on this file.</span>
        {
            pRecipient = &amp;theRecipientNym; <span class="comment">//  &lt;=====</span>
        }
        <span class="keywordflow">else</span>
        {
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strNymID(NYM_ID);
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure verifying Recipient&#39;s public key or loading signed nymfile: %s\n&quot;</span>,
                          __FUNCTION__, strNymID.Get());
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
    }
    <span class="comment">// BY THIS POINT, the Recipient Nym is definitely loaded up and we have</span>
    <span class="comment">// a pointer to him (pRecipient.)</span>
    <span class="comment">// -------------------------------------------------------</span>
    <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a>   theSenderNym; <span class="comment">// Don&#39;t use this... use the pointer just below.</span>
    <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> * pSender = NULL;
    
    <span class="keywordflow">if</span> (theServerNym.<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(this-&gt;GetSenderUserID()))
    {
        pSender = &amp;theServerNym; <span class="comment">// Just in case the Sender Nym is also the server Nym.</span>
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((NULL != pActualNym) &amp;&amp; pActualNym-&gt;<a class="code" href="class_o_t_pseudonym.html#a5ec9340b8d1d0fcd32f754ea63f9915a">CompareID</a>(this-&gt;<a class="code" href="class_o_t_trackable.html#aaf5d36407abeeb35eea54f7acb0c3148">GetSenderUserID</a>()))
    {
        pSender = pActualNym;
    }
    <span class="comment">// --------------------------------------------------------------------------------------------------</span>
    <span class="keywordflow">if</span> (NULL == pSender)
    {
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> NYM_ID(this-&gt;<a class="code" href="class_o_t_trackable.html#aaf5d36407abeeb35eea54f7acb0c3148">GetSenderUserID</a>());
        theSenderNym.<a class="code" href="class_o_t_pseudonym.html#a4b5f98378bb2ff1c48c5410f7283aff6">SetIdentifier</a>(NYM_ID);
        
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == theSenderNym.<a class="code" href="class_o_t_pseudonym.html#aeb1c675ec72d6450e5c151d1f3eb95bf">LoadPublicKey</a>())
        {
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strNymID(NYM_ID);
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure loading Sender&#39;s public key: %s\n&quot;</span>,
                          __FUNCTION__, strNymID.Get());
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theSenderNym.<a class="code" href="class_o_t_pseudonym.html#aae8a707c7799efb6944d485be31a7c3e">VerifyPseudonym</a>() &amp;&amp;
                 theSenderNym.<a class="code" href="class_o_t_pseudonym.html#ad24db39caa89399f659f414b19903f90">LoadSignedNymfile</a>(theServerNym)) <span class="comment">// ServerNym here is merely the signer on this file.</span>
        {
            pSender = &amp;theSenderNym; <span class="comment">//  &lt;=====</span>
        }
        <span class="keywordflow">else</span>
        {
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strNymID(NYM_ID);
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failure verifying Sender&#39;s public key or loading signed nymfile: %s\n&quot;</span>,
                          __FUNCTION__, strNymID.Get());
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
    }
    <span class="comment">// BY THIS POINT, the Sender Nym is definitely loaded up and we have</span>
    <span class="comment">// a pointer to him (pSender.)</span>
    <span class="comment">// -----------------------------------------------------------------</span>
    <span class="comment">// (pRecipient and pSender are both good pointers by this point.)</span>
    <span class="comment">// -----------------------------------------------------------------</span>
    <span class="comment">// Sender</span>
    <span class="keywordflow">if</span> (<span class="keyword">false</span> == <a class="code" href="class_o_t_agreement.html#abb0d8deeb8a1c112d313134b21bde8ce">OTAgreement::DropServerNoticeToNymbox</a>(bSuccessMsg, <span class="comment">// &quot;success&quot; notice? or &quot;failure&quot; notice?</span>
                                                       theServerNym,
                                                       theServerID,
                                                       this-&gt;<a class="code" href="class_o_t_trackable.html#aaf5d36407abeeb35eea54f7acb0c3148">GetSenderUserID</a>(),
                                                       lNewTransactionNumber,
                                                       <a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>(), <span class="comment">// in reference to</span>
                                                       strReference,
                                                       pstrNote,
                                                       pstrAttachment,
                                                       pSender))
        bSuccess = <span class="keyword">false</span>;
    <span class="comment">// Notice I don&#39;t break here -- I still allow it to try to notice ALL parties, even if one fails.</span>
    <span class="comment">// -----------------------------------------------------------------</span>
    <span class="comment">// Recipient</span>
    <span class="keywordflow">if</span> (<span class="keyword">false</span> == <a class="code" href="class_o_t_agreement.html#abb0d8deeb8a1c112d313134b21bde8ce">OTAgreement::DropServerNoticeToNymbox</a>(bSuccessMsg, <span class="comment">// &quot;success&quot; notice? or &quot;failure&quot; notice?</span>
                                                       theServerNym,
                                                       theServerID,
                                                       this-&gt;<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>(),
                                                       lNewTransactionNumber,
                                                       <a class="code" href="class_o_t_agreement.html#a3602a1424347da4b23e06b65005148f9">GetRecipientOpeningNum</a>(), <span class="comment">// in reference to</span>
                                                       strReference,
                                                       pstrNote,
                                                       pstrAttachment,
                                                       pRecipient))
        bSuccess = <span class="keyword">false</span>;
    <span class="comment">// -----------------------------------------------------------------</span>
    <span class="keywordflow">return</span> bSuccess;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a483302de5b64e685700bbfea308adc8c"></a><!-- doxytag: member="OTAgreement::SetMerchantSignedCopy" ref="a483302de5b64e685700bbfea308adc8c" args="(const OTString &amp;strMerchantCopy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a483302de5b64e685700bbfea308adc8c">OTAgreement::SetMerchantSignedCopy</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_string.html">OTString</a> &amp;&#160;</td>
          <td class="paramname"><em>strMerchantCopy</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00190">190</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <a class="code" href="class_o_t_agreement.html#a9cf1cc739b7a4aedc56f09b0956f593c">m_strMerchantSignedCopy</a> = strMerchantCopy; }
</pre></div>
</div>
</div>
<a class="anchor" id="ac02afd651c21e1df34c97061c30706fe"></a><!-- doxytag: member="OTAgreement::SetProposal" ref="ac02afd651c21e1df34c97061c30706fe" args="(OTPseudonym &amp;MERCHANT_NYM, const OTString &amp;strConsideration, const time64_t VALID_FROM=OT_TIME_ZERO, const time64_t VALID_TO=OT_TIME_ZERO)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#ac02afd651c21e1df34c97061c30706fe">OTAgreement::SetProposal</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>MERCHANT_NYM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_string.html">OTString</a> &amp;&#160;</td>
          <td class="paramname"><em>strConsideration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>&#160;</td>
          <td class="paramname"><em>VALID_FROM</em> = <code><a class="el" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>&#160;</td>
          <td class="paramname"><em>VALID_TO</em> = <code><a class="el" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01071">1071</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// ----------------------------------------------------------------------------</span>
    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> id_MERCHANT_NYM;
    MERCHANT_NYM.<a class="code" href="class_o_t_pseudonym.html#a1775c7aedd0dd25b2faf3f78dcccabe7">GetIdentifier</a>(id_MERCHANT_NYM);
    
    <span class="keywordflow">if</span> (<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>() != id_MERCHANT_NYM)
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Merchant has wrong NymID (should be same as RecipientUserID.)\n&quot;</span>,
                       __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;        
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_o_t_agreement.html#a87e9b6e7028af7ddfebaee86925e8e7b">GetRecipientUserID</a>() == <a class="code" href="class_o_t_trackable.html#aaf5d36407abeeb35eea54f7acb0c3148">GetSenderUserID</a>())
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Error: Sender and recipient have the same Nym ID (not allowed.)\n&quot;</span>,
                       __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;        
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MERCHANT_NYM.<a class="code" href="class_o_t_pseudonym.html#adee7eef0a51e8e94522c43ac898c2308">GetTransactionNumCount</a>(<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>()) &lt; 2) <span class="comment">// Need opening and closing numbers (that&#39;s 2)... </span>
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failure. You need at least 2 transaction numbers available to do this.\n&quot;</span>,
                       __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// ------------------------------------------- </span>
    <span class="comment">// Set the CREATION DATE</span>
    <span class="comment">//</span>
    <span class="keyword">const</span> <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> CURRENT_TIME = <a class="code" href="_o_t_common_8hpp.html#a1163606b2546b160d50c5f0a5afe479a">OTTimeGetCurrentTime</a>();
    
    <span class="comment">// Set the Creation Date.</span>
    <a class="code" href="class_o_t_cron_item.html#a7668dc44368861c09a47de0f420cf2fa">SetCreationDate</a>(CURRENT_TIME);
    <span class="comment">// -----------------------------------------</span>
    <span class="comment">// Putting this above here so I don&#39;t have to put the transaction numbers back if this fails:</span>
    <span class="comment">// ------------------------------------------- </span>
    <span class="comment">// VALID_FROM</span>
    <span class="comment">//</span>
    <span class="comment">// The default &quot;valid from&quot; time is NOW.</span>
    <span class="keywordflow">if</span> (<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a> &gt;= VALID_FROM) <span class="comment">// if it&#39;s 0 or less, set to current time.</span>
        <a class="code" href="class_o_t_instrument.html#af8e356f6956ad222a1766435edca8374">SetValidFrom</a>(CURRENT_TIME);
    <span class="keywordflow">else</span> <span class="comment">// Otherwise use whatever was passed in.</span>
        <a class="code" href="class_o_t_instrument.html#af8e356f6956ad222a1766435edca8374">SetValidFrom</a>(VALID_FROM);
    <span class="comment">// ------------------------------------------- </span>
    <span class="comment">// VALID_TO</span>
    <span class="comment">//</span>
    <span class="comment">// The default &quot;valid to&quot; time is 0 (which means no expiration date / cancel anytime.)</span>
    <span class="keywordflow">if</span> (<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a> == VALID_TO) <span class="comment">// VALID_TO is 0</span>
    {
        <a class="code" href="class_o_t_instrument.html#a5baef9beffaf6627cd9d5277fdbb14c3">SetValidTo</a>(VALID_TO); <span class="comment">// Keep it at zero then, so it won&#39;t expire.</span>
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a> &lt; VALID_TO) <span class="comment">// VALID_TO is ABOVE zero...</span>
    {
        <a class="code" href="class_o_t_instrument.html#a5baef9beffaf6627cd9d5277fdbb14c3">SetValidTo</a>(<a class="code" href="_o_t_common_8hpp.html#a38e4e4253c3dd158ea40e6312586e6c9">OTTimeAddTimeInterval</a>(<a class="code" href="class_o_t_instrument.html#a08eb5f25566832e1a67b3e33c0dcc13f">GetValidFrom</a>(), <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(VALID_TO))); <span class="comment">// Set it to itself + valid_from.</span>
    }
    <span class="keywordflow">else</span> <span class="comment">// VALID_TO is a NEGATIVE number... Error.</span>
    {
        int64_t lValidTo = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(VALID_TO);
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Negative value for valid_to: %lld\n&quot;</span>, __FUNCTION__, lValidTo);
        
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// ----------------------------------------------------------------------------</span>
    <span class="comment">// Since we&#39;ll be needing 2 transaction numbers to do this, let&#39;s grab &#39;em...</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_string.html">OTString</a> strServerID(<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>());
    
    int64_t lTransactionNumber=0, lClosingTransactionNo=0;
    
    <span class="keywordflow">if</span> (MERCHANT_NYM.<a class="code" href="class_o_t_pseudonym.html#adee7eef0a51e8e94522c43ac898c2308">GetTransactionNumCount</a>(<a class="code" href="class_o_t_instrument.html#a878dd8998f7b131b85c082575e255375">GetServerID</a>()) &lt; 2) <span class="comment">// Need opening and closing numbers (that&#39;s 2)... </span>
    {
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failure. You need at least 2 transaction numbers available to do this.\n&quot;</span>,
                       __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">false</span> == MERCHANT_NYM.<a class="code" href="class_o_t_pseudonym.html#a82c5ec5457947738c807bffd581181ac">GetNextTransactionNum</a>(MERCHANT_NYM, strServerID, lTransactionNumber))
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Strangely unable to get a transaction number.\n&quot;</span>,
                      __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">false</span> == MERCHANT_NYM.<a class="code" href="class_o_t_pseudonym.html#a82c5ec5457947738c807bffd581181ac">GetNextTransactionNum</a>(MERCHANT_NYM, strServerID, lClosingTransactionNo))
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Strangely unable to get a closing transaction number.\n&quot;</span>,
                      __FUNCTION__);
        MERCHANT_NYM.<a class="code" href="class_o_t_pseudonym.html#a2771ea8cf77d2ac05d942e149c2bc3e6">AddTransactionNum</a>(MERCHANT_NYM, strServerID, lTransactionNumber, <span class="keyword">true</span>); <span class="comment">// bSave=true</span>
        <span class="comment">// (Since the first one was successful, we just put it back before returning.)</span>
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }

    <span class="comment">// At this point we now have 2 transaction numbers...</span>
    <span class="comment">// We can&#39;t return without either USING THEM, or PUTTING THEM BACK.</span>
    <span class="comment">//</span>
    <span class="comment">// ---------------------------------------------------------</span>
    <span class="comment">// Set the Transaction Number and the Closing transaction number... (for merchant / recipient.)</span>
    <span class="comment">//</span>
    this-&gt;<a class="code" href="class_o_t_agreement.html#ad5a72997f44c814fb95a344b1ff140e3">AddRecipientClosingTransactionNo</a>(lTransactionNumber);
    this-&gt;<a class="code" href="class_o_t_agreement.html#ad5a72997f44c814fb95a344b1ff140e3">AddRecipientClosingTransactionNo</a>(lClosingTransactionNo);
    <span class="comment">// (They just both go onto this same list.)</span>
    <span class="comment">// -------------------------------------------</span>
    <span class="comment">// Set the Consideration memo...</span>
    <a class="code" href="class_o_t_agreement.html#a2190324be86fd30f04f4ff88d1a14578">m_strConsideration</a>.<a class="code" href="class_o_t_string.html#aa5db620fe8e60c849585d741975db991">Set</a>(strConsideration);
    <span class="comment">// -------------------------------------------</span>
    <a class="code" href="class_o_t_log.html#a1f7549d776ee919dcb6517f611ded015">OTLog::Output</a>(4, <span class="stringliteral">&quot;Successfully performed SetProposal.\n&quot;</span>);  
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a06eed084ec0ad88e07df120943b1db0d"></a><!-- doxytag: member="OTAgreement::SetRecipientAcctID" ref="a06eed084ec0ad88e07df120943b1db0d" args="(const OTIdentifier &amp;ACCT_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a06eed084ec0ad88e07df120943b1db0d">OTAgreement::SetRecipientAcctID</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>ACCT_ID</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00295">295</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ m_RECIPIENT_ACCT_ID = ACCT_ID; }
</pre></div>
</div>
</div>
<a class="anchor" id="a919c05371fb8f1e0038b2576c5c6fc6b"></a><!-- doxytag: member="OTAgreement::SetRecipientUserID" ref="a919c05371fb8f1e0038b2576c5c6fc6b" args="(const OTIdentifier &amp;USER_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a919c05371fb8f1e0038b2576c5c6fc6b">OTAgreement::SetRecipientUserID</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>USER_ID</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00296">296</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ m_RECIPIENT_USER_ID = USER_ID; }
</pre></div>
</div>
</div>
<a class="anchor" id="a6b6a960a3cf2ea5dace23b9107b829cf"></a><!-- doxytag: member="OTAgreement::UpdateContents" ref="a6b6a960a3cf2ea5dace23b9107b829cf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_agreement.html#a6b6a960a3cf2ea5dace23b9107b829cf">OTAgreement::UpdateContents</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_trackable.html#ae708d31ab5dca7a4dff24b0534fec889">OTTrackable</a>.</p>

<p>Reimplemented in <a class="el" href="class_o_t_payment_plan.html#a3b3c234f381f92f16d8ef1feaebb8a57">OTPaymentPlan</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l01407">1407</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// See OTPaymentPlan::UpdateContents.</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a77490299358ae40664773d63306a77f1"></a><!-- doxytag: member="OTAgreement::VerifyAgreement" ref="a77490299358ae40664773d63306a77f1" args="(OTPseudonym &amp;RECIPIENT_NYM, OTPseudonym &amp;SENDER_NYM)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool <a class="el" href="class_o_t_agreement.html#a77490299358ae40664773d63306a77f1">OTAgreement::VerifyAgreement</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>RECIPIENT_NYM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>SENDER_NYM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implemented in <a class="el" href="class_o_t_payment_plan.html#a774efdf388acb0982bbdd9dd1c4b732d">OTPaymentPlan</a>.</p>

</div>
</div>
<a class="anchor" id="a55854189c875ce691374dd49f8de0494"></a><!-- doxytag: member="OTAgreement::VerifyNymAsAgent" ref="a55854189c875ce691374dd49f8de0494" args="(OTPseudonym &amp;theNym, OTPseudonym &amp;theSignerNym, mapOfNyms *pmap_ALREADY_LOADED=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#a55854189c875ce691374dd49f8de0494">OTAgreement::VerifyNymAsAgent</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theNym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theSignerNym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_o_t_agent_8hpp.html#ac89892658f6bc83e354078647b704e8f">mapOfNyms</a> *&#160;</td>
          <td class="paramname"><em>pmap_ALREADY_LOADED</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_scriptable.html#a242f30ff4c6deccf285930efa15638eb">OTScriptable</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00500">500</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_o_t_contract.html#a38f51d593b6dfc8a75d1c5a535965392">VerifySignature</a>(theNym);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a306ad448347dffd754fa04ca41473f4b"></a><!-- doxytag: member="OTAgreement::VerifyNymAsAgentForAccount" ref="a306ad448347dffd754fa04ca41473f4b" args="(OTPseudonym &amp;theNym, OTAccount &amp;theAccount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_agreement.html#a306ad448347dffd754fa04ca41473f4b">OTAgreement::VerifyNymAsAgentForAccount</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theNym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_account.html">OTAccount</a> &amp;&#160;</td>
          <td class="paramname"><em>theAccount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_scriptable.html#a844de5b0eb2560a28bf795c2c4da3f3b">OTScriptable</a>.</p>

<p>Definition at line <a class="el" href="_o_t_agreement_8cpp_source.html#l00510">510</a> of file <a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> theAccount.<a class="code" href="class_o_t_account.html#a73c89c2d411eb7b88326baf87802f238">VerifyOwner</a>(theNym);
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aa919e5456ba118002ef4ca58f2c3536d"></a><!-- doxytag: member="OTAgreement::m_dequeRecipientClosingNumbers" ref="aa919e5456ba118002ef4ca58f2c3536d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::deque&lt;int64_t&gt; <a class="el" href="class_o_t_agreement.html#aa919e5456ba118002ef4ca58f2c3536d">OTAgreement::m_dequeRecipientClosingNumbers</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00184">184</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2190324be86fd30f04f4ff88d1a14578"></a><!-- doxytag: member="OTAgreement::m_strConsideration" ref="a2190324be86fd30f04f4ff88d1a14578" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_string.html">OTString</a> <a class="el" href="class_o_t_agreement.html#a2190324be86fd30f04f4ff88d1a14578">OTAgreement::m_strConsideration</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00172">172</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9cf1cc739b7a4aedc56f09b0956f593c"></a><!-- doxytag: member="OTAgreement::m_strMerchantSignedCopy" ref="a9cf1cc739b7a4aedc56f09b0956f593c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_string.html">OTString</a> <a class="el" href="class_o_t_agreement.html#a9cf1cc739b7a4aedc56f09b0956f593c">OTAgreement::m_strMerchantSignedCopy</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_agreement_8hpp_source.html#l00174">174</a> of file <a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/otlib/<a class="el" href="_o_t_agreement_8hpp_source.html">OTAgreement.hpp</a></li>
<li>src/otlib/<a class="el" href="_o_t_agreement_8cpp_source.html">OTAgreement.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_o_t_agreement.html">OTAgreement</a>      </li>

    <li class="footer">Generated on Wed May 21 2014 11:26:08 for Open-Transactions by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
