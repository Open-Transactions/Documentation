<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Open-Transactions: OTCron Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Open-Transactions
   &#160;<span id="projectnumber">master/1066fb4910a63ee3f7de8e0807fee3eb663b66c7</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_o_t_cron.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">OTCron Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="OTCron" --><!-- doxytag: inherits="OTContract" -->
<p><code>#include &lt;<a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OTCron:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_o_t_cron.png" usemap="#OTCron_map" alt=""/>
  <map id="OTCron_map" name="OTCron_map">
<area href="class_o_t_contract.html" alt="OTContract" shape="rect" coords="0,0,77,24"/>
</map>
 </div></div>

<p><a href="class_o_t_cron-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a1f1795c385d987bd098e1c636f4a08ce">IsActivated</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a226d64f94cc582bbaefc9e3b8c1fe86a">ActivateCron</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a2d42c183c174f56a7c7c3da1e844a53f">AddCronItem</a> (<a class="el" href="class_o_t_cron_item.html">OTCronItem</a> &amp;theItem, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *pActivator, bool bSaveReceipt, <a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> tDateAdded)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a8db968a79df5cee7258c4c08ba07973b">RemoveCronItem</a> (int64_t lTransactionNum, <a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;theRemover)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="class_o_t_cron_item.html">OTCronItem</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a6d121cbd4e80ffc9c9237304af5d6370">GetItemByOfficialNum</a> (int64_t lTransactionNum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="class_o_t_cron_item.html">OTCronItem</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#ab732ac1263aac936d8d948df3412119b">GetItemByValidOpeningNum</a> (int64_t lOpeningNum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT mapOfCronItems::iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#aedcabce992fbabf7737fcbd9ae89b1d6">FindItemOnMap</a> (int64_t lTransactionNum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <br class="typebreak"/>
multimapOfCronItems::iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#ab412c2adb3f43e26df041737f854dde1">FindItemOnMultimap</a> (int64_t lTransactionNum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a140c03fce539cd99e61e2b5baed85f76">AddMarket</a> (<a class="el" href="class_o_t_market.html">OTMarket</a> &amp;theMarket, bool bSaveMarketFile=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a3ef869ba62f1f9bf651ec48fe3fa2df0">RemoveMarket</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;MARKET_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="class_o_t_market.html">OTMarket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#afcc38ab744f5e3710982c600c4412cf2">GetMarket</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;MARKET_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_o_t_market.html">OTMarket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#af4fa1a950a600220ac5e570b58e892ff">GetOrCreateMarket</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;ASSET_ID, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;CURRENCY_ID, const int64_t &amp;lScale)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#ae331e0bba385dfd33a8f7cca095d2380">GetMarketList</a> (<a class="el" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> &amp;ascOutput, int32_t &amp;nMarketCount)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a581f68b86ff6f5ef1200e885a8f159f9">GetNym_OfferList</a> (<a class="el" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> &amp;ascOutput, const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;NYM_ID, int32_t &amp;nOfferCount)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#aad85faf2146cea516d7a5f169904485d">AddTransactionNumber</a> (const int64_t &amp;lTransactionNum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a22822e0aeced441b6404cd8a2c8e00da">GetNextTransactionNumber</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#ae241ecf6802b59ccde653082f098e80c">GetTransactionCount</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a1a8bdc614a109ccecf9712531ba9cf14">ProcessCronItems</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a7c421c0abe1a6728a2a056bfb46a3de2">SetServerID</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a93b52f56c0de94e53bb05a610830ba4b">GetServerID</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a8c09682be017ef6c39a84c27123e23b2">SetServerNym</a> (<a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *pServerNym)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a6ad24d6d2669343157613f0efa017312">LoadCron</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a24df32b4bf36e48867e7afda0955bb72">SaveCron</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a5a23a6680d03524413273619754b50f8">OTCron</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#ab9187f8ef70b5e8da33b0a7f7288b8e2">OTCron</a> (const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;SERVER_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a38ae0d6032705c5024f33b81d97dc8a6">OTCron</a> (const char *szFilename)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#aecf46efa13fe912238e3218d404f8f6d">~OTCron</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a77c951666003558d04a02228bd2d2ff7">InitCron</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a7ec2571d52ceaab093afe06f7746c08b">Release</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#aa1cf58f86207ccdd857ae16ef2488f8f">Release_Cron</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a004071b22676a0419f1b6de519f00b78">ProcessXMLNode</a> (<a class="el" href="namespaceirr_1_1io.html#a1628edbb9d5d53f18c82d2a92b0ad27e">irr::io::IrrXMLReader</a> *&amp;xml)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a0eee508b9330b0dc0776c4a8cb9e2b9b">UpdateContents</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#aa40e13f9fa75869b77e57de7b88c21b9">SaveContractWallet</a> (std::ofstream &amp;ofs)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#af81a76731bdaa2d9d32df8c02ec0739d">GetCronMsBetweenProcess</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a619a81f1f5a75c7f9e20d5542b8f9fe9">SetCronMsBetweenProcess</a> (int32_t lMS)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a6e1ade4402e6db7aad96b8b2177be9d9">GetCronRefillAmount</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#a40e88ae62f7c536109228251feace4be">SetCronRefillAmount</a> (int32_t nAmount)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#accfe2e68cac873324a78037a46607854">GetCronMaxItemsPerNym</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_cron.html#acdc92929308e95fa1af64320d3c51191">SetCronMaxItemsPerNym</a> (int32_t nMax)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00164">164</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a5a23a6680d03524413273619754b50f8"></a><!-- doxytag: member="OTCron::OTCron" ref="a5a23a6680d03524413273619754b50f8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_cron.html#a5a23a6680d03524413273619754b50f8">OTCron::OTCron</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01208">1208</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">               : ot_super(), m_bIsActivated(<span class="keyword">false</span>), m_pServerNym(NULL) <span class="comment">// just here for convenience, not responsible to cleanup this pointer.</span>
{
    <a class="code" href="class_o_t_cron.html#a77c951666003558d04a02228bd2d2ff7">InitCron</a>();
    <a class="code" href="class_o_t_log.html#a1f7549d776ee919dcb6517f611ded015">OTLog::Output</a>(3, <span class="stringliteral">&quot;OTCron::OTCron: Finished calling InitCron 0.\n&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab9187f8ef70b5e8da33b0a7f7288b8e2"></a><!-- doxytag: member="OTCron::OTCron" ref="ab9187f8ef70b5e8da33b0a7f7288b8e2" args="(const OTIdentifier &amp;SERVER_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_cron.html#a5a23a6680d03524413273619754b50f8">OTCron::OTCron</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01215">1215</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                             : ot_super(), m_bIsActivated(<span class="keyword">false</span>), m_pServerNym(NULL) <span class="comment">// just here for convenience, not responsible to cleanup this pointer.</span>
{
    <a class="code" href="class_o_t_cron.html#a77c951666003558d04a02228bd2d2ff7">InitCron</a>(); 
    <a class="code" href="class_o_t_cron.html#a7c421c0abe1a6728a2a056bfb46a3de2">SetServerID</a>(SERVER_ID);
    <a class="code" href="class_o_t_log.html#a1f7549d776ee919dcb6517f611ded015">OTLog::Output</a>(3, <span class="stringliteral">&quot;OTCron::OTCron: Finished calling InitCron 1.\n&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a38ae0d6032705c5024f33b81d97dc8a6"></a><!-- doxytag: member="OTCron::OTCron" ref="a38ae0d6032705c5024f33b81d97dc8a6" args="(const char *szFilename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_cron.html#a5a23a6680d03524413273619754b50f8">OTCron::OTCron</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>szFilename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01223">1223</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                      : ot_super(), m_bIsActivated(<span class="keyword">false</span>), m_pServerNym(NULL) <span class="comment">// just here for convenience, not responsible to cleanup this pointer.</span>
{
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != szFilename);
    <a class="code" href="class_o_t_cron.html#a77c951666003558d04a02228bd2d2ff7">InitCron</a>();
    
    <a class="code" href="class_o_t_contract.html#ab1e11693a38a1673037b1f29c9d84010">m_strFoldername</a>.<a class="code" href="class_o_t_string.html#aa5db620fe8e60c849585d741975db991">Set</a>(<a class="code" href="class_o_t_folders.html#aabb5605423422af18b156b9cd5e48c22">OTFolders::Cron</a>().Get());
    <a class="code" href="class_o_t_contract.html#ab7ab1f1fe7ff7e52f2c126404a8f4f92">m_strFilename</a>.<a class="code" href="class_o_t_string.html#aa5db620fe8e60c849585d741975db991">Set</a>(szFilename);
    <a class="code" href="class_o_t_log.html#a1f7549d776ee919dcb6517f611ded015">OTLog::Output</a>(3, <span class="stringliteral">&quot;OTCron::OTCron: Finished calling InitCron 2.\n&quot;</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aecf46efa13fe912238e3218d404f8f6d"></a><!-- doxytag: member="OTCron::~OTCron" ref="aecf46efa13fe912238e3218d404f8f6d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_cron.html#aecf46efa13fe912238e3218d404f8f6d">OTCron::~OTCron</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01234">1234</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_cron.html#aa1cf58f86207ccdd857ae16ef2488f8f">Release_Cron</a>();
    
    m_pServerNym = NULL;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a226d64f94cc582bbaefc9e3b8c1fe86a"></a><!-- doxytag: member="OTCron::ActivateCron" ref="a226d64f94cc582bbaefc9e3b8c1fe86a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#a226d64f94cc582bbaefc9e3b8c1fe86a">OTCron::ActivateCron</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00199">199</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">if</span> (!m_bIsActivated) <span class="keywordflow">return</span> m_bIsActivated = <span class="keyword">true</span>; <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">false</span>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a2d42c183c174f56a7c7c3da1e844a53f"></a><!-- doxytag: member="OTCron::AddCronItem" ref="a2d42c183c174f56a7c7c3da1e844a53f" args="(OTCronItem &amp;theItem, OTPseudonym *pActivator, bool bSaveReceipt, time64_t tDateAdded)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#a2d42c183c174f56a7c7c3da1e844a53f">OTCron::AddCronItem</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_cron_item.html">OTCronItem</a> &amp;&#160;</td>
          <td class="paramname"><em>theItem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *&#160;</td>
          <td class="paramname"><em>pActivator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bSaveReceipt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>&#160;</td>
          <td class="paramname"><em>tDateAdded</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00790">790</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != <a class="code" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a>());
    
    <span class="comment">// See if there&#39;s something else already there with the same transaction number.</span>
    <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pCronItem = this-&gt;<a class="code" href="class_o_t_cron.html#a6d121cbd4e80ffc9c9237304af5d6370">GetItemByOfficialNum</a>(theItem.<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>());
    
    <span class="comment">// If it&#39;s not already on the list, then add it...</span>
    <span class="keywordflow">if</span> ( NULL == pCronItem )
    {
        <span class="comment">// If I&#39;ve been instructed to save the receipt, and theItem did NOT successfully save the receipt,</span>
        <span class="comment">// then return false.</span>
        <span class="comment">//</span>
        <span class="comment">// This will happen if filesystem problems, but it will also happen if the cron item WAS ALREADY THERE.</span>
        <span class="comment">// I don&#39;t want to save over it. If I&#39;m trying to save over one that is already there, then THAT is the</span>
        <span class="comment">// real problem.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (bSaveReceipt &amp;&amp; 
            <span class="comment">// ---------------------------</span>
            (!theItem.<a class="code" href="class_o_t_contract.html#abd60037fe655ee8cae9a3ece5d1e2ea6">SignContract</a>(*<a class="code" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a>()) ||  <span class="comment">// Notice the server adds its signature before saving the cron receipt to local storage. This way, the server can verify its own signature later, as evidence the file hasn&#39;t been tampered with. (BOTH signatures are there now--user&#39;s and server&#39;s.)</span>
             !theItem.<a class="code" href="class_o_t_contract.html#a363ae430d4fd9256ab8364dbafb95444">SaveContract</a>() || 
             !theItem.<a class="code" href="class_o_t_cron_item.html#aebfbcf50eeb2effe9c3189518910b48d">SaveCronReceipt</a>()))
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error saving receipt while adding new CronItem to Cron.\n&quot;</span>,
                          __FUNCTION__);
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
        <span class="comment">// --------------------------------------------------------</span>
        <span class="comment">// Insert to the MAP (by Transaction Number)</span>
        <span class="comment">//</span>
        m_mapCronItems.insert( std::pair&lt;int64_t, OTCronItem *&gt;(theItem.<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>(), &amp;theItem) );
        <span class="comment">// --------------------------------------------------------</span>
        <span class="comment">// Insert to the MULTIMAP (by Date)</span>
        <span class="comment">//</span>
        m_multimapCronItems.insert (m_multimapCronItems.upper_bound(tDateAdded),
                                    std::pair&lt;time64_t, OTCronItem *&gt;(tDateAdded, &amp;theItem) );
        <span class="comment">// --------------------------------------------------------</span>
        theItem.<a class="code" href="class_o_t_cron_item.html#a3ec8412d780384e48c756eff6726002c">SetCronPointer</a>(*<span class="keyword">this</span>); <span class="comment">// This way every CronItem has a pointer to momma.</span>
        <span class="comment">// --------------------------------------------------------</span>
        <span class="keywordtype">bool</span> bSuccess = <span class="keyword">true</span>;
        <span class="comment">// ------------------------------------------------------</span>
        theItem.<a class="code" href="class_o_t_cron_item.html#a9f3818706d6fe1b8880c538392b4d62c">HookActivationOnCron</a>(pActivator, <span class="comment">// (OTPseudonym * pActivator) // sometimes NULL.</span>
                                     bSaveReceipt); <span class="comment">// If merely being reloaded after server reboot, this is false. </span>
                                                    <span class="comment">// But if actually being activated for the first time, then this is true.</span>
        <span class="comment">// ------------------------------------------------------</span>
        <span class="comment">// When an item is added to Cron for the first time, a copy of it is saved to the</span>
        <span class="comment">// cron folder, and it has the user&#39;s original signature on it. (If it&#39;s a Trade, </span>
        <span class="comment">// it also contains an Offer with the user&#39;s original signature.) This occurs</span>
        <span class="comment">// wherever this function is called with bSaveReceipt=true.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (bSaveReceipt)   <span class="comment">// This executes only the first time that an item is added to Cron. </span>
                            <span class="comment">// (versus when it&#39;s just being reloaded from file and added back to the internal list.)</span>
        {
            <span class="comment">// Now that a copy of the cronitem is safely stored, I can release the signature on it</span>
            <span class="comment">// and sign it with the Server&#39;s Nym instead. That way I can use the server to verify</span>
            <span class="comment">// all cron and market-related activity from here on out.</span>
<span class="comment">//          theItem.ReleaseSignatures();</span>
<span class="comment">//          theItem.SignContract(*GetServerNym()); // THIS IS NOW DONE ABOVE. See if (bSaveReceipt) ...</span>
<span class="comment">//          theItem.SaveContract(); </span>
            
            <span class="comment">// Since we added an item to the Cron, we SAVE it. </span>
            bSuccess = <a class="code" href="class_o_t_cron.html#a24df32b4bf36e48867e7afda0955bb72">SaveCron</a>();
            
            <span class="keywordflow">if</span> (bSuccess)
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: New CronItem has been added to Cron: %lld\n&quot;</span>,
                              __FUNCTION__, theItem.<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>());
            <span class="keywordflow">else</span>                
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error saving while adding new CronItem to Cron: %lld\n&quot;</span>,
                              __FUNCTION__, theItem.<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>());
        }
        
        <span class="keywordflow">return</span> bSuccess; 
    }
    <span class="comment">// Otherwise, if it was already there, log an error.</span>
    <span class="keywordflow">else</span> 
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Failed attempt to add CronItem with pre-existing transaction number: %lld\n&quot;</span>,
                      __FUNCTION__, theItem.<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>());
    }
    
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a140c03fce539cd99e61e2b5baed85f76"></a><!-- doxytag: member="OTCron::AddMarket" ref="a140c03fce539cd99e61e2b5baed85f76" args="(OTMarket &amp;theMarket, bool bSaveMarketFile=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#a140c03fce539cd99e61e2b5baed85f76">OTCron::AddMarket</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_market.html">OTMarket</a> &amp;&#160;</td>
          <td class="paramname"><em>theMarket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bSaveMarketFile</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01047">1047</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{   
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != <a class="code" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a>());

    theMarket.<a class="code" href="class_o_t_market.html#afc579c8a9d0eb969ce4cd302701c7c9d">SetCronPointer</a>(*<span class="keyword">this</span>); <span class="comment">// This way every Market has a pointer to Cron.</span>
    
    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>    MARKET_ID(theMarket);
    <a class="code" href="class_o_t_string.html">OTString</a>        str_MARKET_ID(MARKET_ID);
    std::string     std_MARKET_ID = str_MARKET_ID.Get();
    
    <span class="comment">// See if there&#39;s something else already there with the same market ID.</span>
    mapOfMarkets::iterator ii = m_mapMarkets.find(std_MARKET_ID);
    
    <span class="comment">// If it&#39;s not already on the list, then add it...</span>
    <span class="keywordflow">if</span> ( ii == m_mapMarkets.end() )
    {
        <span class="comment">// If I&#39;ve been instructed to save the market, and Cron did NOT successfully save the market</span>
        <span class="comment">//  (to its own file), then return false.  This will happen if filesystem problems.</span>
        <span class="keywordflow">if</span> (bSaveMarketFile &amp;&amp; !theMarket.<a class="code" href="class_o_t_market.html#ad19e688ee73a7358fe343358ff3e5b8a">SaveMarket</a>())
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;Error saving market file while adding new Market to Cron:\n%s\n&quot;</span>,
                         std_MARKET_ID.c_str());
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
        
        m_mapMarkets[std_MARKET_ID] = &amp;theMarket;
        
        <span class="keywordtype">bool</span> bSuccess = <span class="keyword">true</span>;
        
        <span class="comment">// When Cron serializes, it stores a list of all its markets in the main cron file.</span>
        <span class="comment">// The actual markets themselves serialize separately to the market folder.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (bSaveMarketFile)    <span class="comment">// This executes only the first time that a market is added to Cron. </span>
            <span class="comment">// (versus when it&#39;s just being reloaded from file and added back to the internal list.)</span>
        {
            <span class="comment">// Since we added a market to the Cron, we SAVE it. </span>
            bSuccess = <a class="code" href="class_o_t_cron.html#a24df32b4bf36e48867e7afda0955bb72">SaveCron</a>(); <span class="comment">// If we&#39;re loading from file, and bSaveMarketFile is false, I don&#39;t want to save here. that&#39;s why it&#39;s in this block.</span>
            
            <span class="keywordflow">if</span> (bSuccess) 
                <a class="code" href="class_o_t_log.html#a1f7549d776ee919dcb6517f611ded015">OTLog::Output</a>(3, <span class="stringliteral">&quot;New Market has been added to Cron.\n&quot;</span>);
            <span class="keywordflow">else</span>                
                <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Error saving while adding new Market to Cron.\n&quot;</span>);
        }
        
        <span class="keywordflow">return</span> bSuccess; 
    }
    <span class="comment">// Otherwise, if it was already there, log an error.</span>
    <span class="keywordflow">else</span> 
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;Attempt to add Market that was already there: %s\n&quot;</span>, std_MARKET_ID.c_str());
    }
    
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aad85faf2146cea516d7a5f169904485d"></a><!-- doxytag: member="OTCron::AddTransactionNumber" ref="aad85faf2146cea516d7a5f169904485d" args="(const int64_t &amp;lTransactionNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_cron.html#aad85faf2146cea516d7a5f169904485d">OTCron::AddTransactionNumber</a> </td>
          <td>(</td>
          <td class="paramtype">const int64_t &amp;&#160;</td>
          <td class="paramname"><em>lTransactionNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00426">426</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    m_listTransactionNumbers.push_back(lTransactionNum);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aedcabce992fbabf7737fcbd9ae89b1d6"></a><!-- doxytag: member="OTCron::FindItemOnMap" ref="aedcabce992fbabf7737fcbd9ae89b1d6" args="(int64_t lTransactionNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mapOfCronItems::iterator <a class="el" href="class_o_t_cron.html#aedcabce992fbabf7737fcbd9ae89b1d6">OTCron::FindItemOnMap</a> </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>lTransactionNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00922">922</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// See if there&#39;s something there with lTransactionNum</span>
    <span class="comment">// as its &quot;official&quot; number.</span>
    <span class="comment">//</span>
    mapOfCronItems::iterator itt = m_mapCronItems.find(lTransactionNum);
    
    <span class="keywordflow">if</span> ( itt != m_mapCronItems.end() ) <span class="comment">// Found it!</span>
    {
        <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = (*itt).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>((NULL != pItem));
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(pItem-&gt;<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>() == lTransactionNum);
        
        <span class="keywordflow">return</span> itt;
    }
    
    <span class="keywordflow">return</span> itt;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab412c2adb3f43e26df041737f854dde1"></a><!-- doxytag: member="OTCron::FindItemOnMultimap" ref="ab412c2adb3f43e26df041737f854dde1" args="(int64_t lTransactionNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">multimapOfCronItems::iterator <a class="el" href="class_o_t_cron.html#ab412c2adb3f43e26df041737f854dde1">OTCron::FindItemOnMultimap</a> </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>lTransactionNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00950">950</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    multimapOfCronItems::iterator itt = m_multimapCronItems.begin();
    
    <span class="keywordflow">while</span> (m_multimapCronItems.end() != itt)
    {
        <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = (*itt).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>((NULL != pItem));
        <span class="comment">// --------------------------------</span>
        <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>() == lTransactionNum)
            <span class="keywordflow">break</span>;
        <span class="comment">// --------------------------------</span>
        ++itt;
    }
    
    <span class="keywordflow">return</span> itt;
}
</pre></div>
</div>
</div>
<a class="anchor" id="accfe2e68cac873324a78037a46607854"></a><!-- doxytag: member="OTCron::GetCronMaxItemsPerNym" ref="accfe2e68cac873324a78037a46607854" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t <a class="el" href="class_o_t_cron.html#accfe2e68cac873324a78037a46607854">OTCron::GetCronMaxItemsPerNym</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00195">195</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> __cron_max_items_per_nym; }
</pre></div>
</div>
</div>
<a class="anchor" id="af81a76731bdaa2d9d32df8c02ec0739d"></a><!-- doxytag: member="OTCron::GetCronMsBetweenProcess" ref="af81a76731bdaa2d9d32df8c02ec0739d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t <a class="el" href="class_o_t_cron.html#af81a76731bdaa2d9d32df8c02ec0739d">OTCron::GetCronMsBetweenProcess</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00189">189</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> __cron_ms_between_process; }
</pre></div>
</div>
</div>
<a class="anchor" id="a6e1ade4402e6db7aad96b8b2177be9d9"></a><!-- doxytag: member="OTCron::GetCronRefillAmount" ref="a6e1ade4402e6db7aad96b8b2177be9d9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t <a class="el" href="class_o_t_cron.html#a6e1ade4402e6db7aad96b8b2177be9d9">OTCron::GetCronRefillAmount</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00192">192</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> __trans_refill_amount; }
</pre></div>
</div>
</div>
<a class="anchor" id="a6d121cbd4e80ffc9c9237304af5d6370"></a><!-- doxytag: member="OTCron::GetItemByOfficialNum" ref="a6d121cbd4e80ffc9c9237304af5d6370" args="(int64_t lTransactionNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_cron_item.html">OTCronItem</a> * <a class="el" href="class_o_t_cron.html#a6d121cbd4e80ffc9c9237304af5d6370">OTCron::GetItemByOfficialNum</a> </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>lTransactionNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00977">977</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// See if there&#39;s something there with lTransactionNum</span>
    <span class="comment">// as its &quot;official&quot; number.</span>
    <span class="comment">//</span>
    mapOfCronItems::iterator itt = m_mapCronItems.find(lTransactionNum);
    
    <span class="keywordflow">if</span> ( itt != m_mapCronItems.end() ) <span class="comment">// Found it!</span>
    {
        <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = (*itt).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>((NULL != pItem));
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(pItem-&gt;<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>() == lTransactionNum);
        
        <span class="keywordflow">return</span> pItem;
    }
    
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab732ac1263aac936d8d948df3412119b"></a><!-- doxytag: member="OTCron::GetItemByValidOpeningNum" ref="ab732ac1263aac936d8d948df3412119b" args="(int64_t lOpeningNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_cron_item.html">OTCronItem</a> * <a class="el" href="class_o_t_cron.html#ab732ac1263aac936d8d948df3412119b">OTCron::GetItemByValidOpeningNum</a> </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>lOpeningNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01008">1008</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// See if there&#39;s something there with that transaction number.</span>
    mapOfCronItems::iterator itt = m_mapCronItems.find(lOpeningNum);

    <span class="keywordflow">if</span> ( itt == m_mapCronItems.end() )
    {
        <span class="comment">// We didn&#39;t find it as the &quot;official&quot; number, so let&#39;s loop</span>
        <span class="comment">// through the cron items one-by-one and see if it&#39;s a valid</span>
        <span class="comment">// opening number. (We searched for the &quot;official&quot; number first,</span>
        <span class="comment">// since it will often be the right one, and avoids doing this</span>
        <span class="comment">// longer search. Basically for optimization purposes.)</span>
        <span class="comment">//</span>
        <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_cron_8hpp.html#a90e72314c5fd92c5f141cab3981cda22">mapOfCronItems</a>, m_mapCronItems)
        {
            <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = (*it).second;
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>((NULL != pItem));
            <span class="comment">// ------------------------</span>
            <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="class_o_t_cron_item.html#a9fd34100c4c79adf325c61ba268008ef">IsValidOpeningNumber</a>(lOpeningNum)) <span class="comment">// Todo optimization. Probably can remove this check.</span>
                <span class="keywordflow">return</span> pItem;
        }
    }
    <span class="comment">// Found it!</span>
    <span class="keywordflow">else</span> 
    {
        <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = (*itt).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>((NULL != pItem));
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(pItem-&gt;<a class="code" href="class_o_t_cron_item.html#a9fd34100c4c79adf325c61ba268008ef">IsValidOpeningNumber</a>(lOpeningNum)); <span class="comment">// Todo optimization. Probably can remove this check.</span>
        
        <span class="keywordflow">return</span> pItem;
    }
    
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afcc38ab744f5e3710982c600c4412cf2"></a><!-- doxytag: member="OTCron::GetMarket" ref="afcc38ab744f5e3710982c600c4412cf2" args="(const OTIdentifier &amp;MARKET_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_market.html">OTMarket</a> * <a class="el" href="class_o_t_cron.html#afcc38ab744f5e3710982c600c4412cf2">OTCron::GetMarket</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>MARKET_ID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01174">1174</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_string.html">OTString</a>        str_MARKET_ID(MARKET_ID);
    std::string     std_MARKET_ID = str_MARKET_ID.Get();
    
    <span class="comment">// See if there&#39;s something there with that transaction number.</span>
    mapOfMarkets::iterator ii = m_mapMarkets.find(std_MARKET_ID);
    
    <span class="keywordflow">if</span> ( ii == m_mapMarkets.end() )
    {
        <span class="comment">// nothing found.</span>
        <span class="keywordflow">return</span> NULL;
    }
    <span class="comment">// Found it!</span>
    <span class="keywordflow">else</span> 
    {
        <a class="code" href="class_o_t_market.html">OTMarket</a> * pMarket = (*ii).second;
        
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>((NULL != pMarket));
        
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>  LOOP_MARKET_ID(*pMarket);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>      str_LOOP_MARKET_ID(LOOP_MARKET_ID);
        
        <span class="keywordflow">if</span> (MARKET_ID == LOOP_MARKET_ID)
            <span class="keywordflow">return</span> pMarket;
        <span class="keywordflow">else</span> 
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;Expected Market with ID:\n%s\n but found %s\n&quot;</span>,
                          std_MARKET_ID.c_str(), str_LOOP_MARKET_ID.Get());
    }
    
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae331e0bba385dfd33a8f7cca095d2380"></a><!-- doxytag: member="OTCron::GetMarketList" ref="ae331e0bba385dfd33a8f7cca095d2380" args="(OTASCIIArmor &amp;ascOutput, int32_t &amp;nMarketCount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#ae331e0bba385dfd33a8f7cca095d2380">OTCron::GetMarketList</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> &amp;&#160;</td>
          <td class="paramname"><em>ascOutput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t &amp;&#160;</td>
          <td class="paramname"><em>nMarketCount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00280">280</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    nMarketCount        = 0; <span class="comment">// This parameter is set to zero here, and incremented in the loop below.</span>
    

    <a class="code" href="class_o_t_market.html">OTMarket</a> * pMarket  = NULL;

    <a class="code" href="class_o_t_d_b_1_1_market_list.html">OTDB::MarketList</a> * pMarketList  = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_o_t_d_b_1_1_market_list.html">OTDB::MarketList</a>*<span class="keyword">&gt;</span>(<a class="code" href="namespace_o_t_d_b.html#a67b35ca5812604fb3e1eae2b659f66ee">OTDB::CreateObject</a>(<a class="code" href="namespace_o_t_d_b.html#abce432e500285dde333e6f76f6fbde82a7a0f581c82f5599271fcd57d0a020f99">OTDB::STORED_OBJ_MARKET_LIST</a>));
    <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTDB::MarketList&gt;</a> theListAngel(*pMarketList);

        
    <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_cron_8hpp.html#a59d4f7139328282aa9ee62a031844246">mapOfMarkets</a>, m_mapMarkets)
    {       
        pMarket = (*it).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pMarket);
        
        <a class="code" href="class_o_t_d_b_1_1_market_data.html">OTDB::MarketData</a> * pMarketData  = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_o_t_d_b_1_1_market_data.html">OTDB::MarketData</a> *<span class="keyword">&gt;</span>(<a class="code" href="namespace_o_t_d_b.html#a67b35ca5812604fb3e1eae2b659f66ee">OTDB::CreateObject</a>(<a class="code" href="namespace_o_t_d_b.html#abce432e500285dde333e6f76f6fbde82af692b998fb062c5d9655b4cd7d55aa25">OTDB::STORED_OBJ_MARKET_DATA</a>));
        <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTDB::MarketData&gt;</a> theDataAngel(*pMarketData);
        

        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>  MARKET_ID(*pMarket);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>      str_MARKET_ID(MARKET_ID);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>      str_ServerID(pMarket-&gt;<a class="code" href="class_o_t_market.html#acbe41dd985ce33b5b72957b99a984444">GetServerID</a>());
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>      str_ASSET_ID(pMarket-&gt;<a class="code" href="class_o_t_market.html#a0a4e04126fb83f13b1477fccc169c0e9">GetAssetID</a>());
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>      str_CURRENCY_ID(pMarket-&gt;<a class="code" href="class_o_t_market.html#aeeac45c32cade4a24d29e7a829304956">GetCurrencyID</a>());
        
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#a259cf0034349d580b465bd10aacd06ed">server_id</a>          = str_ServerID.Get();
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#adbe791894d6afbfa49af07102e94b10c">market_id</a>          = str_MARKET_ID.Get();
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#ad94bc54282a6acefbd34088f8ee5afa6">asset_type_id</a>      = str_ASSET_ID.Get();
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#a1116aae82af6f197a038688704c2138f">currency_type_id</a>   = str_CURRENCY_ID.Get();
        <span class="comment">// --------------------------------------------     </span>
        <span class="keyword">const</span> int64_t &amp; lScale  = pMarket-&gt;<a class="code" href="class_o_t_market.html#aebe1f377a1c3a56d8dc0bb90168eea67">GetScale</a>();
        
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#a76e9d00702cfa1284813a1c45fc9d91b">scale</a>              = to_string&lt;int64_t&gt;(lScale);
        
        <span class="comment">// --------------------------------------------</span>
        
        <span class="keyword">const</span> uint64_t theCurrentBid    = pMarket-&gt;<a class="code" href="class_o_t_market.html#af56483f0c0166de3859bdc706c071531">GetHighestBidPrice</a>();
        <span class="keyword">const</span> uint64_t theCurrentAsk    = pMarket-&gt;<a class="code" href="class_o_t_market.html#a5580893d6510e601ca3ea48164485764">GetLowestAskPrice</a>();
        
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#a34e5138f9d4a2c77bfd646f4ecce6845">current_bid</a>        = to_string&lt;uint64_t&gt;(theCurrentBid);
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#aae01cd5fa908b576bc2309ff4bc28ff4">current_ask</a>        = to_string&lt;uint64_t&gt;(theCurrentAsk);
        
        <span class="comment">// ---------------------------------------------</span>
        
        <span class="keyword">const</span> int64_t &amp; lLastSalePrice          = pMarket-&gt;<a class="code" href="class_o_t_market.html#a4d5f6b5c240b331bc6d2984d5dce4150">GetLastSalePrice</a>();
        <span class="keyword">const</span> int64_t &amp; lTotalAvailableAssets   = pMarket-&gt;<a class="code" href="class_o_t_market.html#a2dd9eab76501e15105aca7a8f1ed7acd">GetTotalAvailableAssets</a>();
        
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#ae4136bf50fadeb1cc3e4230add9aca7c">total_assets</a>       = to_string&lt;int64_t&gt;(lTotalAvailableAssets);
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#a07d21103b5c195f9cb5b618a3eac88e7">last_sale_price</a>    = to_string&lt;int64_t&gt;(lLastSalePrice);
        
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#ae19de6144aae0681f53573888b8daf30">last_sale_date</a>     = pMarket-&gt;<a class="code" href="class_o_t_market.html#a489ad89157e72903d0d977ace2b25849">GetLastSaleDate</a>();

        <span class="comment">// ---------------------------------------------</span>
        
        <span class="keyword">const</span> mapOfOffers::size_type theBidCount = pMarket-&gt;<a class="code" href="class_o_t_market.html#ae5f15aabe47f37edad46b11c78a5440a">GetBidCount</a>();
        <span class="keyword">const</span> mapOfOffers::size_type theAskCount = pMarket-&gt;<a class="code" href="class_o_t_market.html#af38989995c44f5083df1acc5ab1c3557">GetAskCount</a>();
        
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#ab60c0a4fbf6fca65c9040a52b57054ea">number_bids</a>        = to_string&lt;mapOfOffers::size_type&gt;(theBidCount);
        pMarketData-&gt;<a class="code" href="class_o_t_d_b_1_1_market_data.html#afc912eddb01ab728e292c3bc88604467">number_asks</a>        = to_string&lt;mapOfOffers::size_type&gt;(theAskCount);

        <span class="comment">// ---------------------------------------------</span>
        <span class="comment">// In the past 24 hours.</span>
        <span class="comment">// (I&#39;m not collecting this data yet, (maybe never), so these values aren&#39;t set at all.)</span>
        <span class="comment">//</span>
<span class="comment">//      pMarketData-&gt;volume_trades      = ???;</span>
<span class="comment">//      pMarketData-&gt;volume_assets      = ???;</span>
<span class="comment">//      pMarketData-&gt;volume_currency    = ???;</span>
<span class="comment">//      </span>
<span class="comment">//      pMarketData-&gt;recent_highest_bid = ???;</span>
<span class="comment">//      pMarketData-&gt;recent_lowest_ask  = ???;</span>
        <span class="comment">// ---------------------------------------------</span>

        <span class="comment">// *pMarketData is CLONED at this time (I&#39;m still responsible to delete.)</span>
        <span class="comment">// That&#39;s also why I add it here, below: So the data is set right before the cloning occurs.</span>
        <span class="comment">//</span>
        pMarketList-&gt;AddMarketData(*pMarketData);
        nMarketCount++;
    }       
    
    <span class="comment">// -------------------------------------------------------------</span>
    
    <span class="comment">// Now pack the list into strOutput...</span>
    <span class="keywordflow">if</span> (0 == nMarketCount)
    {
        <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Success, but the list contains 0 markets.</span>
    }
    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nMarketCount &gt; 0)
    {
        <a class="code" href="class_o_t_d_b_1_1_storage.html">OTDB::Storage</a> * pStorage = <a class="code" href="namespace_o_t_d_b.html#acd05e317915b73ee26869659969dad02">OTDB::GetDefaultStorage</a>();
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pStorage);
        
        <a class="code" href="class_o_t_d_b_1_1_o_t_packer.html">OTDB::OTPacker</a> * pPacker = pStorage-&gt;<a class="code" href="class_o_t_d_b_1_1_storage.html#a693564a7129d4c08f739a398929e83c6">GetPacker</a>(); <span class="comment">// No need to check for failure, since this already ASSERTS. No need to cleanup either.</span>
            
        <span class="comment">// -----------------------------</span>
        
        <a class="code" href="class_o_t_d_b_1_1_packed_buffer.html">OTDB::PackedBuffer</a> * pBuffer = pPacker-&gt;<a class="code" href="class_o_t_d_b_1_1_o_t_packer.html#a67bd4a569fa37ffdcd0b0ae429b69fe1">Pack</a>(*pMarketList); <span class="comment">// Now we PACK our market list.</span>
        
        <span class="keywordflow">if</span> (NULL == pBuffer)
        {
            <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Failed packing pMarketList in OTCron::GetMarketList. \n&quot;</span>);
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
        
        <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTDB::PackedBuffer&gt;</a> theBufferAngel(*pBuffer); <span class="comment">// make sure memory is cleaned up.</span>
        
        <span class="comment">// -------------------------------------------------------- </span>
        
        <span class="comment">// Now we need to translate pBuffer into strOutput.</span>
        
        <span class="keyword">const</span> uint8_t* pUint = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>uint8_t*<span class="keyword">&gt;</span>(pBuffer-&gt;<a class="code" href="class_o_t_d_b_1_1_packed_buffer.html#a5fc68599bb27d14066abc0ada509e6b1">GetData</a>());
        <span class="keyword">const</span> <span class="keywordtype">size_t</span> theSize = pBuffer-&gt;<a class="code" href="class_o_t_d_b_1_1_packed_buffer.html#ac1528fc43c64e1268eca83065c9e0c29">GetSize</a>();
        
        <span class="keywordflow">if</span> ((theSize &gt; 0) &amp;&amp; (NULL != pUint))
        {
            <a class="code" href="class_o_t_data.html">OTData</a> theData(pUint, static_cast&lt;uint32_t&gt; (theSize));

            <span class="comment">// This function will base64 ENCODE theData,</span>
            <span class="comment">// and then Set() that as the string contents.</span>
            ascOutput.<a class="code" href="class_o_t_a_s_c_i_i_armor.html#a48e0e2e2eff86ad382a2cc63298a0b8b">SetData</a>(theData);
<span class="comment">//            bool bSuccessSetData = false;</span>
<span class="comment">//            bSuccessSetData = ascOutput.SetData(theData);</span>

            <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
        <span class="keywordflow">else</span> 
            <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;OTCron::GetMarketList: 0 size, or null return value, while getting raw data from packed buffer.\n&quot;</span>);
    }
    
    <span class="keywordflow">else</span>
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;OTCron::GetMarketList: nMarketCount is less than zero: %d.\n&quot;</span>, nMarketCount);      
        
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a22822e0aeced441b6404cd8a2c8e00da"></a><!-- doxytag: member="OTCron::GetNextTransactionNumber" ref="a22822e0aeced441b6404cd8a2c8e00da" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t <a class="el" href="class_o_t_cron.html#a22822e0aeced441b6404cd8a2c8e00da">OTCron::GetNextTransactionNumber</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00434">434</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (m_listTransactionNumbers.empty())
        <span class="keywordflow">return</span> 0;
    
    int64_t lTransactionNum = m_listTransactionNumbers.front();
    
    m_listTransactionNumbers.pop_front();
    
    <span class="keywordflow">return</span> lTransactionNum;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a581f68b86ff6f5ef1200e885a8f159f9"></a><!-- doxytag: member="OTCron::GetNym_OfferList" ref="a581f68b86ff6f5ef1200e885a8f159f9" args="(OTASCIIArmor &amp;ascOutput, const OTIdentifier &amp;NYM_ID, int32_t &amp;nOfferCount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#a581f68b86ff6f5ef1200e885a8f159f9">OTCron::GetNym_OfferList</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> &amp;&#160;</td>
          <td class="paramname"><em>ascOutput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>NYM_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t &amp;&#160;</td>
          <td class="paramname"><em>nOfferCount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00206">206</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    nOfferCount = 0; <span class="comment">// Outputs the number of offers on this nym.</span>
    
    
    <a class="code" href="class_o_t_d_b_1_1_offer_list_nym.html">OTDB::OfferListNym</a> * pOfferList  = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_o_t_d_b_1_1_offer_list_nym.html">OTDB::OfferListNym</a>*<span class="keyword">&gt;</span>(<a class="code" href="namespace_o_t_d_b.html#a67b35ca5812604fb3e1eae2b659f66ee">OTDB::CreateObject</a>(<a class="code" href="namespace_o_t_d_b.html#abce432e500285dde333e6f76f6fbde82a976d0f2d070c94e031644952c6fb78d4">OTDB::STORED_OBJ_OFFER_LIST_NYM</a>));
    <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTDB::OfferListNym&gt;</a> theListAngel(*pOfferList);
    
    
    <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_cron_8hpp.html#a59d4f7139328282aa9ee62a031844246">mapOfMarkets</a>, m_mapMarkets)
    {
        <a class="code" href="class_o_t_market.html">OTMarket</a> * pMarket = (*it).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pMarket);
        
        int32_t nNymOfferCount = 0;
        
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == pMarket-&gt;<a class="code" href="class_o_t_market.html#a5b14418890823e00d07549c513292cd1">GetNym_OfferList</a>(NYM_ID, *pOfferList, nNymOfferCount)) <span class="comment">// appends to *pOfferList, each iteration.</span>
        {
                <span class="comment">// may wish to add a log later. Anyway, keep iterationg and appending, then send back whatever we have.</span>
        }
        <span class="keywordflow">else</span> <span class="comment">// Success!</span>
            nOfferCount += nNymOfferCount;
    }       
    
    
    <span class="comment">// Now pack the list into strOutput...</span>
    <span class="keywordflow">if</span> (nOfferCount == 0)
        <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Success, but 0 offers being returned. (List is empty.)</span>
    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nOfferCount &gt; 0)
    {
        <a class="code" href="class_o_t_d_b_1_1_storage.html">OTDB::Storage</a> * pStorage = <a class="code" href="namespace_o_t_d_b.html#acd05e317915b73ee26869659969dad02">OTDB::GetDefaultStorage</a>();
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pStorage);
        
        <a class="code" href="class_o_t_d_b_1_1_o_t_packer.html">OTDB::OTPacker</a> * pPacker = pStorage-&gt;<a class="code" href="class_o_t_d_b_1_1_storage.html#a693564a7129d4c08f739a398929e83c6">GetPacker</a>(); <span class="comment">// No need to check for failure, since this already ASSERTS. No need to cleanup either.</span>
        
        
        <a class="code" href="class_o_t_d_b_1_1_packed_buffer.html">OTDB::PackedBuffer</a> * pBuffer = pPacker-&gt;<a class="code" href="class_o_t_d_b_1_1_o_t_packer.html#a67bd4a569fa37ffdcd0b0ae429b69fe1">Pack</a>(*pOfferList); <span class="comment">// Now we PACK our nym&#39;s offer list.</span>
        
        <span class="keywordflow">if</span> (NULL == pBuffer)
        {
            <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Failed packing pOfferList in OTCron::GetNym_OfferList. \n&quot;</span>);
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }
        
        <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTDB::PackedBuffer&gt;</a> theBufferAngel(*pBuffer); <span class="comment">// make sure memory is cleaned up.</span>
        
        
        <span class="comment">// Now we need to translate pBuffer into strOutput.</span>
        
        <span class="keyword">const</span> uint8_t* pUint = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>uint8_t*<span class="keyword">&gt;</span>(pBuffer-&gt;<a class="code" href="class_o_t_d_b_1_1_packed_buffer.html#a5fc68599bb27d14066abc0ada509e6b1">GetData</a>());
        <span class="keyword">const</span> <span class="keywordtype">size_t</span> theSize = pBuffer-&gt;<a class="code" href="class_o_t_d_b_1_1_packed_buffer.html#ac1528fc43c64e1268eca83065c9e0c29">GetSize</a>();
        
        <span class="keywordflow">if</span> ((NULL != pUint) || (theSize &lt; 2))
        {
            <a class="code" href="class_o_t_data.html">OTData</a> theData(pUint, static_cast&lt;uint32_t&gt; (theSize));
            
            <span class="comment">// This function will base64 ENCODE theData,</span>
            <span class="comment">// and then Set() that as the string contents.</span>
            ascOutput.<a class="code" href="class_o_t_a_s_c_i_i_armor.html#a48e0e2e2eff86ad382a2cc63298a0b8b">SetData</a>(theData);
            
            <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }
        <span class="keywordflow">else</span> 
            <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Null returned, or bad size, while getting buffer data in OTCron::GetNym_OfferList.\n&quot;</span>);
    }
    
    <span class="keywordflow">else</span>
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;Error: Less-than-zero nOfferCount in OTCron::GetNym_OfferList: %d.\n&quot;</span>, nOfferCount); 
    
    <span class="keywordflow">return</span> <span class="keyword">false</span>;   
}
</pre></div>
</div>
</div>
<a class="anchor" id="af4fa1a950a600220ac5e570b58e892ff"></a><!-- doxytag: member="OTCron::GetOrCreateMarket" ref="af4fa1a950a600220ac5e570b58e892ff" args="(const OTIdentifier &amp;ASSET_ID, const OTIdentifier &amp;CURRENCY_ID, const int64_t &amp;lScale)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_market.html">OTMarket</a> * <a class="el" href="class_o_t_cron.html#af4fa1a950a600220ac5e570b58e892ff">OTCron::GetOrCreateMarket</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>ASSET_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>CURRENCY_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t &amp;&#160;</td>
          <td class="paramname"><em>lScale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01135">1135</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{   
    <a class="code" href="class_o_t_market.html">OTMarket</a> * pMarket = <span class="keyword">new</span> <a class="code" href="class_o_t_market.html">OTMarket</a>(<a class="code" href="class_o_t_cron.html#a93b52f56c0de94e53bb05a610830ba4b">GetServerID</a>(), ASSET_ID, CURRENCY_ID, lScale);
    
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pMarket);
    
    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> MARKET_ID(*pMarket);
    
    <a class="code" href="class_o_t_market.html">OTMarket</a> * pExistingMarket = <a class="code" href="class_o_t_cron.html#afcc38ab744f5e3710982c600c4412cf2">GetMarket</a>(MARKET_ID);
    
    <span class="comment">// If it was already there, there&#39;s no need to create it.</span>
    <span class="keywordflow">if</span> (NULL != pExistingMarket)
    {
        <span class="keyword">delete</span> pMarket; pMarket = NULL;
        <span class="keywordflow">return</span> pExistingMarket;
    }
    
    <span class="comment">// If we got this far, it means the Market does NOT already exist in this Cron.</span>
    <span class="comment">// So let&#39;s add it...</span>
    <span class="keywordtype">bool</span> bAdded = <a class="code" href="class_o_t_cron.html#a140c03fce539cd99e61e2b5baed85f76">AddMarket</a>(*pMarket, <span class="keyword">true</span>); <span class="comment">// bool bSaveMarketFile=true, since it was created new.</span>

    <span class="keywordflow">if</span> (bAdded)
    {
        <a class="code" href="class_o_t_log.html#a1f7549d776ee919dcb6517f611ded015">OTLog::Output</a>(0, <span class="stringliteral">&quot;New market created and added to Cron.\n&quot;</span>);
    }
    <span class="keywordflow">else</span> 
    {
        <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Error trying to add new market to Cron.\n&quot;</span>);
        <span class="keyword">delete</span> pMarket;
        pMarket = NULL;
    }
    
    <span class="keywordflow">return</span> pMarket;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a93b52f56c0de94e53bb05a610830ba4b"></a><!-- doxytag: member="OTCron::GetServerID" ref="a93b52f56c0de94e53bb05a610830ba4b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a>&amp; <a class="el" href="class_o_t_cron.html#a93b52f56c0de94e53bb05a610830ba4b">OTCron::GetServerID</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00251">251</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> m_SERVER_ID; }
</pre></div>
</div>
</div>
<a class="anchor" id="a7756d0dcc047209ca87632939dc11db3"></a><!-- doxytag: member="OTCron::GetServerNym" ref="a7756d0dcc047209ca87632939dc11db3" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a>* <a class="el" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">OTCron::GetServerNym</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00254">254</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> m_pServerNym; }
</pre></div>
</div>
</div>
<a class="anchor" id="ae241ecf6802b59ccde653082f098e80c"></a><!-- doxytag: member="OTCron::GetTransactionCount" ref="ae241ecf6802b59ccde653082f098e80c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t <a class="el" href="class_o_t_cron.html#ae241ecf6802b59ccde653082f098e80c">OTCron::GetTransactionCount</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00417">417</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (m_listTransactionNumbers.empty())
        <span class="keywordflow">return</span> 0;

    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span> (m_listTransactionNumbers.size());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a77c951666003558d04a02228bd2d2ff7"></a><!-- doxytag: member="OTCron::InitCron" ref="a77c951666003558d04a02228bd2d2ff7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_cron.html#a77c951666003558d04a02228bd2d2ff7">OTCron::InitCron</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01242">1242</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_contract.html#ac523dac7d72b72e54b1ebb5b3a3b21cc">m_strContractType</a> = <span class="stringliteral">&quot;CRON&quot;</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1f1795c385d987bd098e1c636f4a08ce"></a><!-- doxytag: member="OTCron::IsActivated" ref="a1f1795c385d987bd098e1c636f4a08ce" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#a1f1795c385d987bd098e1c636f4a08ce">OTCron::IsActivated</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00198">198</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> m_bIsActivated; }
</pre></div>
</div>
</div>
<a class="anchor" id="a6ad24d6d2669343157613f0efa017312"></a><!-- doxytag: member="OTCron::LoadCron" ref="a6ad24d6d2669343157613f0efa017312" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#a6ad24d6d2669343157613f0efa017312">OTCron::LoadCron</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00162">162</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFoldername   = <a class="code" href="class_o_t_folders.html#aabb5605423422af18b156b9cd5e48c22">OTFolders::Cron</a>().<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFilename     = <span class="stringliteral">&quot;OT-CRON.crn&quot;</span>; <span class="comment">// todo stop hardcoding filenames.</span>
    
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != <a class="code" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a>());

    
    <span class="keywordtype">bool</span> bSuccess = <span class="keyword">false</span>;

    bSuccess = <a class="code" href="class_o_t_contract.html#a1432a5e924d021a9dc39320d3b8e7b90">LoadContract</a>(szFoldername, szFilename);
        
    <span class="keywordflow">if</span> (bSuccess)
        bSuccess = <a class="code" href="class_o_t_contract.html#a38f51d593b6dfc8a75d1c5a535965392">VerifySignature</a>(*(<a class="code" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a>()));
    
    <span class="keywordflow">return</span> bSuccess;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1a8bdc614a109ccecf9712531ba9cf14"></a><!-- doxytag: member="OTCron::ProcessCronItems" ref="a1a8bdc614a109ccecf9712531ba9cf14" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_cron.html#a1a8bdc614a109ccecf9712531ba9cf14">OTCron::ProcessCronItems</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00661">661</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// ----------------------------------------------------------</span>
    <span class="keywordflow">if</span> (!m_bIsActivated)
    {
        <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;OTCron::ProcessCronItems: Not activated yet. (Skipping.)\n&quot;</span>);
        <span class="keywordflow">return</span>; <span class="comment">// No Cron processing until Cron is activated.</span>
    }
    <span class="comment">// ----------------------------------------------------------</span>
    <span class="keyword">static</span> <span class="keyword">const</span> int64_t lMsBetweenCronBeats = <a class="code" href="class_o_t_cron.html#af81a76731bdaa2d9d32df8c02ec0739d">OTCron::GetCronMsBetweenProcess</a>(); <span class="comment">// Default: 10 seconds aka 10000</span>
    <span class="comment">// ----------------------------------------------------------</span>
    <span class="comment">// CRON RUNS ON A TIMER...</span>
    <span class="keyword">static</span>  <a class="code" href="class_timer.html">Timer</a>   tCron(<span class="keyword">true</span>);    <span class="comment">// bStart=true.</span>
    <span class="keyword">static</span>  <span class="keywordtype">double</span>  cron_tick1      = tCron.getElapsedTimeInMilliSec(); <span class="comment">// This initially occurs the first time function is called.</span>
            <span class="keywordtype">double</span>  cron_tick2      = tCron.getElapsedTimeInMilliSec(); <span class="comment">// This occurs EVERY time this function is called.</span>
    <span class="keyword">const</span>   int64_t cron_elapsed    = <span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(cron_tick2 - cron_tick1);    <span class="comment">// This calculates every time this function is called.</span>
    <span class="comment">// ----------------------------------------------------------</span>
    <span class="comment">// If it&#39;s been at least ten seconds...</span>
    <span class="comment">//</span>
    <span class="keywordflow">if</span> (cron_elapsed &gt; lMsBetweenCronBeats)
        <span class="comment">// Reset the timer -- we&#39;re executing!</span>
        cron_tick1  = tCron.getElapsedTimeInMilliSec(); <span class="comment">// cron_tick1 only changes here, every X ms.</span>
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span>; <span class="comment">// (it&#39;s not our time yet.)</span>
    <span class="comment">// ----------------------------------------------------------</span>
    <span class="keyword">const</span> int32_t nTwentyPercent = <a class="code" href="class_o_t_cron.html#a6e1ade4402e6db7aad96b8b2177be9d9">OTCron::GetCronRefillAmount</a>() / 5;
    <span class="keywordflow">if</span> (<a class="code" href="class_o_t_cron.html#ae241ecf6802b59ccde653082f098e80c">GetTransactionCount</a>() &lt;= nTwentyPercent)
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;WARNING: Cron has fewer than 20 percent of its normal transaction number count available since the previous round! \n&quot;</span>
                     <span class="stringliteral">&quot;That is, %d are currently available, with a max of %d, meaning %d were used in the last round alone!!! \n&quot;</span>
                     <span class="stringliteral">&quot;SKIPPING THE CRON ITEMS THAT WERE SCHEDULED FOR THIS ROUND!!!\n\n&quot;</span>, <a class="code" href="class_o_t_cron.html#ae241ecf6802b59ccde653082f098e80c">GetTransactionCount</a>(), 
                      <a class="code" href="class_o_t_cron.html#a6e1ade4402e6db7aad96b8b2177be9d9">OTCron::GetCronRefillAmount</a>(), <a class="code" href="class_o_t_cron.html#a6e1ade4402e6db7aad96b8b2177be9d9">OTCron::GetCronRefillAmount</a>() - <a class="code" href="class_o_t_cron.html#ae241ecf6802b59ccde653082f098e80c">GetTransactionCount</a>());
        <span class="keywordflow">return</span>;
    }
    <span class="comment">// ----------------------------------------------------------</span>
    <span class="keywordtype">bool</span> bNeedToSave = <span class="keyword">false</span>;
    
    <span class="comment">// loop through the cron items and tell each one to ProcessCron().</span>
    <span class="comment">// If the item returns true, that means leave it on the list. Otherwise,</span>
    <span class="comment">// if it returns false, that means &quot;it&#39;s done: remove it.&quot;</span>

    <span class="keywordflow">for</span> (multimapOfCronItems::iterator          <span class="comment">// Iterating through the multimap means we process the cronitems</span>
            it  = m_multimapCronItems.begin();  <span class="comment">// in the same order that they were originally added to Cron.</span>
            it != m_multimapCronItems.end();    <span class="comment">// (This is necessary for market orders to process properly.)</span>
         <span class="comment">/* NOTICE THIS THIRD SPOT IS EMPTY*/</span>
        )
<span class="comment">//  FOR_EACH(multimapOfCronItems, m_multimapCronItems)</span>
    {
        <span class="keyword">const</span> int32_t nTwentyPercent2 = <a class="code" href="class_o_t_cron.html#a6e1ade4402e6db7aad96b8b2177be9d9">OTCron::GetCronRefillAmount</a>() / 5;
        <span class="comment">// ----------------------------------------------------------</span>
        <span class="keywordflow">if</span> (<a class="code" href="class_o_t_cron.html#ae241ecf6802b59ccde653082f098e80c">GetTransactionCount</a>() &lt;= nTwentyPercent2)
        {
            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;WARNING: Cron has fewer than 20 percent of its normal transaction &quot;</span>
                          <span class="stringliteral">&quot;number count available since the previous cron item alone! \n&quot;</span>
                          <span class="stringliteral">&quot;That is, %d are currently available, with a max of %d, meaning %d &quot;</span>
                          <span class="stringliteral">&quot;were used in the current round alone!!! \n&quot;</span>
                          <span class="stringliteral">&quot;SKIPPING THE REMAINDER OF THE CRON ITEMS THAT WERE SCHEDULED FOR THIS ROUND!!!\n\n&quot;</span>,
                          <a class="code" href="class_o_t_cron.html#ae241ecf6802b59ccde653082f098e80c">GetTransactionCount</a>(),
                          <a class="code" href="class_o_t_cron.html#a6e1ade4402e6db7aad96b8b2177be9d9">OTCron::GetCronRefillAmount</a>(), <a class="code" href="class_o_t_cron.html#a6e1ade4402e6db7aad96b8b2177be9d9">OTCron::GetCronRefillAmount</a>() - <a class="code" href="class_o_t_cron.html#ae241ecf6802b59ccde653082f098e80c">GetTransactionCount</a>());
            <span class="keywordflow">break</span>;
        }
        <span class="comment">// ----------------------------------------------------------</span>
        <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = (*it).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pItem);
        
        <span class="keywordtype">bool</span> bProcessCron   = <span class="keyword">false</span>;
        <span class="comment">// ----------------------------------------------------------</span>
        <span class="comment">//  We already verify and sign the cron item when FIRST ADDING it to Cron.</span>
        <span class="comment">//  We also verify the signature on the cron item whenever loading it up</span>
        <span class="comment">//  from storage.</span>
        <span class="comment">//  THEREFORE, FOR NOW, I&#39;VE DECIDED THAT VERIFYING THE SIGNATURE AGAIN </span>
        <span class="comment">//  (HERE) IS OVERKILL, SO IT&#39;s COMMENTED OUT.</span>
        <span class="comment">//</span>
<span class="comment">//      bool bVerifySig = pItem-&gt;VerifySignature(*m_pServerNym);</span>
<span class="comment">//      if (bVerifySig)</span>
        {
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(2, <span class="stringliteral">&quot;OTCron::%s: Processing item number: %lld \n&quot;</span>,
                           __FUNCTION__, pItem-&gt;<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>());
            
            bProcessCron = pItem-&gt;<a class="code" href="class_o_t_cron_item.html#afe5c6a9af86b637fd8b2b3459825565b">ProcessCron</a>();
            
            <span class="comment">// false means &quot;remove it&quot;.</span>
            <span class="comment">// ProcessCron returns true if should stay on the list.</span>
            <span class="comment">//</span>
            <span class="keywordflow">if</span> (<span class="keyword">false</span> == bProcessCron)
                pItem-&gt;<a class="code" href="class_o_t_cron_item.html#a70fe4a9257f50547dc62b4f553b05f2d">HookRemovalFromCron</a>(NULL); <span class="comment">// We give the hook a chance to do its thing.</span>
        }
<span class="comment">//      else</span>
<span class="comment">//          OTLog::Error(&quot;OTCron::ProcessCronItems: Signature failed to verify on cron item!\n&quot;);</span>
        <span class="comment">// -----------------------------------------------------</span>
        <span class="comment">// Remove it from the list.</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (<span class="keyword">false</span> == bProcessCron)
        {
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;OTCron::%s: Removing cron item: %lld\n&quot;</span>,
                           __FUNCTION__, pItem-&gt;<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>());
            <span class="comment">// -------------------------------</span>
            <span class="comment">// Remove from MultiMap</span>
            <span class="comment">//</span>
            multimapOfCronItems::iterator it_delete = it;
            ++it;
            m_multimapCronItems.erase(it_delete);
            <span class="comment">// -------------------------------</span>
            <span class="comment">// Remove from Map</span>
            <span class="comment">//</span>
            mapOfCronItems::iterator it_map = this-&gt;<a class="code" href="class_o_t_cron.html#aedcabce992fbabf7737fcbd9ae89b1d6">FindItemOnMap</a>(pItem-&gt;<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>());
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(m_mapCronItems.end() != it_map); <span class="comment">// If it&#39;s on the multimap, then it should also ALWAYS be on the map.</span>
            m_mapCronItems.erase(it_map);
            <span class="comment">// -------------------------------</span>
            <span class="keyword">delete</span> pItem;
            pItem = NULL;
            <span class="comment">// -------------------------------</span>
            bNeedToSave = <span class="keyword">true</span>; <span class="comment">// We&#39;ll save to file at the bottom if anything was removed.</span>
        } 
        <span class="keywordflow">else</span>    <span class="comment">// the special i++ and ++i arrangement here allows me to erase an item</span>
        {       <span class="comment">// from the list WHILE iterating through it  :-)   (Supposedly.)</span>
            ++it;
        }
    } <span class="comment">// for</span>
    <span class="comment">// ----------------------------------------------------------</span>
    <span class="comment">// Items were removed from Cron -- Save to storage!</span>
    <span class="keywordflow">if</span> (bNeedToSave)
        <a class="code" href="class_o_t_cron.html#a24df32b4bf36e48867e7afda0955bb72">SaveCron</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a004071b22676a0419f1b6de519f00b78"></a><!-- doxytag: member="OTCron::ProcessXMLNode" ref="a004071b22676a0419f1b6de519f00b78" args="(irr::io::IrrXMLReader *&amp;xml)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t <a class="el" href="class_o_t_cron.html#a004071b22676a0419f1b6de519f00b78">OTCron::ProcessXMLNode</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceirr_1_1io.html#a1628edbb9d5d53f18c82d2a92b0ad27e">irr::io::IrrXMLReader</a> *&amp;&#160;</td>
          <td class="paramname"><em>xml</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_contract.html#a48611c37c8e8e7d9125238bda2b77978">OTContract</a>.</p>

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00448">448</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != <a class="code" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a>());
    
    int32_t nReturnVal = 0;
    
    <span class="comment">// Here we call the parent class first.</span>
    <span class="comment">// If the node is found there, or there is some error,</span>
    <span class="comment">// then we just return either way.  But if it comes back</span>
    <span class="comment">// as &#39;0&#39;, then nothing happened, and we&#39;ll continue executing.</span>
    <span class="comment">//</span>
    <span class="comment">// -- Note you can choose not to call the parent if</span>
    <span class="comment">// you don&#39;t want to use any of those xml tags.</span>
    <span class="comment">// As I do below, in the case of OTAccount.</span>
    <span class="comment">//if (nReturnVal = OTContract::ProcessXMLNode(xml))</span>
    <span class="comment">//  return nReturnVal;</span>
    
    
    <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;cron&quot;</span>, xml-&gt;getNodeName())) 
    {       
        <a class="code" href="class_o_t_contract.html#aa0d889e0e1670b56fedca245041a5ed3">m_strVersion</a> = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;version&quot;</span>);
        <span class="comment">// ---------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>  strServerID(xml-&gt;getAttributeValue(<span class="stringliteral">&quot;serverID&quot;</span>));
        
        m_SERVER_ID.<a class="code" href="class_o_t_identifier.html#ae29aa1245d3831a207aabc9b8a493bfc">SetString</a>(strServerID);
        <span class="comment">// ---------------------</span>
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;\n\nLoading OTCron for ServerID: %s\n&quot;</span>, 
                       strServerID.Get());
                
        nReturnVal = 1;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;transactionNum&quot;</span>, xml-&gt;getNodeName()))
    {
        <span class="keyword">const</span> int64_t lTransactionNum = atol(xml-&gt;getAttributeValue(<span class="stringliteral">&quot;value&quot;</span>));
        
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;Transaction Number %lld available for Cron.\n&quot;</span>,
                       lTransactionNum);
        
        <a class="code" href="class_o_t_cron.html#aad85faf2146cea516d7a5f169904485d">AddTransactionNumber</a>(lTransactionNum); <span class="comment">// This doesn&#39;t save to disk. Make sure to save Cron when it changes.</span>

        nReturnVal = 1;
    }   
    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;cronItem&quot;</span>, xml-&gt;getNodeName())) 
    {
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    str_date_added = xml-&gt;getAttributeValue(<span class="stringliteral">&quot;dateAdded&quot;</span>);
        <span class="keyword">const</span> int64_t     lDateAdded     = (!str_date_added.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>() ? 0 : str_date_added.<a class="code" href="class_o_t_string.html#a18ca8f42f6e90ab7801c019611d9dca8">ToLong</a>());
        <span class="keyword">const</span> <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>      tDateAdded = <a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(lDateAdded);
        <span class="comment">// ------------------------------------</span>
        <a class="code" href="class_o_t_string.html">OTString</a> strData;
        
        <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#a72ffe11fdcf2f6e3566afa9061241f30">OTContract::LoadEncodedTextField</a>(xml, strData) || !strData.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
        {
            <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Error in OTCron::ProcessXMLNode: cronItem field without value.\n&quot;</span>);
            <span class="keywordflow">return</span> (-1); <span class="comment">// error condition</span>
        }
        <span class="keywordflow">else</span> 
        {
            <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = <a class="code" href="class_o_t_cron_item.html#ad448bfdee05f5a1086d19d9edb2e2518">OTCronItem::NewCronItem</a>(strData);
            
            <span class="keywordflow">if</span> (NULL == pItem)
            {
                <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Unable to create cron item from data in cron file.\n&quot;</span>);
                <span class="keywordflow">return</span> (-1);
            }
            <span class="comment">// -------------------------------------------</span>
            
            <span class="comment">// Why not do this here (when loading from storage), as well as when first adding the item to cron,</span>
            <span class="comment">// and thus save myself the trouble of verifying the signature EVERY ITERATION of ProcessCron().</span>
            <span class="comment">//</span>
            <span class="keywordflow">if</span> (<span class="keyword">false</span> == pItem-&gt;<a class="code" href="class_o_t_contract.html#a38f51d593b6dfc8a75d1c5a535965392">VerifySignature</a>(*m_pServerNym))
            {
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;OTCron::ProcessXMLNode: ERROR SECURITY: Server signature failed to &quot;</span>
                              <span class="stringliteral">&quot;verify on a cron item while loading: %lld\n&quot;</span>, pItem-&gt;<a class="code" href="class_o_t_trackable.html#a2594d320e3b24f3210bd38a08de66a70">GetTransactionNum</a>());
                <span class="keyword">delete</span> pItem;
                pItem = NULL;
                <span class="keywordflow">return</span> (-1);
            }
            <span class="comment">// -------------------------------------------              </span>
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_o_t_cron.html#a2d42c183c174f56a7c7c3da1e844a53f">AddCronItem</a>(*pItem,
                                 NULL,
                                 <span class="keyword">false</span>, <span class="comment">// bSaveReceipt=false. The receipt is only saved once: When item FIRST added to cron...</span>
                                 tDateAdded))
            {   <span class="comment">// ...But here, the item was ALREADY in cron, and is merely being loaded from disk.</span>
                <span class="comment">// Thus, it would be wrong to try to create the &quot;original record&quot; as if it were brand</span>
                <span class="comment">// new and still had the user&#39;s signature on it. (Once added to Cron, the signatures are</span>
                <span class="comment">// released and the SERVER signs it from there. That&#39;s why the user&#39;s version is saved</span>
                <span class="comment">// as a receipt in the first place -- so we have a record of the user&#39;s authorization.)</span>
                <a class="code" href="class_o_t_log.html#a1f7549d776ee919dcb6517f611ded015">OTLog::Output</a>(2, <span class="stringliteral">&quot;Successfully loaded cron item and added to list.\n&quot;</span>);
            }
            <span class="keywordflow">else</span> 
            {
                <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;OTCron::ProcessXMLNode: Though loaded / verified successfully, &quot;</span>
                             <span class="stringliteral">&quot;unable to add cron item (from cron file) to cron list.\n&quot;</span>);
                <span class="keyword">delete</span> pItem;
                pItem = NULL;
                <span class="keywordflow">return</span> (-1);
            }
        }
        
        nReturnVal = 1;
    }
    
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;market&quot;</span>, xml-&gt;getNodeName()))
    {
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>  strMarketID(xml-&gt;getAttributeValue(<span class="stringliteral">&quot;marketID&quot;</span>));
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>  strAssetID(xml-&gt;getAttributeValue(<span class="stringliteral">&quot;assetID&quot;</span>));
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>  strCurrencyID(xml-&gt;getAttributeValue(<span class="stringliteral">&quot;currencyID&quot;</span>));
        
        <span class="keyword">const</span> int64_t       lScale = atol(xml-&gt;getAttributeValue(<span class="stringliteral">&quot;marketScale&quot;</span>));
        
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>  ASSET_ID(strAssetID), CURRENCY_ID(strCurrencyID);
        
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;Loaded cron entry for Market:\n%s.\n&quot;</span>, strMarketID.Get());
        
        <span class="comment">// LoadMarket() needs this info to do its thing.</span>
        <a class="code" href="class_o_t_market.html">OTMarket</a> * pMarket = <span class="keyword">new</span> <a class="code" href="class_o_t_market.html">OTMarket</a>(m_SERVER_ID, ASSET_ID, CURRENCY_ID, lScale);
        
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pMarket);
        
        pMarket-&gt;SetCronPointer(*<span class="keyword">this</span>); <span class="comment">// This way every Market has a pointer to Cron.</span>

        <span class="comment">//  AddMarket normally saves to file, but we don&#39;t want that when we&#39;re LOADING from file, now do we?</span>
        <span class="keywordflow">if</span> (!pMarket-&gt;LoadMarket() ||
            !pMarket-&gt;VerifySignature(*<a class="code" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a>()) ||
            !<a class="code" href="class_o_t_cron.html#a140c03fce539cd99e61e2b5baed85f76">AddMarket</a>(*pMarket, <span class="keyword">false</span>)) <span class="comment">// bSaveFile=false: don&#39;t save this file WHILE loading it!!! </span>
        {
            <a class="code" href="class_o_t_log.html#a5acd90ac91c2618f395b0ff37ad4f8ee">OTLog::Error</a>(<span class="stringliteral">&quot;Somehow error while loading, verifying, or adding market while loading Cron file.\n&quot;</span>);
            <span class="keyword">delete</span> pMarket; pMarket = NULL;
            <span class="keywordflow">return</span> (-1);
        }
        <span class="keywordflow">else</span> 
        {
            <a class="code" href="class_o_t_log.html#a1f7549d776ee919dcb6517f611ded015">OTLog::Output</a>(1, <span class="stringliteral">&quot;Loaded market entry from cronfile, and also loaded the market file itself.\n&quot;</span>);
        }
        nReturnVal = 1;
    }
    
    <span class="keywordflow">return</span> nReturnVal;  
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7ec2571d52ceaab093afe06f7746c08b"></a><!-- doxytag: member="OTCron::Release" ref="a7ec2571d52ceaab093afe06f7746c08b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_cron.html#a7ec2571d52ceaab093afe06f7746c08b">OTCron::Release</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_contract.html#a15e423ca0d650858a23e54f8285feae1">OTContract</a>.</p>

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01248">1248</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_cron.html#aa1cf58f86207ccdd857ae16ef2488f8f">Release_Cron</a>();
    <span class="comment">// ------------------ </span>
    <a class="code" href="class_o_t_contract.html#a15e423ca0d650858a23e54f8285feae1">ot_super::Release</a>();
    <span class="comment">// ------------------ </span>
    <span class="comment">// Then I call this to re-initialize everything for myself.</span>
    <span class="comment">//</span>
<span class="comment">//  InitCron();         </span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa1cf58f86207ccdd857ae16ef2488f8f"></a><!-- doxytag: member="OTCron::Release_Cron" ref="aa1cf58f86207ccdd857ae16ef2488f8f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_cron.html#aa1cf58f86207ccdd857ae16ef2488f8f">OTCron::Release_Cron</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01260">1260</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// If there were any dynamically allocated objects, clean them up here.</span>
    <span class="comment">// --------------------------------------------</span>
    <span class="keywordflow">while</span> (!m_multimapCronItems.empty())
    {
        multimapOfCronItems::iterator ii = m_multimapCronItems.begin();
        m_multimapCronItems.erase(ii);
        
        <span class="comment">// We don&#39;t delete the pItem in here, since these are the</span>
        <span class="comment">// same pItems being deleted in the next block.</span>
    }
    <span class="comment">// --------------------------------------------</span>
    <span class="keywordflow">while</span> (!m_mapCronItems.empty())
    {
        <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = m_mapCronItems.begin()-&gt;second;
        mapOfCronItems::iterator ii = m_mapCronItems.begin();
        m_mapCronItems.erase(ii);
        <span class="keyword">delete</span> pItem;
        pItem = NULL;
    }
    <span class="comment">// --------------------------------------------</span>
    <span class="keywordflow">while</span> (!m_mapMarkets.empty())
    {
        <a class="code" href="class_o_t_market.html">OTMarket</a> * pMarket = m_mapMarkets.begin()-&gt;second;
        mapOfMarkets::iterator ii = m_mapMarkets.begin();
        m_mapMarkets.erase(ii);
        <span class="keyword">delete</span> pMarket;
        pMarket = NULL;     
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8db968a79df5cee7258c4c08ba07973b"></a><!-- doxytag: member="OTCron::RemoveCronItem" ref="a8db968a79df5cee7258c4c08ba07973b" args="(int64_t lTransactionNum, OTPseudonym &amp;theRemover)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#a8db968a79df5cee7258c4c08ba07973b">OTCron::RemoveCronItem</a> </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>lTransactionNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> &amp;&#160;</td>
          <td class="paramname"><em>theRemover</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00877">877</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// See if there&#39;s a cron item with that transaction number.</span>
    mapOfCronItems::iterator it_map = this-&gt;<a class="code" href="class_o_t_cron.html#aedcabce992fbabf7737fcbd9ae89b1d6">FindItemOnMap</a>(lTransactionNum);
    <span class="comment">// ---------------------------------------------------------------------</span>
    <span class="comment">// If it&#39;s not already on the list, then there&#39;s nothing to remove.</span>
    <span class="keywordflow">if</span> ( m_mapCronItems.end() == it_map )
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Attempt to remove non-existent CronItem from OTCron. Transaction #: %lld\n&quot;</span>,
                      __FUNCTION__, lTransactionNum);
    }
    <span class="comment">// ---------------------------------------------------------------------</span>
    <span class="comment">// Otherwise, if it WAS already there, remove it properly.</span>
    <span class="keywordflow">else</span> 
    {
        <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = (*it_map).second;
<span class="comment">//      OT_ASSERT(NULL != pItem); // Already done in FindItemOnMap.</span>
        <span class="comment">// ---------------------------------------</span>
        <span class="comment">// We have to remove it from the multimap as well.</span>
        multimapOfCronItems::iterator it_multimap = this-&gt;<a class="code" href="class_o_t_cron.html#ab412c2adb3f43e26df041737f854dde1">FindItemOnMultimap</a>(lTransactionNum);
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(m_multimapCronItems.end() != it_multimap); <span class="comment">// If found on map, MUST be on multimap also.</span>
        <span class="comment">// ---------------------------------------</span>
        pItem-&gt;<a class="code" href="class_o_t_cron_item.html#a70fe4a9257f50547dc62b4f553b05f2d">HookRemovalFromCron</a>(&amp;theRemover); <span class="comment">// We give the hook a chance to do its thing.</span>
        <span class="comment">// ---------------------------------------</span>
        m_mapCronItems     .erase(it_map);      <span class="comment">// Remove from MAP.</span>
        m_multimapCronItems.erase(it_multimap); <span class="comment">// Remove from MULTIMAP.</span>
        <span class="comment">// ---------------------------------------</span>
        <span class="keyword">delete</span> pItem;
        <span class="comment">// ---------------------------------------</span>
        <span class="comment">// An item has been removed from Cron. SAVE.</span>
        <span class="keywordflow">return</span> <a class="code" href="class_o_t_cron.html#a24df32b4bf36e48867e7afda0955bb72">SaveCron</a>();
    }
    <span class="comment">// ---------------------------------------</span>
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3ef869ba62f1f9bf651ec48fe3fa2df0"></a><!-- doxytag: member="OTCron::RemoveMarket" ref="a3ef869ba62f1f9bf651ec48fe3fa2df0" args="(const OTIdentifier &amp;MARKET_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#a3ef869ba62f1f9bf651ec48fe3fa2df0">OTCron::RemoveMarket</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>MARKET_ID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01103">1103</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_string.html">OTString</a>        str_MARKET_ID(MARKET_ID);
    std::string     std_MARKET_ID = str_MARKET_ID.Get();
    
    <span class="comment">// See if there&#39;s something there with that transaction number.</span>
    mapOfMarkets::iterator ii = m_mapMarkets.find(std_MARKET_ID);
    
    <span class="comment">// If it&#39;s not already on the list, then there&#39;s nothing to remove.</span>
    <span class="keywordflow">if</span> ( ii == m_mapMarkets.end() )
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;Attempt to remove non-existent Market from OTCron:\n%s\n&quot;</span>,
                      std_MARKET_ID.c_str());
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// Otherwise, if it WAS already there, remove it properly.</span>
    <span class="keywordflow">else</span> 
    {
        <a class="code" href="class_o_t_market.html">OTMarket</a> * pMarket = (*ii).second;
        
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pMarket);
        
        m_mapMarkets.erase(ii);
        <span class="keyword">delete</span> pMarket;
        
        <span class="comment">// A market has been removed from Cron. SAVE.       </span>
        <span class="keywordflow">return</span> <a class="code" href="class_o_t_cron.html#a24df32b4bf36e48867e7afda0955bb72">SaveCron</a>();      
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa40e13f9fa75869b77e57de7b88c21b9"></a><!-- doxytag: member="OTCron::SaveContractWallet" ref="aa40e13f9fa75869b77e57de7b88c21b9" args="(std::ofstream &amp;ofs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#aa40e13f9fa75869b77e57de7b88c21b9">OTCron::SaveContractWallet</a> </td>
          <td>(</td>
          <td class="paramtype">std::ofstream &amp;&#160;</td>
          <td class="paramname"><em>ofs</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="class_o_t_contract.html#af16a41ce18a9e3408fc5c9ee18315a30">OTContract</a>.</p>

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l01293">1293</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a24df32b4bf36e48867e7afda0955bb72"></a><!-- doxytag: member="OTCron::SaveCron" ref="a24df32b4bf36e48867e7afda0955bb72" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_cron.html#a24df32b4bf36e48867e7afda0955bb72">OTCron::SaveCron</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00181">181</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFoldername   = <a class="code" href="class_o_t_folders.html#aabb5605423422af18b156b9cd5e48c22">OTFolders::Cron</a>().<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
    <span class="keyword">const</span> <span class="keywordtype">char</span> * szFilename     = <span class="stringliteral">&quot;OT-CRON.crn&quot;</span>; <span class="comment">// todo stop hardcoding filenames.</span>
    
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != <a class="code" href="class_o_t_cron.html#a7756d0dcc047209ca87632939dc11db3">GetServerNym</a>());
    
    
    <a class="code" href="class_o_t_contract.html#aae54340526fbd8eb8a18de27a4b97c83">ReleaseSignatures</a>();

    <span class="comment">// Sign it, save it internally to string, and then save that out to the file.</span>
    <span class="keywordflow">if</span> (!<a class="code" href="class_o_t_contract.html#abd60037fe655ee8cae9a3ece5d1e2ea6">SignContract</a>(*m_pServerNym) || !<a class="code" href="class_o_t_contract.html#a363ae430d4fd9256ab8364dbafb95444">SaveContract</a>() || !<a class="code" href="class_o_t_contract.html#a363ae430d4fd9256ab8364dbafb95444">SaveContract</a>(szFoldername, szFilename))
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;Error saving main Cronfile:\n%s%s%s\n&quot;</span>, szFoldername,
                      <a class="code" href="class_o_t_log.html#a42d3c91ff84ecae0690e34efb4619a77">OTLog::PathSeparator</a>(), szFilename);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span> <span class="keyword">true</span>;    
}
</pre></div>
</div>
</div>
<a class="anchor" id="acdc92929308e95fa1af64320d3c51191"></a><!-- doxytag: member="OTCron::SetCronMaxItemsPerNym" ref="acdc92929308e95fa1af64320d3c51191" args="(int32_t nMax)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="class_o_t_cron.html#acdc92929308e95fa1af64320d3c51191">OTCron::SetCronMaxItemsPerNym</a> </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>nMax</em></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00196">196</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ __cron_max_items_per_nym = nMax; }
</pre></div>
</div>
</div>
<a class="anchor" id="a619a81f1f5a75c7f9e20d5542b8f9fe9"></a><!-- doxytag: member="OTCron::SetCronMsBetweenProcess" ref="a619a81f1f5a75c7f9e20d5542b8f9fe9" args="(int32_t lMS)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="class_o_t_cron.html#a619a81f1f5a75c7f9e20d5542b8f9fe9">OTCron::SetCronMsBetweenProcess</a> </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>lMS</em></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00190">190</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ __cron_ms_between_process = lMS; }
</pre></div>
</div>
</div>
<a class="anchor" id="a40e88ae62f7c536109228251feace4be"></a><!-- doxytag: member="OTCron::SetCronRefillAmount" ref="a40e88ae62f7c536109228251feace4be" args="(int32_t nAmount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="class_o_t_cron.html#a40e88ae62f7c536109228251feace4be">OTCron::SetCronRefillAmount</a> </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>nAmount</em></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00193">193</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ __trans_refill_amount = nAmount; }
</pre></div>
</div>
</div>
<a class="anchor" id="a7c421c0abe1a6728a2a056bfb46a3de2"></a><!-- doxytag: member="OTCron::SetServerID" ref="a7c421c0abe1a6728a2a056bfb46a3de2" args="(const OTIdentifier &amp;SERVER_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_cron.html#a7c421c0abe1a6728a2a056bfb46a3de2">OTCron::SetServerID</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_o_t_identifier.html">OTIdentifier</a> &amp;&#160;</td>
          <td class="paramname"><em>SERVER_ID</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00250">250</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ m_SERVER_ID = SERVER_ID; }
</pre></div>
</div>
</div>
<a class="anchor" id="a8c09682be017ef6c39a84c27123e23b2"></a><!-- doxytag: member="OTCron::SetServerNym" ref="a8c09682be017ef6c39a84c27123e23b2" args="(OTPseudonym *pServerNym)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_cron.html#a8c09682be017ef6c39a84c27123e23b2">OTCron::SetServerNym</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_pseudonym.html">OTPseudonym</a> *&#160;</td>
          <td class="paramname"><em>pServerNym</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_cron_8hpp_source.html#l00253">253</a> of file <a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pServerNym); m_pServerNym = pServerNym; }
</pre></div>
</div>
</div>
<a class="anchor" id="a0eee508b9330b0dc0776c4a8cb9e2b9b"></a><!-- doxytag: member="OTCron::UpdateContents" ref="a0eee508b9330b0dc0776c4a8cb9e2b9b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_cron.html#a0eee508b9330b0dc0776c4a8cb9e2b9b">OTCron::UpdateContents</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="class_o_t_contract.html#a78c28164555e2eb79d6b67698421638d">OTContract</a>.</p>

<p>Definition at line <a class="el" href="_o_t_cron_8cpp_source.html#l00590">590</a> of file <a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// I release this because I&#39;m about to repopulate it.</span>
    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#abef4b21b2170468705c58d64212d7257">Release</a>();
    <span class="comment">// -------------------------------------------------------------</span>
    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;?xml version=\&quot;%s\&quot;?&gt;\n\n&quot;</span>, <span class="stringliteral">&quot;1.0&quot;</span>);     
    <span class="comment">// -------------------------------------------------------------</span>
    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>  SERVER_ID(m_SERVER_ID);
    
    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;cron\n version=\&quot;%s\&quot;\n&quot;</span>
                              <span class="stringliteral">&quot; serverID=\&quot;%s\&quot;&quot;</span>
                              <span class="stringliteral">&quot; &gt;\n\n&quot;</span>, 
                              <a class="code" href="class_o_t_contract.html#aa0d889e0e1670b56fedca245041a5ed3">m_strVersion</a>.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(),
                              SERVER_ID.Get()); 
    <span class="comment">// -------------------------------------------------------------</span>
    <span class="comment">// Save the Market entries (the markets themselves are saved in a markets folder.)</span>
    <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_cron_8hpp.html#a59d4f7139328282aa9ee62a031844246">mapOfMarkets</a>, m_mapMarkets)
    {
        <a class="code" href="class_o_t_market.html">OTMarket</a> * pMarket = (*it).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pMarket);
        
        <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>    MARKET_ID(*pMarket);
        <a class="code" href="class_o_t_string.html">OTString</a>        str_MARKET_ID(MARKET_ID);
        
        <a class="code" href="class_o_t_string.html">OTString</a>        str_ASSET_ID(pMarket-&gt;<a class="code" href="class_o_t_market.html#a0a4e04126fb83f13b1477fccc169c0e9">GetAssetID</a>());
        <a class="code" href="class_o_t_string.html">OTString</a>        str_CURRENCY_ID(pMarket-&gt;<a class="code" href="class_o_t_market.html#aeeac45c32cade4a24d29e7a829304956">GetCurrencyID</a>());
        
        <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;market\n marketID=\&quot;%s\&quot;\n&quot;</span>
                                  <span class="stringliteral">&quot; assetID=\&quot;%s\&quot;\n&quot;</span>
                                  <span class="stringliteral">&quot; currencyID=\&quot;%s\&quot;\n&quot;</span>
                                  <span class="stringliteral">&quot; marketScale=\&quot;%lld\&quot;&quot;</span>
                                  <span class="stringliteral">&quot; /&gt;\n\n&quot;</span>,
                                  str_MARKET_ID.Get(),
                                  str_ASSET_ID.Get(),
                                  str_CURRENCY_ID.Get(),
                                  pMarket-&gt;<a class="code" href="class_o_t_market.html#aebe1f377a1c3a56d8dc0bb90168eea67">GetScale</a>()); 
    }       
    <span class="comment">// -------------------------------------------------------------</span>
    <span class="comment">// Save the Cron Items</span>
    <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_cron_8hpp.html#af0fe73fce142b8d47867d7a760b73bcd">multimapOfCronItems</a>, m_multimapCronItems)
    {
        <a class="code" href="class_o_t_cron_item.html">OTCronItem</a> * pItem = (*it).second;
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pItem);
        <span class="comment">// -------------------------------------</span>
        <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>  tDateAdded = (*it).first;
        int64_t lDateAdded = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tDateAdded);
        <span class="comment">// -------------------------------------</span>
        <a class="code" href="class_o_t_string.html">OTString</a> strItem(*pItem);       <span class="comment">// Extract the cron item contract into string form.</span>
        <a class="code" href="class_o_t_a_s_c_i_i_armor.html">OTASCIIArmor</a> ascItem(strItem);  <span class="comment">// Base64-encode that for storage.</span>
        <span class="comment">// -------------------------------------</span>
        <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;cronItem dateAdded=\&quot;%&quot;</span> PRId64<span class="stringliteral">&quot;\&quot; &gt;\n%s&lt;/cronItem&gt;\n\n&quot;</span>,
                                  lDateAdded, ascItem.Get());
    }
    <span class="comment">// -------------------------------------------------------------</span>
    <span class="comment">// Save the transaction numbers.</span>
    <span class="comment">//</span>
    int64_t lTransactionNumber = 0;
    
    <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_cron_8hpp.html#ae45e9feb4c88f9ee64b708e395602fed">listOfLongNumbers</a>, m_listTransactionNumbers)
    {   
        lTransactionNumber = *it;
        
        <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;transactionNum value=\&quot;%lld\&quot; /&gt;\n\n&quot;</span>, 
                           lTransactionNumber);
    } <span class="comment">// for</span>
    <span class="comment">// -------------------------------------------------------------</span>
    <a class="code" href="class_o_t_contract.html#a087fc09cfa4b2fd9076088360a5e5039">m_xmlUnsigned</a>.<a class="code" href="class_o_t_string.html#a86e54de385040ff6769d7f2149ce176b">Concatenate</a>(<span class="stringliteral">&quot;&lt;/cron&gt;\n&quot;</span>);
}
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/otlib/<a class="el" href="_o_t_cron_8hpp_source.html">OTCron.hpp</a></li>
<li>src/otlib/<a class="el" href="_o_t_cron_8cpp_source.html">OTCron.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_o_t_cron.html">OTCron</a>      </li>

    <li class="footer">Generated on Wed May 21 2014 11:26:12 for Open-Transactions by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
