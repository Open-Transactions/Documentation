<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Open-Transactions: OTRecordList Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Open-Transactions
   &#160;<span id="projectnumber">master/1066fb4910a63ee3f7de8e0807fee3eb663b66c7</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('class_o_t_record_list.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">OTRecordList Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="OTRecordList" -->
<p><code>#include &lt;<a class="el" href="_o_t_record_list_8hpp_source.html">OTRecordList.hpp</a>&gt;</code></p>

<p><a href="class_o_t_record_list-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a85777f253ce92f0e8b43f153dabbd6b9">OTRecordList</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#ac638369486d26820e65f81185a40e7f1">OTRecordList</a> (<a class="el" href="class_o_t_name_lookup.html">OTNameLookup</a> &amp;theLookup)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a589a25237b808c6e4fed422bd8a3bcbb">~OTRecordList</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a95de2963c62f82a8669d20c93f8289cd">SetFastMode</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#ae87f1e637851abb0d46e1eddb424e6da">SetServerID</a> (const std::string str_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a9d8963a34cc95d0665fc7824fc08846d">AddServerID</a> (const std::string str_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a5a1aa0a3c27dacc601263b13ba21770e">ClearServers</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a8940a1f349f3543499e94c7e599ef3f9">SetAssetID</a> (const std::string str_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a47afa29d1990ec024feac91e6032c786">AddAssetID</a> (const std::string str_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a6752defba9b0a83c6d9723c1ab8f76a3">ClearAssets</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a4f11a534c858d5dc8371c83e4ec5cbc5">SetNymID</a> (const std::string str_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#aa9b17f88ed73b797b84be5fca67877c9">AddNymID</a> (const std::string str_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a8c07d4f66047848e971b631b9dd7eace">ClearNyms</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a6d54cbd85e4bd1ef68f386c5e87a4cdd">SetAccountID</a> (const std::string str_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a3797bde231add00697f547a147839906">AddAccountID</a> (const std::string str_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#aa76496d19fdaaad6b231c65bad6c36e4">ClearAccounts</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#ae44503cb9c7144730b1766db3bec518c">AcceptChequesAutomatically</a> (bool bVal=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a9b7f332580cd9162a04bcb1822b36e95">AcceptReceiptsAutomatically</a> (bool bVal=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#aaf76a5da63b40c82398bd0017605b22a">AcceptTransfersAutomatically</a> (bool bVal=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#ab4789815f0d8f1d70d1988e9facc1dea">AcceptCashAutomatically</a> (bool bVal=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a987df1b71687cf1a3e0127009ad26855">DoesAcceptChequesAutomatically</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#aa868d4136395d77948b0cafc1c35a53f">DoesAcceptReceiptsAutomatically</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#ae61262e2226eddca0f261dfcd3f72d29">DoesAcceptTransfersAutomatically</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#af6c02b51a493a1455cb0e4fe4343dcfb">DoesAcceptCashAutomatically</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a46ecadc735b29bbc4c5c9b9a0f31d121">PerformAutoAccept</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a02be54bcb6a43c42719998a412471150">Populate</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#ad31c399d15c81732ac6172e2902a2940">ClearContents</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a858ab3250d47c849687389e9b1e7b5e2">size</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT <a class="el" href="_t_r1___wrapper_8hpp.html#a4081b6aa22d0f454ce7498756ea212ff">_SharedPtr</a>&lt; <a class="el" href="class_o_t_record.html">OTRecord</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a784514f43bbd7b9c20406edfb75facf1">GetRecord</a> (int32_t nIndex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EXPORT bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a06d0016ff3e3ee84db4425a1b2f5a41b">RemoveRecord</a> (int32_t nIndex)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#aae138fffa645482e39d2d838e4124839">setAddrBookCaller</a> (<a class="el" href="class_o_t_lookup_caller.html">OTLookupCaller</a> &amp;theCaller)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_o_t_lookup_caller.html">OTLookupCaller</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#ac4c5c2f740812baa27fb65a2a6166d75">getAddrBookCaller</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">textTo</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">textFrom</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#aa5d5a6d00a8b54e2b295133563cd8646">setTextTo</a> (const std::string text)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static EXPORT void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a2d0938938a6401c8b0e2bd376323c511">setTextFrom</a> (const std::string text)</td></tr>
<tr><td colspan="2"><h2><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_o_t_lookup_caller.html">OTLookupCaller</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_t_record_list.html#a111c1ea4503cbe5f1b684dbd28682a2e">s_pCaller</a> = NULL</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="_o_t_record_list_8hpp_source.html#l00230">230</a> of file <a class="el" href="_o_t_record_list_8hpp_source.html">OTRecordList.hpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a85777f253ce92f0e8b43f153dabbd6b9"></a><!-- doxytag: member="OTRecordList::OTRecordList" ref="a85777f253ce92f0e8b43f153dabbd6b9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_record_list.html#a85777f253ce92f0e8b43f153dabbd6b9">OTRecordList::OTRecordList</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l03232">3232</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                           :
    m_pLookup(NULL),
    m_bRunFast(<span class="keyword">false</span>),
    m_bAutoAcceptCheques  (<span class="keyword">false</span>),
    m_bAutoAcceptReceipts (<span class="keyword">false</span>),
    m_bAutoAcceptTransfers(<span class="keyword">false</span>),
    m_bAutoAcceptCash     (<span class="keyword">false</span>)
{
    <a class="code" href="_o_t_assert_8hpp.html#a033b133f48e61f2b227c52ad2be0c882">OT_ASSERT_MSG</a>( (NULL != <a class="code" href="class_o_t_record_list.html#a111c1ea4503cbe5f1b684dbd28682a2e">s_pCaller</a>), <span class="stringliteral">&quot;Address Book Caller was NULL! &quot;</span>
                  <span class="stringliteral">&quot;On app startup, did you forget to call OT_API_Set_AddrBookCallback ?\n&quot;</span>);
    <span class="comment">// -----------------------------------</span>
    <a class="code" href="_o_t_assert_8hpp.html#a033b133f48e61f2b227c52ad2be0c882">OT_ASSERT_MSG</a>( (<a class="code" href="class_o_t_record_list.html#a111c1ea4503cbe5f1b684dbd28682a2e">s_pCaller</a>-&gt;<a class="code" href="class_o_t_lookup_caller.html#a1505287e5d5e6753fec8bf9ed8c88e62">isCallbackSet</a>()), <span class="stringliteral">&quot;Address Book Callback was NULL! &quot;</span>
                    <span class="stringliteral">&quot;On app startup, did you forget to call OT_API_Set_AddrBookCallback ?\n&quot;</span>);
    <span class="comment">// -----------------------------------</span>
    m_pLookup = <a class="code" href="class_o_t_record_list.html#a111c1ea4503cbe5f1b684dbd28682a2e">s_pCaller</a>-&gt;<a class="code" href="class_o_t_lookup_caller.html#aa2a95ce502574ce73b037a96e9cca8ec">getCallback</a>();  <span class="comment">// &lt;==========</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac638369486d26820e65f81185a40e7f1"></a><!-- doxytag: member="OTRecordList::OTRecordList" ref="ac638369486d26820e65f81185a40e7f1" args="(OTNameLookup &amp;theLookup)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_record_list.html#a85777f253ce92f0e8b43f153dabbd6b9">OTRecordList::OTRecordList</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_name_lookup.html">OTNameLookup</a> &amp;&#160;</td>
          <td class="paramname"><em>theLookup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l03250">3250</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                   :
    m_pLookup(&amp;theLookup),
    m_bRunFast(<span class="keyword">false</span>),
    m_bAutoAcceptCheques  (<span class="keyword">false</span>),
    m_bAutoAcceptReceipts (<span class="keyword">false</span>),
    m_bAutoAcceptTransfers(<span class="keyword">false</span>),
    m_bAutoAcceptCash     (<span class="keyword">false</span>)
{

}
</pre></div>
</div>
</div>
<a class="anchor" id="a589a25237b808c6e4fed422bd8a3bcbb"></a><!-- doxytag: member="OTRecordList::~OTRecordList" ref="a589a25237b808c6e4fed422bd8a3bcbb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_record_list.html#a589a25237b808c6e4fed422bd8a3bcbb">OTRecordList::~OTRecordList</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l03262">3262</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">//  if (NULL != m_pLookup) // NO DELETE! We assume whatever client app is using OTRecordList, will</span>
<span class="comment">//      delete m_pLookup;  // delete its own address book lookup class when it is good and ready.</span>

    m_pLookup = NULL;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab4789815f0d8f1d70d1988e9facc1dea"></a><!-- doxytag: member="OTRecordList::AcceptCashAutomatically" ref="ab4789815f0d8f1d70d1988e9facc1dea" args="(bool bVal=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#ab4789815f0d8f1d70d1988e9facc1dea">OTRecordList::AcceptCashAutomatically</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bVal</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00509">509</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ m_bAutoAcceptCash      = bVal; }
</pre></div>
</div>
</div>
<a class="anchor" id="ae44503cb9c7144730b1766db3bec518c"></a><!-- doxytag: member="OTRecordList::AcceptChequesAutomatically" ref="ae44503cb9c7144730b1766db3bec518c" args="(bool bVal=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#ae44503cb9c7144730b1766db3bec518c">OTRecordList::AcceptChequesAutomatically</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bVal</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00506">506</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ m_bAutoAcceptCheques   = bVal; }
</pre></div>
</div>
</div>
<a class="anchor" id="a9b7f332580cd9162a04bcb1822b36e95"></a><!-- doxytag: member="OTRecordList::AcceptReceiptsAutomatically" ref="a9b7f332580cd9162a04bcb1822b36e95" args="(bool bVal=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a9b7f332580cd9162a04bcb1822b36e95">OTRecordList::AcceptReceiptsAutomatically</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bVal</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00507">507</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ m_bAutoAcceptReceipts  = bVal; }
</pre></div>
</div>
</div>
<a class="anchor" id="aaf76a5da63b40c82398bd0017605b22a"></a><!-- doxytag: member="OTRecordList::AcceptTransfersAutomatically" ref="aaf76a5da63b40c82398bd0017605b22a" args="(bool bVal=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#aaf76a5da63b40c82398bd0017605b22a">OTRecordList::AcceptTransfersAutomatically</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bVal</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00508">508</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ m_bAutoAcceptTransfers = bVal; }
</pre></div>
</div>
</div>
<a class="anchor" id="a3797bde231add00697f547a147839906"></a><!-- doxytag: member="OTRecordList::AddAccountID" ref="a3797bde231add00697f547a147839906" args="(const std::string str_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a3797bde231add00697f547a147839906">OTRecordList::AddAccountID</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>str_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00490">490</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    m_accounts.insert(m_accounts.end(), str_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a47afa29d1990ec024feac91e6032c786"></a><!-- doxytag: member="OTRecordList::AddAssetID" ref="a47afa29d1990ec024feac91e6032c786" args="(const std::string str_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a47afa29d1990ec024feac91e6032c786">OTRecordList::AddAssetID</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>str_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00407">407</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// -------------------------</span>
    <a class="code" href="class_o_t_wallet.html">OTWallet</a> * pWallet = <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#af759173aae6f4592c3d6ef1f6a9aa4ff">GetWallet</a>(__FUNCTION__); <span class="comment">// This logs and ASSERTs already.</span>
    <span class="comment">// -------------------------</span>
    <a class="code" href="_o_t_assert_8hpp.html#a033b133f48e61f2b227c52ad2be0c882">OT_ASSERT_MSG</a>(NULL != pWallet, <span class="stringliteral">&quot;Wallet was NULL. Should never happen.&quot;</span>);
    <span class="comment">// ------------------------------------------------</span>
    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>     strAssetTypeID(str_id);
    <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theAssetTypeID(strAssetTypeID);
    <span class="comment">// ------------------------------------------------</span>
    std::string str_asset_name;
    <span class="comment">// ------------------------------------------------</span>
    <span class="comment">// Name is dollars, fraction is cents, TLA is USD and</span>
    <span class="comment">// Symbol is $ (for example.) Here, we&#39;re grabbing the TLA.</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_asset_contract.html">OTAssetContract</a> * pAssetContract = pWallet-&gt;<a class="code" href="class_o_t_wallet.html#a4daee51036b24439e687383a6c66c6f7">GetAssetContract</a>(theAssetTypeID);
    <span class="comment">// ------------------------------------------------</span>
    <span class="keywordflow">if</span> (NULL != pAssetContract)
    {
        str_asset_name = pAssetContract-&gt;<a class="code" href="class_o_t_asset_contract.html#a57453300ee2ae1c1237078126d993afc">GetCurrencyTLA</a>().<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();  <span class="comment">// This might be &quot;USD&quot; -- preferable that this works.</span>
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordflow">if</span> (str_asset_name.empty())
            str_asset_name = pAssetContract-&gt;<a class="code" href="class_o_t_asset_contract.html#a69a507ba243e590f14354c3d903a03a6">GetCurrencySymbol</a>().<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();  <span class="comment">// This might be &quot;$&quot;.</span>
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordflow">if</span> (str_asset_name.empty())
            str_asset_name = pAssetContract-&gt;<a class="code" href="class_o_t_asset_contract.html#af098ba258ee7490e32f72bc8896cf079">GetCurrencyName</a>().<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();  <span class="comment">// This might be &quot;dollars&quot;.</span>
    }
    <span class="comment">// ------------------------------------------------</span>
    <span class="keywordflow">if</span> (str_asset_name.empty())
        str_asset_name = <a class="code" href="class_o_t_a_p_i___wrap.html#a5ef7d7ae416f5c4d8ca0242afd5f4216">OTAPI_Wrap::GetAssetType_Name</a>(str_id); <span class="comment">// Otherwise we try to grab the name.</span>
    <span class="comment">// ------------------------------------------------</span>
    <span class="comment">// (Otherwise we just leave it blank. The ID is too big to cram in here.)</span>
    <span class="comment">// ------------------------------------------------</span>
    m_assets.insert(std::pair&lt;std::string, std::string&gt;(str_id, str_asset_name));
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa9b17f88ed73b797b84be5fca67877c9"></a><!-- doxytag: member="OTRecordList::AddNymID" ref="aa9b17f88ed73b797b84be5fca67877c9" args="(const std::string str_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#aa9b17f88ed73b797b84be5fca67877c9">OTRecordList::AddNymID</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>str_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00464">464</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    m_nyms.insert(m_nyms.end(), str_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9d8963a34cc95d0665fc7824fc08846d"></a><!-- doxytag: member="OTRecordList::AddServerID" ref="a9d8963a34cc95d0665fc7824fc08846d" args="(const std::string str_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a9d8963a34cc95d0665fc7824fc08846d">OTRecordList::AddServerID</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>str_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00381">381</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    m_servers.insert(m_servers.end(), str_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa76496d19fdaaad6b231c65bad6c36e4"></a><!-- doxytag: member="OTRecordList::ClearAccounts" ref="aa76496d19fdaaad6b231c65bad6c36e4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#aa76496d19fdaaad6b231c65bad6c36e4">OTRecordList::ClearAccounts</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00497">497</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_record_list.html#ad31c399d15c81732ac6172e2902a2940">ClearContents</a>();
    <span class="comment">// -----------------------</span>
    m_accounts.clear();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6752defba9b0a83c6d9723c1ab8f76a3"></a><!-- doxytag: member="OTRecordList::ClearAssets" ref="a6752defba9b0a83c6d9723c1ab8f76a3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a6752defba9b0a83c6d9723c1ab8f76a3">OTRecordList::ClearAssets</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00445">445</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_record_list.html#ad31c399d15c81732ac6172e2902a2940">ClearContents</a>();
    <span class="comment">// -----------------------</span>
    m_assets.clear();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad31c399d15c81732ac6172e2902a2940"></a><!-- doxytag: member="OTRecordList::ClearContents" ref="ad31c399d15c81732ac6172e2902a2940" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#ad31c399d15c81732ac6172e2902a2940">OTRecordList::ClearContents</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l03272">3272</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    m_contents.clear();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8c07d4f66047848e971b631b9dd7eace"></a><!-- doxytag: member="OTRecordList::ClearNyms" ref="a8c07d4f66047848e971b631b9dd7eace" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a8c07d4f66047848e971b631b9dd7eace">OTRecordList::ClearNyms</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00471">471</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_record_list.html#ad31c399d15c81732ac6172e2902a2940">ClearContents</a>();
    <span class="comment">// -----------------------</span>
    m_nyms.clear();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5a1aa0a3c27dacc601263b13ba21770e"></a><!-- doxytag: member="OTRecordList::ClearServers" ref="a5a1aa0a3c27dacc601263b13ba21770e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a5a1aa0a3c27dacc601263b13ba21770e">OTRecordList::ClearServers</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00389">389</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_record_list.html#ad31c399d15c81732ac6172e2902a2940">ClearContents</a>();
    <span class="comment">// -----------------------</span>
    m_servers.clear();
}
</pre></div>
</div>
</div>
<a class="anchor" id="af6c02b51a493a1455cb0e4fe4343dcfb"></a><!-- doxytag: member="OTRecordList::DoesAcceptCashAutomatically" ref="af6c02b51a493a1455cb0e4fe4343dcfb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_record_list.html#af6c02b51a493a1455cb0e4fe4343dcfb">OTRecordList::DoesAcceptCashAutomatically</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00514">514</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> m_bAutoAcceptCash;      }
</pre></div>
</div>
</div>
<a class="anchor" id="a987df1b71687cf1a3e0127009ad26855"></a><!-- doxytag: member="OTRecordList::DoesAcceptChequesAutomatically" ref="a987df1b71687cf1a3e0127009ad26855" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_record_list.html#a987df1b71687cf1a3e0127009ad26855">OTRecordList::DoesAcceptChequesAutomatically</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00511">511</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> m_bAutoAcceptCheques;   }
</pre></div>
</div>
</div>
<a class="anchor" id="aa868d4136395d77948b0cafc1c35a53f"></a><!-- doxytag: member="OTRecordList::DoesAcceptReceiptsAutomatically" ref="aa868d4136395d77948b0cafc1c35a53f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_record_list.html#aa868d4136395d77948b0cafc1c35a53f">OTRecordList::DoesAcceptReceiptsAutomatically</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00512">512</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> m_bAutoAcceptReceipts;  }
</pre></div>
</div>
</div>
<a class="anchor" id="ae61262e2226eddca0f261dfcd3f72d29"></a><!-- doxytag: member="OTRecordList::DoesAcceptTransfersAutomatically" ref="ae61262e2226eddca0f261dfcd3f72d29" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_record_list.html#ae61262e2226eddca0f261dfcd3f72d29">OTRecordList::DoesAcceptTransfersAutomatically</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00513">513</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> m_bAutoAcceptTransfers; }
</pre></div>
</div>
</div>
<a class="anchor" id="ac4c5c2f740812baa27fb65a2a6166d75"></a><!-- doxytag: member="OTRecordList::getAddrBookCaller" ref="ac4c5c2f740812baa27fb65a2a6166d75" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_lookup_caller.html">OTLookupCaller</a> * <a class="el" href="class_o_t_record_list.html#ac4c5c2f740812baa27fb65a2a6166d75">OTRecordList::getAddrBookCaller</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00357">357</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="class_o_t_record_list.html#a111c1ea4503cbe5f1b684dbd28682a2e">s_pCaller</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a784514f43bbd7b9c20406edfb75facf1"></a><!-- doxytag: member="OTRecordList::GetRecord" ref="a784514f43bbd7b9c20406edfb75facf1" args="(int32_t nIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> <a class="el" href="class_o_t_record_list.html#a784514f43bbd7b9c20406edfb75facf1">OTRecordList::GetRecord</a> </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>nIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l03295">3295</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>((nIndex &gt;= 0) &amp;&amp; (nIndex &lt; static_cast&lt;int32_t&gt;(m_contents.size())));
    <a class="code" href="_o_t_record_list_8hpp.html#ada94f0a02e9bc6fd7079b70c77b3c1dc">weak_ptr_OTRecord</a>   wp_record(m_contents[nIndex]);   
    <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_record(wp_record);
    
    <span class="keywordflow">return</span> sp_record;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a46ecadc735b29bbc4c5c9b9a0f31d121"></a><!-- doxytag: member="OTRecordList::PerformAutoAccept" ref="a46ecadc735b29bbc4c5c9b9a0f31d121" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_record_list.html#a46ecadc735b29bbc4c5c9b9a0f31d121">OTRecordList::PerformAutoAccept</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00519">519</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// -------------------------</span>
    <a class="code" href="class_o_t_wallet.html">OTWallet</a> * pWallet = <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#af759173aae6f4592c3d6ef1f6a9aa4ff">GetWallet</a>(__FUNCTION__); <span class="comment">// This logs and ASSERTs already.</span>
    <span class="comment">// -------------------------</span>
    <span class="keywordflow">if</span> (NULL == pWallet)
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;OTRecordList::%s: Error: Wallet is NULL.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// ------------------------------------------------</span>
    <span class="comment">// LOOP NYMS</span>
    <span class="comment">//</span>
    <span class="keywordtype">int</span> nNymIndex = -1;
    <span class="keywordflow">if</span> (m_bAutoAcceptCheques || m_bAutoAcceptCash) <a class="code" href="_o_t_storage_8hpp.html#a4a94c3435a932ed34e5755f3f472547c">FOR_EACH_IT</a>(<a class="code" href="_o_t_record_list_8hpp.html#a1172b459639314113a533a64309eb319">list_of_strings</a>, m_nyms, it_nym)
    {
        ++nNymIndex;
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordflow">if</span> (0 == nNymIndex)
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;======================================\n %s: Beginning auto-accept loop through Nyms...\n&quot;</span>, __FUNCTION__);
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> std::string  &amp; str_nym_id(*it_nym);
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>   theNymID  (str_nym_id);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strNymID  (theNymID);
        <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> * pNym = pWallet-&gt;<a class="code" href="class_o_t_wallet.html#aab65a5710311cc6eeb9fbd0d7f881f0e">GetNymByID</a>(theNymID);
        <span class="keywordflow">if</span> (NULL == pNym) <span class="keywordflow">continue</span>;
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// LOOP SERVERS</span>
        <span class="comment">//</span>
        <span class="comment">// For each nym, for each server, loop through its payments inbox</span>
        <span class="comment">//</span>
        <span class="keywordtype">int</span> nServerIndex = -1;
        <a class="code" href="_o_t_storage_8hpp.html#a4a94c3435a932ed34e5755f3f472547c">FOR_EACH_IT</a>(<a class="code" href="_o_t_record_list_8hpp.html#a1172b459639314113a533a64309eb319">list_of_strings</a>, m_servers, it_server)
        {
            ++nServerIndex;
            <span class="comment">// --------------------------</span>
            <span class="keyword">const</span> std::string  &amp; str_server_id(*it_server);
            <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>   theServerID(str_server_id);
            <a class="code" href="class_o_t_server_contract.html">OTServerContract</a> *   pServer = pWallet-&gt;<a class="code" href="class_o_t_wallet.html#ae897619f652a0d3d9fba99a8bc747993">GetServerContract</a>(theServerID);
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pServer);
            <span class="comment">// ------------------------------------------------</span>
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strServerID(theServerID);
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Server %d, ID: %s\n&quot;</span>, __FUNCTION__, nServerIndex, strServerID.Get());
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="_o_t_record_list_8cpp.html#af2ad9db06b6d52ef03efb69b43cf2103">mapOfPayments</a> thePaymentMap;
            <span class="comment">// ------------------------------------------------</span>
            <span class="comment">// OPTIMIZE FYI:</span>
            <span class="comment">// The &quot;NoVerify&quot; version is much faster, but you will lose the ability to get the</span>
            <span class="comment">// sender/recipient name from the receipts in the box. The code will, however, work</span>
            <span class="comment">// either way.</span>
            <span class="comment">//</span>
            <a class="code" href="class_o_t_ledger.html">OTLedger</a> * pInbox = m_bRunFast ? <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a8e02cb186854f0b325c4c55da69f2e55">LoadPaymentInboxNoVerify</a>(theServerID, theNymID) :
                                             <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a5077987cf25f441923c88cb51b3d940a">LoadPaymentInbox</a>        (theServerID, theNymID);
            <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTLedger&gt;</a> theInboxAngel(pInbox);

            int32_t  nIndex = (-1);
            <span class="comment">// It loaded up, so let&#39;s loop through it.</span>
            <span class="keywordflow">if</span> (NULL != pInbox) <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_ledger_8hpp.html#a1823ddf57c0de6495aa8ec5da7f1b8f7">mapOfTransactions</a>, pInbox-&gt;<a class="code" href="class_o_t_ledger.html#aa71b6540e2948a36e3c7d3e7d14547a5">GetTransactionMap</a>())
            {
                <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * pBoxTrans = (*it).second;
                <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pBoxTrans);
                <span class="comment">// ------------------------------</span>
                ++nIndex; <span class="comment">// 0 on first iteration.</span>
                <span class="comment">// ------------------------------------------------</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Incoming payment: %d\n&quot;</span>, __FUNCTION__, nIndex);
                <span class="comment">// ------------------------------------------------</span>
                <span class="keyword">const</span> std::string * p_str_asset_type = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ASSET TYPE</span>
                <span class="keyword">const</span> std::string * p_str_asset_name = &amp;OTRecordList::s_blank; <span class="comment">// asset type display name.</span>
                <span class="comment">// ------------------------------------------------</span>
                std::string str_amount;  <span class="comment">// &lt;========== AMOUNT</span>
                std::string str_type;    <span class="comment">// Instrument type.</span>
                <span class="comment">// ------------------------------------------------</span>
                <a class="code" href="class_o_t_payment.html">OTPayment</a> * pPayment = pInbox-&gt;<a class="code" href="class_o_t_ledger.html#a114a4d31098807d6cb873a7343a407ae">GetInstrument</a>(*pNym,
                                                             nIndex);     <span class="comment">// ===&gt; Returns financial instrument by index.</span>
                <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTPayment&gt;</a> thePaymentAngel(pPayment);
                <span class="comment">// ------------------------------</span>
                <span class="keywordflow">if</span> (NULL == pPayment) <span class="comment">// then we treat it like it&#39;s abbreviated.</span>
                {
                    <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Payment retrieved from payments inbox was NULL. (It&#39;s abbreviated?) Skipping.\n&quot;</span>, __FUNCTION__);
                }
                <span class="comment">// ---------------------------------------------------</span>
                <span class="comment">// We have pPayment, the instrument accompanying the receipt in the payments inbox.</span>
                <span class="comment">//</span>
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a7f95ab568d481ecc7d38689c80caba84">IsValid</a>() &amp;&amp; pPayment-&gt;<a class="code" href="class_o_t_payment.html#a1ee95406f9d221ae4a57783422d52156">SetTempValues</a>())
                {
                    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theAssetTypeID;

                    <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a37342f7cb3d3fa42afb8531f4989d552">GetAssetTypeID</a>(theAssetTypeID))
                    {
                        <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAssetTypeID);
                        <span class="keyword">const</span> std::string str_inpmt_asset(strTemp.Get()); <span class="comment">// The asset type we found on the payment (if we found anything.)</span>
                        <span class="comment">// -----------------------------</span>
                        map_of_strings::iterator it_asset = m_assets.find(str_inpmt_asset);
                        <span class="comment">// -----------------------------</span>
                        <span class="keywordflow">if</span> (it_asset != m_assets.end()) <span class="comment">// Found it on the map of asset types we care about.</span>
                        {
                            p_str_asset_type = &amp;(it_asset-&gt;first);   <span class="comment">// Set the asset type ID.</span>
                            p_str_asset_name = &amp;(it_asset-&gt;second);  <span class="comment">// The CurrencyTLA. Examples: USD, BTC, etc.</span>
                        }
                        <span class="keywordflow">else</span>
                        {
                            <span class="comment">// There was definitely an asset type on the instrument, and it definitely</span>
                            <span class="comment">// did not match any of the assets that we care about.</span>
                            <span class="comment">// Therefore, skip.</span>
                            <span class="comment">//</span>
                            <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Skipping: Incoming payment (we don&#39;t care about asset %s)\n&quot;</span>,
                                          __FUNCTION__, str_inpmt_asset.c_str());
                            <span class="keywordflow">continue</span>;
                        }
                    }
                    <span class="comment">// By this point, p_str_asset_type and p_str_asset_name are definitely set.</span>
                    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_type); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
                    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_name); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
                    <span class="comment">// ---------------------------------------------------</span>
                    <span class="comment">// Instrument type (cheque, voucher, etc)</span>
                    <span class="keywordtype">int</span> nType = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a750b001a080812918d7c68bbc85c3ff3">GetType</a>());

                    str_type = <a class="code" href="_o_t_record_8hpp.html#aad2c87d02cf1bd05c6f519117deb93d9">OTRecord_GetTypeString</a>(nType);
                    <span class="comment">// ------------------------------</span>
                    <span class="comment">// For now, we only accept cash, cheques and vouchers.</span>
                    <span class="comment">//</span>
                    <span class="keywordflow">if</span> ( (m_bAutoAcceptCheques &amp;&amp; ((0 == str_type.compare(<span class="stringliteral">&quot;cheque&quot;</span>)) || (0 == str_type.compare(<span class="stringliteral">&quot;voucher&quot;</span>)))) ||
                         (m_bAutoAcceptCash    &amp;&amp;  (0 == str_type.compare(<span class="stringliteral">&quot;cash&quot;</span>))))
                    {
                        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Adding to acceptance list: pending incoming %s.\n&quot;</span>,
                                       __FUNCTION__, str_type.c_str());
                        <span class="comment">// -------------------------</span>
                        thePaymentMap.insert(std::pair&lt;int32_t, OTPayment *&gt;(nIndex, pPayment));
                        thePaymentAngel.SetCleanupTargetPointer(NULL); <span class="comment">// Now we HAVE to cleanup, below... Otherwise pPayment will leak.</span>
                    }
                    <span class="keywordflow">else</span>
                        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Unknown instrument type: %s\n&quot;</span>, __FUNCTION__, str_type.c_str());
                }
                <span class="keywordflow">else</span>
                    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Failed in pPayment-&gt;IsValid or pPayment-&gt;SetTempValues()\n&quot;</span>, __FUNCTION__);
                <span class="comment">// ------------------------------</span>
            } <span class="comment">// looping through payments inbox.</span>
            <span class="keywordflow">else</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;%s: Failed loading payments inbox. (Probably just doesn&#39;t exist yet.)\n&quot;</span>, __FUNCTION__);
            <span class="comment">// --------------------------------------------------------------------------</span>
            <span class="comment">// Above we compiled a list of purses, cheques / vouchers to accept.</span>
            <span class="comment">// If there are any on that list, then ACCEPT them here.</span>
            <span class="comment">//</span>
            <span class="keywordflow">if</span> (!thePaymentMap.empty())
            {
                <span class="keywordflow">for</span> (mapOfPayments::reverse_iterator it = thePaymentMap.rbegin(); it != thePaymentMap.rend(); ++it) <span class="comment">// backwards since we are processing (removing) payments by index.</span>
                {
                    <span class="keywordtype">long</span>        lIndex   = <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(it-&gt;first);
                    <a class="code" href="class_o_t_payment.html">OTPayment</a> * pPayment = it-&gt;second;
                    <span class="comment">// -------------------------</span>
                    <span class="keywordflow">if</span> (NULL == pPayment)
                    {
                        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: payment pointer was NULL! (Should never happen.) Skipping.\n&quot;</span>, __FUNCTION__);
                        <span class="keywordflow">continue</span>;
                    }
                    <span class="comment">// -------------------------</span>
                    <a class="code" href="class_o_t_string.html">OTString</a> strPayment;
                    std::string str_payment_contents;

                    <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a1d067b54e63054b1021ef5f187911fab">GetPaymentContents</a>(strPayment))
                    {
                        str_payment_contents = strPayment.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                    }
                    <span class="keywordflow">else</span>
                    {
                        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Failed while trying to get payment string contents. (Skipping.)\n&quot;</span>, __FUNCTION__);
                        <span class="keywordflow">continue</span>;
                    }
                    <span class="comment">// ---------------------------------</span>
                    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> paymentAssetType;
                    <span class="keywordtype">bool</span> bGotAsset = pPayment-&gt;<a class="code" href="class_o_t_payment.html#a37342f7cb3d3fa42afb8531f4989d552">GetAssetTypeID</a>(paymentAssetType);

                    std::string str_asset_type_id;

                    <span class="keywordflow">if</span> (bGotAsset)
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strAssetTypeID(paymentAssetType);
                        str_asset_type_id = strAssetTypeID.Get();
                    }
                    <span class="comment">// -------------------------------------------</span>
                    <span class="keywordflow">if</span> (str_asset_type_id.empty())
                    {
                        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error: Failed while trying to get asset type ID from payment. (Skipping.)\n&quot;</span>, __FUNCTION__);
                        <span class="keywordflow">continue</span>;
                    }
                    <span class="comment">// -------------------------------------------</span>
                    <span class="comment">// pick an account to deposit the cheque into.</span>
                    <span class="comment">//</span>
                    <a class="code" href="_o_t_storage_8hpp.html#a4a94c3435a932ed34e5755f3f472547c">FOR_EACH_IT</a>(<a class="code" href="_o_t_record_list_8hpp.html#a1172b459639314113a533a64309eb319">list_of_strings</a>, m_accounts, it_acct)
                    {
                        <span class="keyword">const</span> std::string  &amp; str_account_id(*it_acct);
                        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>   theAccountID  (str_account_id);
                        <a class="code" href="class_o_t_account.html">OTAccount</a> * pAccount = pWallet-&gt;<a class="code" href="class_o_t_wallet.html#aee1809973c356a82e9c0f80d201668f4">GetAccount</a>(theAccountID);
                        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pAccount);
                        <span class="comment">// ------------------------------------------------</span>
                        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAcctNymID    = pAccount-&gt;<a class="code" href="class_o_t_transaction_type.html#a845d76c16f6f5f3f4bc9ac04393ca3c0">GetUserID</a>();
                        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAcctServerID = pAccount-&gt;<a class="code" href="class_o_t_transaction_type.html#a59fc08d52ef5bc0ea546da7a56e86fa5">GetPurportedServerID</a>();
                        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAcctAssetID  = pAccount-&gt;<a class="code" href="class_o_t_account.html#a3b933b8c929e071a68ec4a29ad5797d6">GetAssetTypeID</a>();
                        <span class="comment">// -----------------------------------</span>
                        <span class="keyword">const</span> std::string    str_acct_type   = pAccount-&gt;<a class="code" href="class_o_t_account.html#a15dbf34beb7f8e38c6719120770bc852">GetTypeString</a>();
                        <span class="comment">// -----------------------------------</span>
<span class="comment">//                      const OTString       strAcctNymID   (theAcctNymID);</span>
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strAcctServerID(theAcctServerID);
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strAcctAssetID (theAcctAssetID);
                        <span class="comment">// ------------------------------------------------</span>
                        <span class="comment">// If the current account is owned by the Nym, AND it has the same asset type ID</span>
                        <span class="comment">// as the cheque being deposited, then let&#39;s deposit the cheque into that account.</span>
                        <span class="comment">//</span>
                        <span class="comment">// TODO: we should first just see if the default account matches, instead of doing</span>
                        <span class="comment">// this loop in the first place.</span>
                        <span class="comment">//</span>
                        <span class="keywordflow">if</span> ((theNymID == theAcctNymID)                           &amp;&amp;
                            (strAcctServerID.Compare(str_server_id    .c_str())) &amp;&amp;
                            (strAcctAssetID .Compare(str_asset_type_id.c_str())) &amp;&amp;
                            (0 == str_acct_type.compare(<span class="stringliteral">&quot;simple&quot;</span>))) <span class="comment">// No issuer accounts allowed here. Only simple accounts.</span>
                        {
                            <span class="comment">// Accept it.</span>
                            <span class="comment">//</span>
                            <a class="code" href="class_o_t_string.html">OTString</a> strIndices;
                            strIndices.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%ld&quot;</span>, lIndex);
                            <span class="keyword">const</span> std::string str_indices(strIndices.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());

                            <a class="code" href="class_o_t___m_e.html">OT_ME</a> madeEasy;
                            int32_t nReturn = madeEasy.<a class="code" href="class_o_t___m_e.html#a77ed23b7678320960422bae5d9405e0a">accept_from_paymentbox</a>(str_account_id, str_indices, <span class="stringliteral">&quot;ANY&quot;</span>);

                            <span class="keywordflow">switch</span> (nReturn)
                            {
                                <span class="keywordflow">case</span> 0:
                                    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: This instrument was expired, so it was moved to the record box.\n&quot;</span>, __FUNCTION__);
                                <span class="keywordflow">case</span> 1: <span class="comment">// success</span>
                                    <span class="keywordflow">break</span>;
                                    <span class="comment">// ----------------------------------</span>
                                <span class="keywordflow">default</span>:
                                    <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Error while trying to accept this instrument.\n&quot;</span>, __FUNCTION__);
                                    <span class="keywordflow">break</span>;
                            } <span class="comment">// switch</span>
                            <span class="keywordflow">break</span>;
                        }
                    } <span class="comment">// loop through accounts to find one to deposit cheque into.</span>
                } <span class="comment">// Loop through payments to deposit.</span>
                <span class="comment">// ------------------------------------------</span>
                <span class="comment">// Empty the list and delete the payments inside.</span>
                <span class="comment">//</span>
                <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_record_list_8cpp.html#af2ad9db06b6d52ef03efb69b43cf2103">mapOfPayments</a>, thePaymentMap)
                {
                    <a class="code" href="class_o_t_payment.html">OTPayment</a> * pPayment = it-&gt;second;
                    <span class="keywordflow">if</span> (NULL != pPayment)
                        <span class="keyword">delete</span> pPayment;
                    pPayment = NULL;
                }
                thePaymentMap.clear();
            } <span class="comment">// if (!thePaymentMap.empty())</span>
            <span class="comment">// ------------------------------------------------</span>
        } <span class="comment">// FOR_EACH_IT(list_of_strings, m_servers, it_server)</span>
    } <span class="comment">// FOR_EACH_IT(list_of_strings, m_nyms, it_nym)</span>
    <span class="comment">// ------------------------------------------------</span>
    <span class="comment">// ASSET ACCOUNT -- INBOX</span>
    <span class="comment">//</span>
    <span class="comment">// Loop through the Accounts.</span>
    <span class="comment">//</span>
    <span class="comment">// ------------------------------------------------</span>
    <span class="keywordtype">int</span> nAccountIndex = -1;
    <span class="keywordflow">if</span> (m_bAutoAcceptReceipts || m_bAutoAcceptTransfers) <a class="code" href="_o_t_storage_8hpp.html#a4a94c3435a932ed34e5755f3f472547c">FOR_EACH_IT</a>(<a class="code" href="_o_t_record_list_8hpp.html#a1172b459639314113a533a64309eb319">list_of_strings</a>, m_accounts, it_acct)
    {
        ++nAccountIndex; <span class="comment">// (0 on first iteration.)</span>
        <span class="comment">// ------------------</span>
        <span class="keywordflow">if</span> (0 == nAccountIndex)
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;---------------------------------\n %s: Beginning auto-accept loop through the accounts in the wallet...\n&quot;</span>,
                           __FUNCTION__);
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// For each account, loop through its inbox, outbox, and record box.</span>
        <span class="comment">//</span>
        <span class="keyword">const</span> std::string  &amp; str_account_id(*it_acct);
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>   theAccountID  (str_account_id);
        <a class="code" href="class_o_t_account.html">OTAccount</a> * pAccount = pWallet-&gt;<a class="code" href="class_o_t_wallet.html#aee1809973c356a82e9c0f80d201668f4">GetAccount</a>(theAccountID);
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pAccount);
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theNymID    = pAccount-&gt;<a class="code" href="class_o_t_transaction_type.html#a845d76c16f6f5f3f4bc9ac04393ca3c0">GetUserID</a>();
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theServerID = pAccount-&gt;<a class="code" href="class_o_t_transaction_type.html#a59fc08d52ef5bc0ea546da7a56e86fa5">GetPurportedServerID</a>();
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAssetID  = pAccount-&gt;<a class="code" href="class_o_t_account.html#a3b933b8c929e071a68ec4a29ad5797d6">GetAssetTypeID</a>();
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strNymID   (theNymID);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strServerID(theServerID);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strAssetID (theAssetID);
        <span class="comment">// ------------------------------------------------</span>
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;------------\n%s: Account: %d, ID: %s\n&quot;</span>, __FUNCTION__,
                       nAccountIndex, str_account_id.c_str());
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> std::string    str_nym_id    (strNymID   .Get());
        <span class="keyword">const</span> std::string    str_server_id (strServerID.Get());
        <span class="keyword">const</span> std::string    str_asset_id  (strAssetID .Get());
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> std::string  * pstr_nym_id     = &amp;OTRecordList::s_blank;
        <span class="keyword">const</span> std::string  * pstr_server_id  = &amp;OTRecordList::s_blank;
        <span class="keyword">const</span> std::string  * pstr_asset_id   = &amp;OTRecordList::s_blank;
        <span class="keyword">const</span> std::string  * pstr_asset_name = &amp;OTRecordList::s_blank;
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// NOTE: Since this account is already on my &quot;care about&quot; list for accounts,</span>
        <span class="comment">// I wouldn&#39;t bother double-checking my &quot;care about&quot; lists for servers, nyms,</span>
        <span class="comment">// and asset types. But I still look up the appropriate string for each, since</span>
        <span class="comment">// I have to pass a reference to it into the constructor for OTRecord. (To a version</span>
        <span class="comment">// that won&#39;t be deleted, since the OTRecord will reference it. And the &quot;care about&quot;</span>
        <span class="comment">// list definitely contains a copy of the string that won&#39;t be deleted.)</span>
        <span class="comment">//</span>
        list_of_strings::iterator it_nym    = std::find(m_nyms   .begin(),    m_nyms.end(),    str_nym_id);
        list_of_strings::iterator it_server = std::find(m_servers.begin(), m_servers.end(), str_server_id);
         map_of_strings::iterator it_asset  = m_assets.find(str_asset_id);
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordflow">if</span> ((m_nyms.end() == it_nym) || (m_servers.end() == it_server) || (m_assets.end() == it_asset))
        {
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Skipping an account (%s) since its Nym, or Server, &quot;</span>
                           <span class="stringliteral">&quot;or Asset Type wasn&#39;t on my list.\n&quot;</span>, __FUNCTION__,
                           str_account_id.c_str());
            <span class="keywordflow">continue</span>;
        }
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// These pointers are what we&#39;ll use to construct each OTRecord.</span>
        <span class="comment">//</span>
        pstr_nym_id     = &amp;(*it_nym);
        pstr_server_id  = &amp;(*it_server);
        pstr_asset_id   = &amp;(it_asset-&gt;first);
        pstr_asset_name = &amp;(it_asset-&gt;second);
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// Loop through asset account INBOX.</span>
        <span class="comment">//</span>
        <span class="comment">// OPTIMIZE FYI:</span>
        <span class="comment">// NOTE: LoadInbox is much SLOWER than LoadInboxNoVerify, but it also lets you get</span>
        <span class="comment">// the NAME off of the box receipt. So if you are willing to GIVE UP the NAME, in</span>
        <span class="comment">// return for FASTER PERFORMANCE, then call SetFastMode() before Populating.</span>
        <span class="comment">//</span>
        <a class="code" href="class_o_t_ledger.html">OTLedger</a> * pInbox = m_bRunFast ? <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a11a9479b4875de4377232237d3521690">LoadInboxNoVerify</a>(theServerID, theNymID, theAccountID) :
                                         <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a478f3f32e383e05a203807810bc94940">LoadInbox</a>        (theServerID, theNymID, theAccountID);
        <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTLedger&gt;</a> theInboxAngel(pInbox);
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordflow">if</span> (NULL == pInbox)
        {
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Skipping an account (%s) since its inbox failed to load (have you downloaded the latest one?)\n&quot;</span>, __FUNCTION__,
                           str_account_id.c_str());
            <span class="keywordflow">continue</span>;
        }
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strInbox(*pInbox);
        <span class="keyword">const</span> std::string str_inbox(strInbox.Get());
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordtype">bool</span> bFoundAnyToAccept = <span class="keyword">false</span>;
        std::string strResponseLedger;
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordtype">int</span> nInboxIndex = -1;
        <span class="comment">// It loaded up, so let&#39;s loop through it.</span>
        <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_ledger_8hpp.html#a1823ddf57c0de6495aa8ec5da7f1b8f7">mapOfTransactions</a>, pInbox-&gt;<a class="code" href="class_o_t_ledger.html#aa71b6540e2948a36e3c7d3e7d14547a5">GetTransactionMap</a>())
        {
            ++nInboxIndex; <span class="comment">// (0 on first iteration.)</span>
            <span class="comment">// ------------------------------------------------</span>
            <span class="keywordflow">if</span> (0 == nInboxIndex)
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Beginning loop through asset account INBOX...\n&quot;</span>, __FUNCTION__);
            <span class="comment">// --------------------------------</span>
            <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * pBoxTrans = (*it).second;
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pBoxTrans);
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Inbox index: %d\n&quot;</span>, __FUNCTION__, nInboxIndex);
            <span class="comment">// ------------------------------------------------</span>
            <span class="keyword">const</span> std::string str_type(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>()); <span class="comment">// pending, chequeReceipt, etc.</span>
            <span class="comment">// ------------------------------------------------</span>
            <span class="keyword">const</span> <span class="keywordtype">bool</span> bIsTransfer = (<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>());
            <span class="keyword">const</span> <span class="keywordtype">bool</span> bIsReceipt  = !bIsTransfer;
            <span class="comment">// ------------------------------------------------</span>
            <span class="keywordflow">if</span> ((m_bAutoAcceptReceipts  &amp;&amp;  bIsReceipt)   ||
                (m_bAutoAcceptTransfers &amp;&amp;  bIsTransfer))
            {
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Auto-accepting: incoming %s (str_type: %s)\n&quot;</span>,
                               __FUNCTION__, bIsTransfer ? <span class="stringliteral">&quot;pending transfer&quot;</span> : <span class="stringliteral">&quot;receipt&quot;</span>,
                               str_type.c_str());
                <span class="comment">// ------------------------------------------------</span>
                <span class="comment">// If we haven&#39;t found any yet, then this must be the first one!</span>
                <span class="comment">//</span>
                <span class="keywordflow">if</span> (!bFoundAnyToAccept)
                {
                    bFoundAnyToAccept = <span class="keyword">true</span>;
                    <span class="comment">// ------------------------</span>
                    <a class="code" href="class_o_t___m_e.html">OT_ME</a> madeEasy;

                    int32_t nNumberNeeded = 20;
                    <span class="keywordflow">if</span> (!madeEasy.<a class="code" href="class_o_t___m_e.html#a090d116996160157729cafb1c790ab94">make_sure_enough_trans_nums</a>(nNumberNeeded, <span class="comment">// I&#39;m just hardcoding: &quot;Make sure I have at least 20 transaction numbers.&quot;</span>
                                                              str_server_id, str_nym_id))
                    {
                        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;\n\nFailure: make_sure_enough_trans_nums: returned false. (Skipping inbox for account %s)\n&quot;</span>,
                                       str_account_id.c_str());
                        <span class="keywordflow">continue</span>;
                    }
                    <span class="comment">// ---------------------------------</span>
                    strResponseLedger = <a class="code" href="class_o_t_a_p_i___wrap.html#a99b35d10acdd06621bc28dac46e6fe54">OTAPI_Wrap::It</a>()-&gt;<a class="code" href="class_o_t_a_p_i___exec.html#a6a592a8bd48d7e006fdfe054e79b47ce">Ledger_CreateResponse</a>(str_server_id, str_nym_id, str_account_id, str_inbox);

                    <span class="keywordflow">if</span> (strResponseLedger.empty())
                    {
                        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;\n\nFailure: OT_API_Ledger_CreateResponse returned NULL. (Skipping inbox for account %s)\n&quot;</span>,
                                       str_account_id.c_str());
                        <span class="keywordflow">continue</span>;
                    }
                }
                <span class="comment">// -------------------------</span>
                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strTrans(*pBoxTrans);
                <span class="keyword">const</span> std::string str_trans(strTrans.Get());
                std::string strNEW_ResponseLEDGER = <a class="code" href="class_o_t_a_p_i___wrap.html#a99b35d10acdd06621bc28dac46e6fe54">OTAPI_Wrap::It</a>()-&gt;<a class="code" href="class_o_t_a_p_i___exec.html#aff7a984d28b09d76103f52faebfb754c">Transaction_CreateResponse</a>(str_server_id, str_nym_id, str_account_id, strResponseLedger, str_trans, <span class="keyword">true</span>); <span class="comment">// accept = true (versus rejecting a pending transfer, for example.)</span>

                <span class="keywordflow">if</span> (strNEW_ResponseLEDGER.empty())
                {
                    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;\n\nFailure: OT_API_Transaction_CreateResponse returned NULL. (Skipping inbox for account %s)\n&quot;</span>,
                                   str_account_id.c_str());
                    <span class="keywordflow">continue</span>;
                }
                strResponseLedger = strNEW_ResponseLEDGER;
            }
        } <span class="comment">// if (NULL != pInbox) FOR_EACH(mapOfTransactions, pInbox-&gt;GetTransactionMap())</span>
        <span class="comment">// -------------------------------------------------</span>
        <span class="comment">// Okay now we have the response ledger all ready to go, let&#39;s process it!</span>
        <span class="comment">//</span>
        <span class="keywordflow">if</span> (bFoundAnyToAccept &amp;&amp; !strResponseLedger.empty())
        {
            std::string strFinalizedResponse = <a class="code" href="class_o_t_a_p_i___wrap.html#a99b35d10acdd06621bc28dac46e6fe54">OTAPI_Wrap::It</a>()-&gt;<a class="code" href="class_o_t_a_p_i___exec.html#ae43e5ed33e7e2281c92a35818338c953">Ledger_FinalizeResponse</a>(str_server_id, str_nym_id, str_account_id, strResponseLedger);

            <span class="keywordflow">if</span> (strFinalizedResponse.empty())
            {
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;\n\nFailure: OT_API_Ledger_FinalizeResponse returned NULL. (Skipping inbox for account %s)\n&quot;</span>,
                               str_account_id.c_str());
                <span class="keywordflow">continue</span>;
            }
            <span class="comment">// ***************************************************************</span>
            <span class="comment">// Instantiate the &quot;OT Made Easy&quot; object.</span>
            <span class="comment">//</span>
            <a class="code" href="class_o_t___m_e.html">OT_ME</a> madeEasy;

            <span class="comment">// Server communications are handled here...</span>
            <span class="comment">//</span>
            std::string strResponse = madeEasy.<a class="code" href="class_o_t___m_e.html#a436a1afe30549317bc906fb939d954a5">process_inbox</a>(str_server_id, str_nym_id, str_account_id, strFinalizedResponse);
            std::string strAttempt  = <span class="stringliteral">&quot;process_inbox&quot;</span>;

            <span class="comment">// ***************************************************************</span>

            int32_t nInterpretReply = madeEasy.<a class="code" href="class_o_t___m_e.html#ae0c48ef64a9d5927b431fc9ade43fe9d">InterpretTransactionMsgReply</a>(str_server_id, str_nym_id, str_account_id, strAttempt, strResponse);

            <span class="keywordflow">if</span> (1 == nInterpretReply)
            {
                <span class="comment">// Download all the intermediary files (account balance, inbox, outbox, etc)</span>
                <span class="comment">// since they have probably changed from this operation.</span>
                <span class="comment">//</span>
                <span class="keywordtype">bool</span> bRetrieved = madeEasy.<a class="code" href="class_o_t___m_e.html#a318e950bbd83807a5654b9e59e9002d8">retrieve_account</a>(str_server_id, str_nym_id, str_account_id, <span class="keyword">true</span>); <span class="comment">//bForceDownload defaults to false.</span>

                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;\n\nServer response (%s): SUCCESS processing/accepting inbox.\n&quot;</span>, strAttempt.c_str());
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s retrieving intermediary files for account.\n&quot;</span>, (bRetrieved ? <span class="stringliteral">&quot;Success&quot;</span> : <span class="stringliteral">&quot;Failed&quot;</span>));
            }
        }
    } <span class="comment">// FOR_EACH_IT(list_of_strings, m_accounts, it_acct)</span>
    <span class="comment">// ------------------------------------------------</span>
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a02be54bcb6a43c42719998a412471150"></a><!-- doxytag: member="OTRecordList::Populate" ref="a02be54bcb6a43c42719998a412471150" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_record_list.html#a02be54bcb6a43c42719998a412471150">OTRecordList::Populate</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00990">990</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != m_pLookup);
    <span class="comment">// -----------------------</span>
    <a class="code" href="class_o_t_record_list.html#ad31c399d15c81732ac6172e2902a2940">ClearContents</a>();
    <span class="comment">// -----------------------</span>
    <span class="comment">// Loop through all the accounts.</span>
    <span class="comment">//</span>
    <span class="comment">// From Open-Transactions.h:</span>
    <span class="comment">// OTAPI_Wrap::OTAPI()-&gt;GetServerCount()</span>
    <span class="comment">//</span>
    <span class="comment">// From OTAPI.h:</span>
    <span class="comment">// OTAPI_Wrap::GetServerCount()  // wraps the above call.</span>
    <span class="comment">//</span>
    <span class="comment">// -------------------------</span>
    <a class="code" href="class_o_t_wallet.html">OTWallet</a> * pWallet = <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#af759173aae6f4592c3d6ef1f6a9aa4ff">GetWallet</a>(__FUNCTION__); <span class="comment">// This logs and ASSERTs already.</span>
    <span class="comment">// -------------------------</span>
    <span class="keywordflow">if</span> (NULL == pWallet)
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;OTRecordList::%s: Error: Wallet is NULL.\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <span class="comment">// ------------------------------------------------</span>
    <span class="comment">// Before populating, process out any items we&#39;re supposed to accept automatically.</span>
    <span class="comment">//</span>
    <a class="code" href="class_o_t_record_list.html#a46ecadc735b29bbc4c5c9b9a0f31d121">PerformAutoAccept</a>();
    <span class="comment">// ------------------------------------------------</span>
    <span class="comment">// OUTPAYMENTS, OUTMAIL, MAIL, PAYMENTS INBOX, and RECORD BOX (2 kinds.)</span>
    <span class="comment">// Loop through the Nyms.</span>
    <span class="comment">//</span>
    <span class="keywordtype">int</span> nNymIndex = -1;
    <a class="code" href="_o_t_storage_8hpp.html#a4a94c3435a932ed34e5755f3f472547c">FOR_EACH_IT</a>(<a class="code" href="_o_t_record_list_8hpp.html#a1172b459639314113a533a64309eb319">list_of_strings</a>, m_nyms, it_nym)
    {
        ++nNymIndex;
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordflow">if</span> (0 == nNymIndex)
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;=============== %s: Beginning loop through Nyms...\n&quot;</span>, __FUNCTION__);
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> std::string  &amp; str_nym_id(*it_nym);
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>   theNymID  (str_nym_id);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strNymID  (theNymID);
        <a class="code" href="class_o_t_pseudonym.html">OTPseudonym</a> * pNym = pWallet-&gt;<a class="code" href="class_o_t_wallet.html#aab65a5710311cc6eeb9fbd0d7f881f0e">GetNymByID</a>(theNymID);
        <span class="keywordflow">if</span> (NULL == pNym) <span class="keywordflow">continue</span>;
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// For each Nym, loop through his OUTPAYMENTS box.</span>
        <span class="comment">//</span>
        <span class="keyword">const</span> int32_t nOutpaymentsCount  = <a class="code" href="class_o_t_a_p_i___wrap.html#a2867a2de7baa62a90e24487bc1b7f8d4">OTAPI_Wrap::GetNym_OutpaymentsCount</a>(str_nym_id);

        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;--------\n%s: Nym %d, nOutpaymentsCount: %d, ID: %s\n&quot;</span>,
                       __FUNCTION__, nNymIndex, nOutpaymentsCount, strNymID.Get());
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordflow">for</span> ( int32_t nCurrentOutpayment = 0; nCurrentOutpayment &lt; nOutpaymentsCount; ++nCurrentOutpayment)
        {
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Outpayment instrument: %d\n&quot;</span>, __FUNCTION__, nCurrentOutpayment);
            <span class="comment">// ------------------------------------------------</span>
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strOutpayment(
                <a class="code" href="class_o_t_a_p_i___wrap.html#a75db1f5164e65a9ddabef0fc551a4e3d">OTAPI_Wrap::GetNym_OutpaymentsContentsByIndex</a>(str_nym_id, nCurrentOutpayment));
            <span class="comment">// ----------------------------------</span>
            std::string str_memo;
            <a class="code" href="class_o_t_payment.html">OTPayment</a>   theOutPayment(strOutpayment);

            <span class="keywordflow">if</span> (!theOutPayment.IsValid() || !theOutPayment.SetTempValues())
            {
                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Skipping: Unable to load outpayments instrument from string:\n%s\n&quot;</span>,
                              __FUNCTION__, strOutpayment.Get());
                <span class="keywordflow">continue</span>;
            }
            <span class="comment">// ----------------------------------</span>
            int64_t lAmount = 0;
            std::string str_amount;  <span class="comment">// &lt;========== AMOUNT</span>

            <span class="keywordflow">if</span> (theOutPayment.GetAmount(lAmount))
            {
                <span class="keywordflow">if</span> (((<a class="code" href="class_o_t_payment.html#aff3d9ae26dc36bc91037fe53db0d55d0affdbd56df02df31d40b649a409d3c7c0">OTPayment::CHEQUE</a>  == theOutPayment.GetType())  ||
                     (<a class="code" href="class_o_t_payment.html#aff3d9ae26dc36bc91037fe53db0d55d0adb525a0bf8ba34c3d69b17208631ad2e">OTPayment::PURSE</a>   == theOutPayment.GetType())  ||
                     (<a class="code" href="class_o_t_payment.html#aff3d9ae26dc36bc91037fe53db0d55d0af981cfb9acea695a3ac8dac8455c3fef">OTPayment::VOUCHER</a> == theOutPayment.GetType())) &amp;&amp; (lAmount &gt; 0))
                    lAmount *= (-1);

                <span class="keywordflow">if</span> ((<a class="code" href="class_o_t_payment.html#aff3d9ae26dc36bc91037fe53db0d55d0ad0c94c9025bb02cabfc2ead2ed8a990b">OTPayment::INVOICE</a>  == theOutPayment.GetType())  &amp;&amp; (lAmount &lt; 0))
                    lAmount *= (-1);

                <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
            }
            <span class="comment">// ----------------------------------</span>
            <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>        theAssetTypeID;
            <span class="keyword">const</span> std::string * p_str_asset_type = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ASSET TYPE</span>
            <span class="keyword">const</span> std::string * p_str_asset_name = &amp;OTRecordList::s_blank; <span class="comment">// asset type display name.</span>
            std::string str_outpmt_asset; <span class="comment">// The asset type we found on the payment (if we found anything.)</span>

            <span class="keywordflow">if</span> (theOutPayment.GetAssetTypeID(theAssetTypeID))
            {
                <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAssetTypeID);
                str_outpmt_asset = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                <span class="comment">// -----------------------------</span>
                map_of_strings::iterator it_asset = m_assets.find(str_outpmt_asset);
                <span class="comment">// -----------------------------</span>
                <span class="keywordflow">if</span> (it_asset != m_assets.end()) <span class="comment">// Found it on the map of asset types we care about.</span>
                {
                    p_str_asset_type = &amp;(it_asset-&gt;first);   <span class="comment">// Set the asset type ID.</span>
                    p_str_asset_name = &amp;(it_asset-&gt;second);  <span class="comment">// The CurrencyTLA. Examples: USD, BTC, etc.</span>
                }
                <span class="keywordflow">else</span>
                {
                    <span class="comment">// There was definitely an asset type on the instrument, and it definitely</span>
                    <span class="comment">// did not match any of the assets that we care about.</span>
                    <span class="comment">// Therefore, skip.</span>
                    <span class="comment">//</span>
                    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Skipping outpayment (we don&#39;t care about asset type %s)\n&quot;</span>,
                                   __FUNCTION__, str_outpmt_asset.c_str());
                    <span class="keywordflow">continue</span>;
                }
            }
            <span class="comment">// By this point, p_str_asset_type and p_str_asset_name are definitely set.</span>
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_type); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_name); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
            <span class="comment">// ----------------------------------</span>
            <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theAccountID;
            <span class="keyword">const</span> std::string * p_str_account = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ACCOUNT</span>
            std::string str_outpmt_account; <span class="comment">// The accountID we found on the payment (if we found anything.)</span>

            <span class="keywordflow">if</span> (theOutPayment.GetSenderAcctIDForDisplay(theAccountID)) <span class="comment">// Since Nym is ME, the Account must be MY acct.</span>
            {                                             <span class="comment">// (In Outpayments, the SENDER&#39;s account is MY acct.)</span>
                <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAccountID);
                str_outpmt_account = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                <span class="comment">// -----------------------------</span>
                list_of_strings::iterator it_acct = std::find(m_accounts.begin(), m_accounts.end(), str_outpmt_account);
                <span class="comment">// -----------------------------</span>
                <span class="keywordflow">if</span> (it_acct != m_accounts.end()) <span class="comment">// Found it on the list of accounts we care about.</span>
                {
                    p_str_account = &amp;(*it_acct);
                }
                <span class="comment">// We don&#39;t skip vouchers since the sender account (e.g. the server&#39;s account)</span>
                <span class="comment">// is definitely not one of my accounts -- so the voucher would end up getting</span>
                <span class="comment">// skipped every single time.</span>
                <span class="comment">//</span>
<span class="comment">//              else if (OTPayment::VOUCHER != theOutPayment.GetType())</span>
                <span class="keywordflow">else</span>
                {
                    <span class="comment">// There was definitely an account on the instrument, and it definitely</span>
                    <span class="comment">// did not match any of the accounts that we care about.</span>
                    <span class="comment">// Therefore, skip.</span>
                    <span class="comment">//</span>
                    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Skipping outpayment (we don&#39;t care about account %s)\n&quot;</span>,
                                   __FUNCTION__, str_outpmt_account.c_str());
                    <span class="keywordflow">continue</span>;
                }
            }
            <span class="comment">// By this point, p_str_account is definitely set.</span>
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_account); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the accounts we care about.</span>
            <span class="comment">// ----------------------------------</span>
            <span class="comment">// strOutpayment contains the actual outgoing payment instrument.</span>
            <span class="comment">//</span>
            <span class="keyword">const</span> std::string str_outpmt_server =
                <a class="code" href="class_o_t_a_p_i___wrap.html#a38c7e7d4b3fc44afeabbd5d2b366355a">OTAPI_Wrap::GetNym_OutpaymentsServerIDByIndex</a>(str_nym_id, nCurrentOutpayment);
            <span class="comment">// ----------------------------------</span>
            <span class="keyword">const</span> std::string str_outpmt_recipientID =
                <a class="code" href="class_o_t_a_p_i___wrap.html#a721451913a7bd776050c2de68530060e">OTAPI_Wrap::GetNym_OutpaymentsRecipientIDByIndex</a>(str_nym_id, nCurrentOutpayment);
            <span class="comment">// ----------------------------------</span>
            <span class="comment">// str_outpmt_server is the server for this outpayment.</span>
            <span class="comment">// But is that server on our list of servers that we care about?</span>
            <span class="comment">// Let&#39;s see if that server is on m_servers (otherwise we can skip it.)</span>
            <span class="comment">// Also, let&#39;s do the same for asset types.</span>
            <span class="comment">//</span>
            list_of_strings::iterator it_server = std::find(m_servers.begin(), m_servers.end(), str_outpmt_server);

            <span class="keywordflow">if</span> (it_server != m_servers.end()) <span class="comment">// Found the serverID on the list of servers we care about.</span>
            {
                <span class="comment">// ---------------------------------------------------</span>
                <span class="comment">// TODO OPTIMIZE: instead of looking up the Nym&#39;s name every time, look it</span>
                <span class="comment">// up ONCE when first adding the NymID. Add it to a map, instead of a list,</span>
                <span class="comment">// and add the Nym&#39;s name as the second item in the map&#39;s pair.</span>
                <span class="comment">// (Just like I already did with the asset type.)</span>
                <span class="comment">//</span>
                <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_outpmt_recipientID, &amp;(*it_server))), strNameTemp;
                std::string  str_name;

                <span class="keywordflow">if</span> (strName.Exists())
                    strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                <span class="keywordflow">else</span>
                    strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_outpmt_recipientID.c_str());

                str_name = strNameTemp.Get();
                <span class="comment">// ---------------------------------------------------</span>
                <a class="code" href="class_o_t_string.html">OTString</a> strMemo;
                <span class="keywordflow">if</span> (theOutPayment.GetMemo(strMemo))
                {
                    str_memo = strMemo.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                }
                <span class="comment">// ----------------------------------</span>
                <span class="comment">// For the &quot;date&quot; on this record we&#39;re using the &quot;valid from&quot; date on the instrument.</span>
                std::string str_date = <span class="stringliteral">&quot;0&quot;</span>;
                <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> tFrom = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;
                <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> tTo = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;

                <span class="keywordflow">if</span> (theOutPayment.GetValidFrom(tFrom))
                {
                    <span class="keyword">const</span> uint64_t lFrom = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tFrom);
                    <a class="code" href="class_o_t_string.html">OTString</a> strFrom;
                    strFrom.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lFrom);
                    str_date = strFrom.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                }
                theOutPayment.GetValidTo(tTo);
                <span class="comment">// ---------------------------------------------------</span>
                <span class="comment">// Instrument type (cheque, voucher, etc)</span>
                <span class="comment">//</span>
                <span class="keywordtype">int</span> nType = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (theOutPayment.GetType());

                <span class="keyword">const</span> std::string &amp; str_type = <a class="code" href="_o_t_record_8hpp.html#aad2c87d02cf1bd05c6f519117deb93d9">OTRecord_GetTypeString</a>(nType);
                <span class="comment">// ---------------------------------------------------</span>
                <span class="comment">// CREATE A OTRecord AND POPULATE IT...</span>
                <span class="comment">//</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: ADDED: pending outgoing instrument (str_type: %s)\n&quot;</span>,
                               __FUNCTION__, str_type.c_str());

                <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_Record(<span class="keyword">new</span> <a class="code" href="class_o_t_record.html">OTRecord</a>(*it_server,
                                                           *p_str_asset_type,
                                                           *p_str_asset_name,
                                                            str_nym_id,    <span class="comment">// This is the Nym WHOSE BOX IT IS.</span>
                                                           *p_str_account, <span class="comment">// This is the Nym&#39;s account according to the payment instrument, IF that account was found on our list of accounts we care about. Or it&#39;s blank if no account was found on the payment instrument.</span>
                                                           <span class="comment">// Everything above this line, it stores a reference to an external string.</span>
                                                           <span class="comment">// -----------------------------</span>
                                                           <span class="comment">// Everything below this line, it makes its own internal copy of the string.</span>
                                                           str_name, <span class="comment">// name of recipient (since its in outpayments box.)</span>
                                                           str_date, <span class="comment">// the &quot;valid from&quot; date on the instrument.</span>
                                                           str_amount,
                                                           str_type, <span class="comment">// cheque, voucher, smart contract, etc</span>
                                                           <span class="keyword">true</span>,   <span class="comment">//bIsPending=true since its in the outpayments box.</span>
                                                           <span class="keyword">true</span>,   <span class="comment">//bIsOutgoing=true. Otherwise it&#39;d be in record box already.</span>
                                                           <span class="keyword">false</span>,<span class="comment">//IsRecord</span>
                                                           <span class="keyword">false</span>,<span class="comment">//IsReceipt</span>
                                                           <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2da6df8bc1fa86af318441b6d9b44884379">OTRecord::Instrument</a>
                                                           ));
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetContents(strOutpayment.Get());
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetOtherNymID(str_outpmt_recipientID);
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_memo.empty())
                    sp_Record-&gt;SetMemo(str_memo);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetDateRange(tFrom, tTo);
                sp_Record-&gt;SetBoxIndex(static_cast&lt;int&gt;(nCurrentOutpayment));
                <span class="comment">// -------------------------------------------------</span>
                int64_t lTransNum = 0;
                theOutPayment.GetOpeningNum(lTransNum, theNymID);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetTransactionNum(lTransNum);
                m_contents.push_back(sp_Record);
            }
            <span class="keywordflow">else</span> <span class="comment">// the server for this outpayment is not on the list of servers we care about. Skip this outpayment.</span>
            {
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Skipping outgoing instrument (we don&#39;t care about server %s)\n&quot;</span>,
                               __FUNCTION__, str_outpmt_server.c_str());
                <span class="keywordflow">continue</span>;
            }
        } <span class="comment">// for outpayments.</span>
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// For each Nym, loop through his MAIL box.</span>
        <span class="comment">//</span>
        <span class="keyword">const</span> int32_t nMailCount  = <a class="code" href="class_o_t_a_p_i___wrap.html#abee93614f4a19e0461a51981d2004044">OTAPI_Wrap::GetNym_MailCount</a>(str_nym_id);
        <span class="keywordflow">for</span> ( int32_t nCurrentMail = 0; nCurrentMail &lt; nMailCount; ++nCurrentMail)
        {
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Mail index: %d\n&quot;</span>, __FUNCTION__, nCurrentMail);
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="class_o_t_message.html">OTMessage</a> * pMsg = pNym-&gt;<a class="code" href="class_o_t_pseudonym.html#a41d4a62c9e863fa982c7b4899bfcd3cb">GetMailByIndex</a>(static_cast&lt;int&gt;(nCurrentMail));
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pMsg);
            <span class="comment">// ------------------------------------------------</span>
            <span class="keyword">const</span> std::string str_mail_server =
                <a class="code" href="class_o_t_a_p_i___wrap.html#a7f74f9dfbd1b856204ebc854e0c51d94">OTAPI_Wrap::GetNym_MailServerIDByIndex</a>(str_nym_id, nCurrentMail);
            <span class="comment">// ----------------------------------</span>
            <span class="keyword">const</span> std::string str_mail_senderID =
                <a class="code" href="class_o_t_a_p_i___wrap.html#a40cb3129dbf4f5af024fbc826c630a49">OTAPI_Wrap::GetNym_MailSenderIDByIndex</a>(str_nym_id, nCurrentMail);
            <span class="comment">// ----------------------------------</span>
            <span class="comment">// str_mail_server is the server for this mail.</span>
            <span class="comment">// But is that server on our list of servers that we care about?</span>
            <span class="comment">// Let&#39;s see if that server is on m_servers (otherwise we can skip it.)</span>
            <span class="comment">//</span>
            list_of_strings::iterator it_server = std::find(m_servers.begin(), m_servers.end(), str_mail_server);

            <span class="keywordflow">if</span> (it_server != m_servers.end()) <span class="comment">// Found the serverID on the list of servers we care about.</span>
            {
                <span class="comment">// ---------------------------------------------------</span>
                <span class="comment">// TODO OPTIMIZE: instead of looking up the Nym&#39;s name every time, look it</span>
                <span class="comment">// up ONCE when first adding the NymID. Add it to a map, instead of a list,</span>
                <span class="comment">// and add the Nym&#39;s name as the second item in the map&#39;s pair.</span>
                <span class="comment">// (Just like I already did with the asset type.)</span>
                <span class="comment">//</span>
                <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_mail_senderID, &amp;(*it_server))), strNameTemp;
                std::string  str_name;

                <span class="keywordflow">if</span> (strName.Exists())
                    strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), strName.Get());
                <span class="keywordflow">else</span>
                    strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), str_mail_senderID.c_str());

                str_name = strNameTemp.Get(); <span class="comment">// Todo: lookup the name in address book also.</span>
                <span class="comment">// ---------------------------------------------------</span>
                <span class="keyword">const</span> std::string * p_str_asset_type = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ASSET TYPE</span>
                <span class="keyword">const</span> std::string * p_str_asset_name = &amp;OTRecordList::s_blank; <span class="comment">// asset type display name.</span>
                <span class="keyword">const</span> std::string * p_str_account    = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ACCOUNT</span>

                std::string str_amount; <span class="comment">// There IS NO amount, on mail. (So we leave this empty.)</span>

                uint64_t lDate = pMsg-&gt;<a class="code" href="class_o_t_message.html#a3054731e37b5da75a93dedd4c77ee548">m_lTime</a>;
                <a class="code" href="class_o_t_string.html">OTString</a> strDate;
                strDate.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lDate);
                <span class="keyword">const</span> std::string str_date(strDate.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
                <span class="comment">// ---------------------------------------------------</span>
                <span class="comment">// CREATE A OTRecord AND POPULATE IT...</span>
                <span class="comment">//</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: ADDED: incoming mail.\n&quot;</span>, __FUNCTION__);

                <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_Record(<span class="keyword">new</span> <a class="code" href="class_o_t_record.html">OTRecord</a>(*it_server,
                                                           *p_str_asset_type,
                                                           *p_str_asset_name,
                                                           str_nym_id,     <span class="comment">// This is the Nym WHOSE BOX IT IS.</span>
                                                           *p_str_account, <span class="comment">// This is the Nym&#39;s account according to the payment instrument, IF that account was found on our list of accounts we care about. Or it&#39;s blank if no account was found on the payment instrument.</span>
                                                           <span class="comment">// Everything above this line, it stores a reference to an external string.</span>
                                                           <span class="comment">// -----------------------------</span>
                                                           <span class="comment">// Everything below this line, it makes its own internal copy of the string.</span>
                                                           str_name, <span class="comment">// name of sender (since its in incoming mail box.)</span>
                                                           str_date, <span class="comment">// How do we get the date from a mail?</span>
                                                           str_amount,
                                                           OTRecordList::s_message_type, <span class="comment">// &quot;message&quot;</span>
                                                           <span class="keyword">false</span>, <span class="comment">//bIsPending=false since its already received.</span>
                                                           <span class="keyword">false</span>, <span class="comment">//bIsOutgoing=false. It&#39;s incoming mail, not outgoing mail.</span>
                                                           <span class="keyword">false</span>, <span class="comment">//IsRecord</span>
                                                           <span class="keyword">false</span>, <span class="comment">//IsReceipt</span>
                                                           <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2daa1499facbc577854221564f426795a9e">OTRecord::Mail</a>
                                                           ));
                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strMail(<a class="code" href="class_o_t_a_p_i___wrap.html#a004c8bd1edb35081e16bda52ded7038a">OTAPI_Wrap::GetNym_MailContentsByIndex</a>(str_nym_id, nCurrentMail));
                sp_Record-&gt;SetContents(strMail.Get());
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetOtherNymID(str_mail_senderID);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetBoxIndex(static_cast&lt;int&gt;(nCurrentMail));
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetDateRange(<a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(pMsg-&gt;<a class="code" href="class_o_t_message.html#a3054731e37b5da75a93dedd4c77ee548">m_lTime</a>), <a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(pMsg-&gt;<a class="code" href="class_o_t_message.html#a3054731e37b5da75a93dedd4c77ee548">m_lTime</a>));
                <span class="comment">// -------------------------------------------------</span>
                m_contents.push_back(sp_Record);
            }
        } <span class="comment">// loop through incoming Mail.</span>
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// Outmail</span>
        <span class="comment">//</span>
        <span class="keyword">const</span> int32_t nOutmailCount   = <a class="code" href="class_o_t_a_p_i___wrap.html#a2bf01a333520cc12fb4be0c0163a0154">OTAPI_Wrap::GetNym_OutmailCount</a>(str_nym_id);
        <span class="keywordflow">for</span> ( int32_t nCurrentOutmail = 0; nCurrentOutmail &lt; nOutmailCount; ++nCurrentOutmail)
        {
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Outmail index: %d\n&quot;</span>, __FUNCTION__, nCurrentOutmail);
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="class_o_t_message.html">OTMessage</a> * pMsg = pNym-&gt;<a class="code" href="class_o_t_pseudonym.html#a126bbb8a3d356a0fd2118c95dfe6cbea">GetOutmailByIndex</a>(static_cast&lt;int&gt;(nCurrentOutmail));
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pMsg);
            <span class="comment">// ------------------------------------------------</span>
            <span class="keyword">const</span> std::string str_mail_server =
                <a class="code" href="class_o_t_a_p_i___wrap.html#ab7b4f640fcb700924578894d1d1a0d9d">OTAPI_Wrap::GetNym_OutmailServerIDByIndex</a>(str_nym_id, nCurrentOutmail);
            <span class="comment">// ----------------------------------</span>
            <span class="keyword">const</span> std::string str_mail_recipientID =
                <a class="code" href="class_o_t_a_p_i___wrap.html#a4c2cf6833cabdb3b5c389752c0ced7c0">OTAPI_Wrap::GetNym_OutmailRecipientIDByIndex</a>(str_nym_id, nCurrentOutmail);
            <span class="comment">// ----------------------------------</span>
            <span class="comment">// str_mail_server is the server for this mail.</span>
            <span class="comment">// But is that server on our list of servers that we care about?</span>
            <span class="comment">// Let&#39;s see if that server is on m_servers (otherwise we can skip it.)</span>
            <span class="comment">//</span>
            list_of_strings::iterator it_server = std::find(m_servers.begin(), m_servers.end(), str_mail_server);

            <span class="keywordflow">if</span> (it_server != m_servers.end()) <span class="comment">// Found the serverID on the list of servers we care about.</span>
            {
                <span class="comment">// ---------------------------------------------------</span>
                <span class="comment">// TODO OPTIMIZE: instead of looking up the Nym&#39;s name every time, look it</span>
                <span class="comment">// up ONCE when first adding the NymID. Add it to a map, instead of a list,</span>
                <span class="comment">// and add the Nym&#39;s name as the second item in the map&#39;s pair.</span>
                <span class="comment">// (Just like I already did with the asset type.)</span>
                <span class="comment">//</span>
                <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_mail_recipientID, &amp;(*it_server))), strNameTemp;
                std::string  str_name;

                <span class="keywordflow">if</span> (strName.Exists())
                    strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                <span class="keywordflow">else</span>
                    strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_mail_recipientID.c_str());

                str_name = strNameTemp.Get();
                <span class="comment">// ---------------------------------------------------</span>
                <span class="keyword">const</span> std::string * p_str_asset_type = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ASSET TYPE</span>
                <span class="keyword">const</span> std::string * p_str_asset_name = &amp;OTRecordList::s_blank; <span class="comment">// asset type display name.</span>
                <span class="keyword">const</span> std::string * p_str_account    = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ACCOUNT</span>

                std::string str_amount; <span class="comment">// There IS NO amount, on mail. (So we leave this empty.)</span>

                uint64_t lDate = pMsg-&gt;<a class="code" href="class_o_t_message.html#a3054731e37b5da75a93dedd4c77ee548">m_lTime</a>;
                <a class="code" href="class_o_t_string.html">OTString</a> strDate;
                strDate.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lDate);
                <span class="keyword">const</span> std::string str_date(strDate.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
                <span class="comment">// ---------------------------------------------------</span>
                <span class="comment">// CREATE A OTRecord AND POPULATE IT...</span>
                <span class="comment">//</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: ADDED: sent mail.\n&quot;</span>, __FUNCTION__);

                <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_Record(<span class="keyword">new</span> <a class="code" href="class_o_t_record.html">OTRecord</a>(*it_server,
                                                           *p_str_asset_type,
                                                           *p_str_asset_name,
                                                           str_nym_id,     <span class="comment">// This is the Nym WHOSE BOX IT IS.</span>
                                                           *p_str_account, <span class="comment">// This is the Nym&#39;s account according to the payment instrument, IF that account was found on our list of accounts we care about. Or it&#39;s blank if no account was found on the payment instrument.</span>
                                                           <span class="comment">// Everything above this line, it stores a reference to an external string.</span>
                                                           <span class="comment">// -----------------------------</span>
                                                           <span class="comment">// Everything below this line, it makes its own internal copy of the string.</span>
                                                           str_name, <span class="comment">// name of recipient (since its in outgoing mail box.)</span>
                                                           str_date, <span class="comment">// How do we get the date from a mail?</span>
                                                           str_amount,
                                                           OTRecordList::s_message_type, <span class="comment">// &quot;message&quot;</span>
                                                           <span class="keyword">false</span>, <span class="comment">//bIsPending=false since its already sent.</span>
                                                           <span class="keyword">true</span>,  <span class="comment">//bIsOutgoing=true. It&#39;s OUTGOING mail.</span>
                                                           <span class="keyword">false</span>, <span class="comment">//IsRecord (it&#39;s not in the record box.)</span>
                                                           <span class="keyword">false</span>, <span class="comment">//IsReceipt</span>
                                                           <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2daa1499facbc577854221564f426795a9e">OTRecord::Mail</a>
                                                           ));
                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strOutmail(<a class="code" href="class_o_t_a_p_i___wrap.html#ac602409047d0d0a6896f1e403b280c52">OTAPI_Wrap::GetNym_OutmailContentsByIndex</a>(str_nym_id, nCurrentOutmail));
                sp_Record-&gt;SetContents(strOutmail.Get());
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetBoxIndex(static_cast&lt;int&gt;(nCurrentOutmail));
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetOtherNymID(str_mail_recipientID);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetDateRange(<a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(pMsg-&gt;<a class="code" href="class_o_t_message.html#a3054731e37b5da75a93dedd4c77ee548">m_lTime</a>), <a class="code" href="_o_t_common_8hpp.html#a5c0893ffd83818f1c3c6b3b7ae92da13">OTTimeGetTimeFromSeconds</a>(pMsg-&gt;<a class="code" href="class_o_t_message.html#a3054731e37b5da75a93dedd4c77ee548">m_lTime</a>));
                <span class="comment">// -------------------------------------------------</span>
                m_contents.push_back(sp_Record);
            }
        } <span class="comment">// loop through outgoing Mail.</span>
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// For each nym, for each server, loop through its payments inbox and record box.</span>
        <span class="comment">//</span>
        <span class="keywordtype">int</span> nServerIndex = -1;
        <a class="code" href="_o_t_storage_8hpp.html#a4a94c3435a932ed34e5755f3f472547c">FOR_EACH_IT</a>(<a class="code" href="_o_t_record_list_8hpp.html#a1172b459639314113a533a64309eb319">list_of_strings</a>, m_servers, it_server)
        {
            ++nServerIndex;
            <span class="comment">// --------------------------</span>
            <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theServerID(*it_server);
            <a class="code" href="class_o_t_server_contract.html">OTServerContract</a> * pServer = pWallet-&gt;<a class="code" href="class_o_t_wallet.html#ae897619f652a0d3d9fba99a8bc747993">GetServerContract</a>(theServerID);
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pServer);
            <span class="comment">// ------------------------------------------------</span>
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strServerID(theServerID);
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Server %d, ID: %s\n&quot;</span>, __FUNCTION__, nServerIndex, strServerID.Get());
            <span class="comment">// ------------------------------------------------</span>
            <span class="comment">// OPTIMIZE FYI:</span>
            <span class="comment">// The &quot;NoVerify&quot; version is much faster, but you will lose the ability to get the</span>
            <span class="comment">// sender/recipient name from the receipts in the box. The code will, however, work</span>
            <span class="comment">// either way.</span>
            <span class="comment">//</span>
            <a class="code" href="class_o_t_ledger.html">OTLedger</a> * pInbox = m_bRunFast ? <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a8e02cb186854f0b325c4c55da69f2e55">LoadPaymentInboxNoVerify</a>(theServerID, theNymID) :
                                             <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a5077987cf25f441923c88cb51b3d940a">LoadPaymentInbox</a>        (theServerID, theNymID);
            <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTLedger&gt;</a> theInboxAngel(pInbox);

            int32_t  nIndex = (-1);
            <span class="comment">// It loaded up, so let&#39;s loop through it.</span>
            <span class="keywordflow">if</span> (NULL != pInbox) <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_ledger_8hpp.html#a1823ddf57c0de6495aa8ec5da7f1b8f7">mapOfTransactions</a>, pInbox-&gt;GetTransactionMap())
            {
                <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * pBoxTrans = (*it).second;
                <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pBoxTrans);
                <span class="comment">// ------------------------------</span>
                ++nIndex; <span class="comment">// 0 on first iteration.</span>
                <span class="comment">// ------------------------------------------------</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Incoming payment: %d\n&quot;</span>, __FUNCTION__, nIndex);
                <span class="comment">// ------------------------------------------------</span>
                std::string  str_name; <span class="comment">// name of sender (since its in the payments inbox.)</span>
                std::string  str_sender_nym_id;
                std::string  str_sender_acct_id;

                <span class="keywordflow">if</span> (<span class="keyword">false</span> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>())
                {
                    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theSenderID;

                    <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a1091822e3072f014a8b2f64b93917ca7" title="For display purposes. The &quot;ref #&quot; you actually display (versus the one you use internally) might chan...">GetSenderUserIDForDisplay</a>(theSenderID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strSenderID(theSenderID);
                        str_sender_nym_id = strSenderID.Get();

                        <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_sender_nym_id, &amp;(*it_server))), strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), strName.Get());
                        <span class="keywordflow">else</span>
                            strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), str_sender_nym_id.c_str());

                        str_name = strNameTemp.Get(); <span class="comment">// Todo: lookup the name in address book also.</span>
                    }

                    theSenderID.<a class="code" href="class_o_t_data.html#aab9a5758e85597ef1d7250bcf2cc56a6">Release</a>();

                    <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#acf66d9f8f5d3a6e4ee0a418a41db6019">GetSenderAcctIDForDisplay</a>(theSenderID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strSenderID(theSenderID);
                        str_sender_acct_id = strSenderID.Get();
                    }
                }
                <span class="comment">// ------------------------------</span>
                <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>  tValidFrom = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>, tValidTo = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;
                <span class="comment">// ----------------------------------</span>
                std::string str_date    = <span class="stringliteral">&quot;0&quot;</span>; <span class="comment">// the &quot;date signed&quot; on the transaction receipt.</span>
                <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>      tDateSigned = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#afb069b9f7ab72f90e9e42aed0ba3b17c">GetDateSigned</a>();

                <span class="keywordflow">if</span> (tDateSigned &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
                {
                    tValidFrom = tDateSigned;
                    <span class="keyword">const</span> uint64_t lDateSigned = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tDateSigned);
                    <a class="code" href="class_o_t_string.html">OTString</a> strDateSigned;
                    strDateSigned.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lDateSigned);
                    str_date = strDateSigned.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                }
                <span class="comment">// ----------------------------------</span>
                <span class="keyword">const</span> std::string * p_str_asset_type = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ASSET TYPE</span>
                <span class="keyword">const</span> std::string * p_str_asset_name = &amp;OTRecordList::s_blank; <span class="comment">// asset type display name.</span>
                <span class="comment">// ----------------------------------</span>
                std::string str_amount;   <span class="comment">// &lt;========== AMOUNT</span>
                std::string str_type;     <span class="comment">// Instrument type.</span>
                std::string str_memo;
                <a class="code" href="class_o_t_string.html">OTString</a>    strContents; <span class="comment">// Instrument contents.</span>

                <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>())
                {
                    str_type = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>(); <span class="comment">// instrumentNotice, etc.</span>
                    <span class="comment">// --------------------------------------------------</span>
                    int64_t lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>();

                    <span class="keywordflow">if</span> (0 != lAmount)
                    {
                        <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                        strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                        str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                    }
                }
                <span class="keywordflow">else</span> <span class="comment">// NOT abbreviated. (Full box receipt is already loaded.)</span>
                {
                    <a class="code" href="class_o_t_payment.html">OTPayment</a> * pPayment = pInbox-&gt;GetInstrument(*pNym,
                                                                 nIndex);     <span class="comment">// ===&gt; Returns financial instrument by index.</span>
                    <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTPayment&gt;</a> thePaymentAngel(pPayment);
                    <span class="comment">// ------------------------------</span>
                    <span class="keywordflow">if</span> (NULL == pPayment) <span class="comment">// then we treat it like it&#39;s abbreviated.</span>
                    {
                        str_type = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>(); <span class="comment">// instrumentNotice, etc.</span>
                        <span class="comment">// --------------------------------------------------</span>
                        int64_t lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>();

                        <span class="keywordflow">if</span> (0 == lAmount)
                            lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a01fdc95811465496f953c5a50dcef6">GetReceiptAmount</a>();
                        <span class="comment">// -----------------------------------------</span>
                        <span class="keywordflow">if</span> (0 != lAmount)
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                            strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                            str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                    }
                    <span class="comment">// ---------------------------------------------------</span>
                    <span class="comment">// We have pPayment, the instrument accompanying the receipt in the payments inbox.</span>
                    <span class="comment">//</span>
                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a1ee95406f9d221ae4a57783422d52156">SetTempValues</a>())
                    {
                        <span class="comment">// ----------------------------------</span>
                        pPayment-&gt;<a class="code" href="class_o_t_payment.html#af3c3ed5823d48d9cf86463987f67ddae">GetValidFrom</a>(tValidFrom);
                        pPayment-&gt;<a class="code" href="class_o_t_payment.html#a11dbba988d5da835179885043b4c3979">GetValidTo</a>  (tValidTo);

                        <span class="keywordflow">if</span> (tValidFrom &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
                        {
                            <span class="keyword">const</span> uint64_t lFrom = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tValidFrom);
                            <a class="code" href="class_o_t_string.html">OTString</a> strFrom;
                            strFrom.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lFrom);
                            str_date = strFrom.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                        <span class="comment">// ----------------------------------</span>
                        <a class="code" href="class_o_t_string.html">OTString</a> strMemo;
                        <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a76ed76e62e9b57487f08a6f1296260ab">GetMemo</a>(strMemo))
                        {
                            str_memo = strMemo.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                        <span class="comment">// ----------------------------------</span>
                        pPayment-&gt;<a class="code" href="class_o_t_payment.html#a1d067b54e63054b1021ef5f187911fab">GetPaymentContents</a>(strContents);
                        <span class="comment">// -----------------------------</span>
                        <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theAssetTypeID, theSenderAcctID;

                        <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a37342f7cb3d3fa42afb8531f4989d552">GetAssetTypeID</a>(theAssetTypeID))
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAssetTypeID);
                            <span class="keyword">const</span> std::string str_inpmt_asset(strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>()); <span class="comment">// The asset type we found on the payment (if we found anything.)</span>
                            <span class="comment">// -----------------------------</span>
                            map_of_strings::iterator it_asset = m_assets.find(str_inpmt_asset);
                            <span class="comment">// -----------------------------</span>
                            <span class="keywordflow">if</span> (it_asset != m_assets.end()) <span class="comment">// Found it on the map of asset types we care about.</span>
                            {
                                p_str_asset_type = &amp;(it_asset-&gt;first);   <span class="comment">// Set the asset type ID.</span>
                                p_str_asset_name = &amp;(it_asset-&gt;second);  <span class="comment">// The CurrencyTLA. Examples: USD, BTC, etc.</span>
                            }
                            <span class="keywordflow">else</span>
                            {
                                <span class="comment">// There was definitely an asset type on the instrument, and it definitely</span>
                                <span class="comment">// did not match any of the assets that we care about.</span>
                                <span class="comment">// Therefore, skip.</span>
                                <span class="comment">//</span>
                                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Skipping: Incoming payment (we don&#39;t care about asset %s)\n&quot;</span>,
                                              __FUNCTION__, str_inpmt_asset.c_str());
                                <span class="keywordflow">continue</span>;
                            }
                        }
                        <span class="comment">// --------------------------------------------------</span>
                        <span class="keywordflow">if</span> (str_sender_acct_id.empty() &amp;&amp; pPayment-&gt;<a class="code" href="class_o_t_payment.html#af197690691464b57f9d9224357444351">GetSenderAcctIDForDisplay</a>(theSenderAcctID))
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theSenderAcctID);
                            str_sender_acct_id = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                        <span class="comment">// --------------------------------------------------</span>
                        <span class="comment">// By this point, p_str_asset_type and p_str_asset_name are definitely set.</span>
                        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_type); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
                        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_name); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
                        <span class="comment">// ---------------------------------------------------</span>
                        <span class="comment">// Instrument type (cheque, voucher, etc)</span>
                        <span class="keywordtype">int</span> nType = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a750b001a080812918d7c68bbc85c3ff3">GetType</a>());

                        str_type = <a class="code" href="_o_t_record_8hpp.html#aad2c87d02cf1bd05c6f519117deb93d9">OTRecord_GetTypeString</a>(nType);
                        <span class="comment">// ---------------------------------------------------</span>
                        int64_t lAmount = 0;

                        <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#acb3588ce12579879e64d65ed69afd5f6">GetAmount</a>(lAmount))
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                            strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                            str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                    }
                }
                <span class="comment">// ------------------------------</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: ADDED: pending incoming payment (str_type: %s)\n&quot;</span>,
                               __FUNCTION__, str_type.c_str());

                <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_Record(<span class="keyword">new</span> <a class="code" href="class_o_t_record.html">OTRecord</a>(*it_server,
                                                           *p_str_asset_type,
                                                           *p_str_asset_name,
                                                           str_nym_id,     <span class="comment">// This is the Nym WHOSE BOX IT IS.</span>
                                                           OTRecordList::s_blank, <span class="comment">// This is the Nym&#39;s account for this box. (Blank for payments inbox.)</span>
                                                           <span class="comment">// Everything above this line, it stores a reference to an external string.</span>
                                                           <span class="comment">// -----------------------------</span>
                                                           <span class="comment">// Everything below this line, it makes its own internal copy of the string.</span>
                                                           str_name, <span class="comment">// name of sender (since its in the inbox.)</span>
                                                           str_date, <span class="comment">// the &quot;valid from&quot; date on the instrument.</span>
                                                           str_amount,
                                                           str_type, <span class="comment">// pending, chequeReceipt, etc.</span>
                                                           <span class="keyword">true</span>,     <span class="comment">// I believe all incoming &quot;payment inbox&quot; items are pending. (Cheques waiting to be cashed, smart contracts waiting to be signed, etc.)</span>
                                                           <span class="keyword">false</span>,    <span class="comment">// bIsOutgoing=false. (Since this is the payment INbox, nothing is outgoing...)</span>
                                                           <span class="keyword">false</span>, <span class="comment">//bIsRecord</span>
                                                           <span class="keyword">false</span>, <span class="comment">//bIsReceipt</span>
                                                           <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2da6df8bc1fa86af318441b6d9b44884379">OTRecord::Instrument</a>));
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (strContents.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
                    sp_Record-&gt;SetContents(strContents.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetDateRange(tValidFrom, tValidTo);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetBoxIndex(static_cast&lt;int&gt;(nIndex));
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_memo.empty())
                    sp_Record-&gt;SetMemo(str_memo);
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_sender_nym_id.empty())
                    sp_Record-&gt;SetOtherNymID(str_sender_nym_id);
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_sender_acct_id.empty())
                    sp_Record-&gt;SetOtherAccountID(str_sender_acct_id);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetTransNumForDisplay(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a4463450cc735aea9b924011f073bb3">GetReferenceNumForDisplay</a>());
                sp_Record-&gt;SetTransactionNum(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction_type.html#aa204b21b7f498389f746742c1d2007fa">GetTransactionNum</a>());

                m_contents.push_back(sp_Record);
                <span class="comment">// ------------------------------</span>

            } <span class="comment">// looping through inbox.</span>
            <span class="keywordflow">else</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;%s: Failed loading payments inbox. (Probably just doesn&#39;t exist yet.)\n&quot;</span>, __FUNCTION__);
            <span class="comment">// ------------------------------------------------</span>
            nIndex = (-1);

            <span class="comment">// Also loop through its record box. For this record box, pass the USER_ID twice,</span>
            <span class="comment">// since it&#39;s the recordbox for the Nym.</span>
            <span class="comment">// OPTIMIZE FYI: m_bRunFast impacts run speed here.</span>
            <a class="code" href="class_o_t_ledger.html">OTLedger</a> * pRecordbox = m_bRunFast ? <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a8c288f48dcdc98a6ae02c03e6452c438">LoadRecordBoxNoVerify</a>(theServerID, theNymID, theNymID) : <span class="comment">// twice.</span>
                                                 <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a318f160f9a43ac68afcf415ff51ae267">LoadRecordBox</a>        (theServerID, theNymID, theNymID);
            <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTLedger&gt;</a> theRecordBoxAngel(pRecordbox);

            <span class="comment">// It loaded up, so let&#39;s loop through it.</span>
            <span class="keywordflow">if</span> (NULL != pRecordbox) <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_ledger_8hpp.html#a1823ddf57c0de6495aa8ec5da7f1b8f7">mapOfTransactions</a>, pRecordbox-&gt;<a class="code" href="class_o_t_ledger.html#aa71b6540e2948a36e3c7d3e7d14547a5">GetTransactionMap</a>())
            {
                <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * pBoxTrans = (*it).second;
                <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pBoxTrans);
                <span class="comment">// ------------------------------</span>
                <span class="keywordtype">bool</span> bOutgoing = <span class="keyword">false</span>;
                <span class="comment">// ----------------------------------</span>
                ++nIndex; <span class="comment">// 0 on first iteration.</span>
                <span class="comment">// ------------------------------------------------</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Payment RECORD index: %d\n&quot;</span>, __FUNCTION__, nIndex);
                <span class="comment">// ------------------------------------------------</span>
                std::string  str_name; <span class="comment">// name of sender OR recipient (depending on whether it was originally incoming or outgoing.)</span>
                std::string  str_other_nym_id;
                std::string  str_other_acct_id;

                <span class="keywordflow">if</span> (<span class="keyword">false</span> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>())
                {
                    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theSenderID,    theSenderAcctID;
                    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theRecipientID, theRecipientAcctID;

                    <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a1091822e3072f014a8b2f64b93917ca7" title="For display purposes. The &quot;ref #&quot; you actually display (versus the one you use internally) might chan...">GetSenderUserIDForDisplay</a>(theSenderID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strSenderID  (theSenderID);
                        <span class="keyword">const</span> std::string str_sender_id(strSenderID.Get());

                        <span class="comment">// Usually, Nym is the RECIPIENT. Sometimes he&#39;s the sender.</span>
                        <span class="comment">// Either way, we want the OTHER ID (the other Nym) for display.</span>
                        <span class="comment">// So here, if Nym&#39;s CLEARLY the sender, then we want the RECIPIENT.</span>
                        <span class="comment">// Whereas if Nym were the recipient, then we&#39;d want the SENDER. (For display.)</span>
                        <span class="comment">//</span>
                        <span class="keywordflow">if</span> (0 == str_nym_id.compare(str_sender_id)) <span class="comment">// str_nym_id IS str_sender_id. (Therefore we want recipient.)</span>
                        {
                            bOutgoing = <span class="keyword">true</span>; <span class="comment">// if Nym is the sender, then it must have been outgoing.</span>

                            <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID))
                            {
                                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientID(theRecipientID);
                                <span class="keyword">const</span> std::string str_recipient_id(strRecipientID.Get());

                                <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_recipient_id, &amp;(*it_server))), strNameTemp;

                                <span class="keywordflow">if</span> (strName.Exists())
                                    strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                                <span class="keywordflow">else</span>
                                    strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_id.c_str());

                                str_name         = strNameTemp.Get(); <span class="comment">// Todo: lookup the name in address book also.</span>
                                str_other_nym_id = str_recipient_id;
                                <span class="comment">// -------------------------------------------</span>
                                <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                                {
                                    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientAcctID(theRecipientAcctID);
                                    str_other_acct_id = strRecipientAcctID.Get();
                                }
                            }
                        }
                        <span class="keywordflow">else</span> <span class="comment">// str_nym_id IS NOT str_sender_id. (Therefore we want sender.)</span>
                        {    <span class="comment">// In this case, some OTHER Nym is the sender, so it must have been incoming. (And bOutgoing is already false.)</span>

                            <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_sender_id, &amp;(*it_server))), strNameTemp;

                            <span class="keywordflow">if</span> (strName.Exists())
                                strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), strName.Get());
                            <span class="keywordflow">else</span>
                                strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), str_sender_id.c_str());

                            str_name         = strNameTemp.Get(); <span class="comment">// Todo: lookup the name in address book also.</span>
                            str_other_nym_id = str_sender_id;
                            <span class="comment">// -------------------------------------------</span>
                            <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#acf66d9f8f5d3a6e4ee0a418a41db6019">GetSenderAcctIDForDisplay</a>(theSenderAcctID))
                            {
                                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strSenderAcctID(theSenderAcctID);
                                str_other_acct_id = strSenderAcctID.Get();
                            }
                        }
                    }
                    <span class="comment">// In this block below, we already KNOW GetSenderUserIDForDisplay is EMPTY.</span>
                    <span class="comment">// (So it&#39;s &quot;recipient or bust.&quot;)</span>
                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientID(theRecipientID);
                        <span class="keyword">const</span> std::string str_recipient_id(strRecipientID.Get());

                        <span class="keywordflow">if</span> (0 != str_nym_id.compare(str_recipient_id)) <span class="comment">// str_nym_id is NOT str_recipient_id. (Therefore we want str_recipient_id.)</span>
                        {
                            <span class="comment">// If Nym is not the recipient, then he must be the sender.</span>
                            <span class="comment">// (Therefore it must be outgoing.)</span>
                            bOutgoing = <span class="keyword">true</span>;

                            <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_recipient_id, &amp;(*it_server))), strNameTemp;

                            <span class="keywordflow">if</span> (strName.Exists())
                                strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                            <span class="keywordflow">else</span>
                                strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_id.c_str());

                            str_name         = strNameTemp.Get(); <span class="comment">// Todo: lookup the name in address book also.</span>
                            str_other_nym_id = str_recipient_id;
                            <span class="comment">// -------------------------------------------</span>
                            <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                            {
                                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientAcctID(theRecipientAcctID);
                                str_other_acct_id = strRecipientAcctID.Get();
                            }
                        }
                    }
                } <span class="comment">// if not abbreviated.</span>
                <span class="comment">// ------------------------------</span>
                <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> tValidFrom = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>, tValidTo = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;
                <span class="comment">// ------------------------------</span>
                std::string str_date    = <span class="stringliteral">&quot;0&quot;</span>; <span class="comment">// the &quot;date signed&quot; on the transaction receipt.</span>
                <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>      tDateSigned = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#afb069b9f7ab72f90e9e42aed0ba3b17c">GetDateSigned</a>();

                <span class="keywordflow">if</span> (tDateSigned &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
                {
                    tValidFrom = tDateSigned;
                    <span class="keyword">const</span> uint64_t lDateSigned = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tDateSigned);
                    <a class="code" href="class_o_t_string.html">OTString</a> strDateSigned;
                    strDateSigned.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lDateSigned);
                    str_date = strDateSigned.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                }
                <span class="comment">// ----------------------------------</span>
                <span class="keyword">const</span> std::string * p_str_asset_type = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ASSET TYPE</span>
                <span class="keyword">const</span> std::string * p_str_asset_name = &amp;OTRecordList::s_blank; <span class="comment">// asset type display name.</span>
                <span class="keyword">const</span> std::string * p_str_account    = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ACCOUNT</span>
                <span class="comment">// ----------------------------------</span>
                std::string str_amount;  <span class="comment">// &lt;========== AMOUNT</span>
                std::string str_type;    <span class="comment">// Instrument type.</span>
                std::string str_memo;    <span class="comment">// Instrument memo (if applicable.)</span>
                <a class="code" href="class_o_t_string.html">OTString</a>    strContents; <span class="comment">// Instrument contents.</span>

                <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>())
                {
                    str_type = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>(); <span class="comment">// instrumentNotice, etc.</span>
                    <span class="comment">// --------------------------------------------------</span>
                    int64_t lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>();

                    <span class="keywordflow">if</span> (0 != lAmount)
                    {
                        <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                        strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                        str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                    }
                }
                <span class="keywordflow">else</span> <span class="comment">// NOT abbreviated. (Full box receipt is already loaded.)</span>
                {
                    <a class="code" href="class_o_t_payment.html">OTPayment</a> * pPayment = pRecordbox-&gt;<a class="code" href="class_o_t_ledger.html#a114a4d31098807d6cb873a7343a407ae">GetInstrument</a>(*pNym,
                                                                     nIndex);     <span class="comment">// ===&gt; Returns financial instrument by index.</span>
                    <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTPayment&gt;</a> thePaymentAngel(pPayment);
                    <span class="comment">// ------------------------------</span>
                    <span class="keywordflow">if</span> (NULL == pPayment) <span class="comment">// then we treat it like it&#39;s abbreviated.</span>
                    {
                        str_type = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>(); <span class="comment">// instrumentNotice, etc.</span>
                        <span class="comment">// --------------------------------------------------</span>
                        int64_t lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>();

                        <span class="keywordflow">if</span> (0 != lAmount)
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                            strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                            str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                    }
                    <span class="comment">// ---------------------------------------------------</span>
                    <span class="comment">// We have pPayment, the instrument accompanying the receipt in the payments recordbox.</span>
                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a1ee95406f9d221ae4a57783422d52156">SetTempValues</a>())
                    {
                        <span class="comment">// ----------------------------------</span>
                        pPayment-&gt;<a class="code" href="class_o_t_payment.html#af3c3ed5823d48d9cf86463987f67ddae">GetValidFrom</a>(tValidFrom);
                        pPayment-&gt;<a class="code" href="class_o_t_payment.html#a11dbba988d5da835179885043b4c3979">GetValidTo</a>  (tValidTo);

                        <span class="keywordflow">if</span> (tValidFrom &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
                        {
                            <span class="keyword">const</span> uint64_t lFrom = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tValidFrom);
                            <a class="code" href="class_o_t_string.html">OTString</a> strFrom;
                            strFrom.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lFrom);
                            str_date = strFrom.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                        <span class="comment">// ----------------------------------</span>
                        pPayment-&gt;<a class="code" href="class_o_t_payment.html#a1d067b54e63054b1021ef5f187911fab">GetPaymentContents</a>(strContents);
                        <span class="comment">// ------------------------------------</span>
                        <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theAccountID;

                        <span class="keywordflow">if</span> (bOutgoing) <span class="comment">// Nym is sender.</span>
                        {
                            <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#af197690691464b57f9d9224357444351">GetSenderAcctIDForDisplay</a>(theAccountID)) <span class="comment">// Since Nym is ME, the Account must be MY acct.</span>
                            {                                            <span class="comment">// (If this record was originally OUTgoing, then the SENDER&#39;s account is MY acct.)</span>
                                <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAccountID);
                                std::string str_outpmt_account = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// The accountID we found on the payment (only applies to outgoing payments.)</span>
                                <span class="comment">// -----------------------------</span>
                                list_of_strings::iterator it_acct = std::find(m_accounts.begin(), m_accounts.end(), str_outpmt_account);
                                <span class="comment">// -----------------------------</span>
                                <span class="keywordflow">if</span> (it_acct != m_accounts.end()) <span class="comment">// Found it on the list of accounts we care about.</span>
                                {
                                    p_str_account = &amp;(*it_acct);
                                }
                                <span class="keywordflow">else</span>
                                {
                                    <span class="comment">// There was definitely an account on the instrument, and it definitely</span>
                                    <span class="comment">// did not match any of the accounts that we care about.</span>
                                    <span class="comment">// Therefore, skip.</span>
                                    <span class="comment">//</span>
                                    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Skipping &#39;sent payment&#39; record. (We don&#39;t care about account %s)\n&quot;</span>,
                                                   __FUNCTION__, str_outpmt_account.c_str());
                                    <span class="keywordflow">continue</span>;
                                }
                                <span class="comment">// -------------------------------------------</span>
                            }
                        }
                        <span class="keywordflow">else</span> <span class="comment">// Nym is recipient.</span>
                        {
                            <span class="comment">// Why is this here? Because if Nym is recipient, let&#39;s say he received an instrumentNotice containing</span>
                            <span class="comment">// a sendUserInstrument message containing an incoming cheque. Well... that incoming cheque (the payload</span>
                            <span class="comment">// on sendUserInstrument message) is ENCRYPTED. Meaning the above calls to pBoxReceipt-&gt;GetSenderAcctID</span>
                            <span class="comment">// on the instrumentNotice transaction will FAIL. One option is to pass pNym into GetSenderAcctID so it</span>
                            <span class="comment">// can decrypt the payload and return the value. But since we already have the payload decrypted here</span>
                            <span class="comment">// (we already have the cheque loaded up here) we can just grab the senderAcctID directly from the cheque.</span>
                            <span class="comment">// That&#39;s why this is here -- because this is where we KNOW we have the account ID -- so we grab it.</span>
                            <span class="comment">//</span>
                            <span class="keywordflow">if</span> (str_other_acct_id.empty() &amp;&amp; (pPayment-&gt;<a class="code" href="class_o_t_payment.html#af197690691464b57f9d9224357444351">GetSenderAcctIDForDisplay</a>(theAccountID)))
                            {
                                <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAccountID);
                                str_other_acct_id = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                            }
                        }
                        <span class="comment">// ------------------------------------------</span>
                        <span class="comment">// By this point, p_str_account is definitely set.</span>
                        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_account); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the accounts we care about.</span>
                        <span class="comment">// ---------------------------------------------------</span>
                        <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theAssetTypeID;

                        <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a37342f7cb3d3fa42afb8531f4989d552">GetAssetTypeID</a>(theAssetTypeID))
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAssetTypeID);
                            <span class="keyword">const</span> std::string str_inpmt_asset(strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>()); <span class="comment">// The asset type we found on the payment (if we found anything.)</span>
                            <span class="comment">// -----------------------------</span>
                            map_of_strings::iterator it_asset = m_assets.find(str_inpmt_asset);
                            <span class="comment">// -----------------------------</span>
                            <span class="keywordflow">if</span> (it_asset != m_assets.end()) <span class="comment">// Found it on the map of asset types we care about.</span>
                            {
                                p_str_asset_type = &amp;(it_asset-&gt;first);   <span class="comment">// Set the asset type ID.</span>
                                p_str_asset_name = &amp;(it_asset-&gt;second);  <span class="comment">// The CurrencyTLA. Examples: USD, BTC, etc.</span>
                            }
                            <span class="keywordflow">else</span>
                            {
                                <span class="comment">// There was definitely an asset type on the instrument, and it definitely</span>
                                <span class="comment">// did not match any of the assets that we care about.</span>
                                <span class="comment">// Therefore, skip.</span>
                                <span class="comment">//</span>
                                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Skipping: Payment record (we don&#39;t care about asset type %s)\n&quot;</span>,
                                              __FUNCTION__, str_inpmt_asset.c_str());
                                <span class="keywordflow">continue</span>;
                            }
                        }
                        <span class="comment">// By this point, p_str_asset_type and p_str_asset_name are definitely set.</span>
                        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_type); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
                        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_name); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
                        <span class="comment">// ----------------------------------</span>
                        <a class="code" href="class_o_t_string.html">OTString</a> strMemo;
                        <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a76ed76e62e9b57487f08a6f1296260ab">GetMemo</a>(strMemo))
                        {
                            str_memo = strMemo.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                        <span class="comment">// ----------------------------------</span>
                        <span class="comment">// Instrument type (cheque, voucher, etc)</span>
                        <span class="keywordtype">int</span> nType = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a750b001a080812918d7c68bbc85c3ff3">GetType</a>());

                        str_type = <a class="code" href="_o_t_record_8hpp.html#aad2c87d02cf1bd05c6f519117deb93d9">OTRecord_GetTypeString</a>(nType);
                        <span class="comment">// ---------------------------------------------------</span>
                        int64_t lAmount = 0;

                        <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#acb3588ce12579879e64d65ed69afd5f6">GetAmount</a>(lAmount))
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                            strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                            str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                    }
                }
                <span class="comment">// ------------------------------</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: ADDED: Payment record %s (str_type: %s)\n&quot;</span>,
                               __FUNCTION__, bOutgoing ? <span class="stringliteral">&quot;(sent)&quot;</span> : <span class="stringliteral">&quot;(received)&quot;</span>, str_type.c_str());

                <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_Record(<span class="keyword">new</span> <a class="code" href="class_o_t_record.html">OTRecord</a>(*it_server,
                                                           *p_str_asset_type,
                                                           *p_str_asset_name,
                                                           str_nym_id,     <span class="comment">// This is the Nym WHOSE BOX IT IS.</span>
                                                           *p_str_account, <span class="comment">// This is the Nym&#39;s account for this box. (Blank for incoming, set for outgoing.)</span>
                                                           <span class="comment">// Everything above this line, it stores a reference to an external string.</span>
                                                           <span class="comment">// -----------------------------</span>
                                                           <span class="comment">// Everything below this line, it makes its own internal copy of the string.</span>
                                                           str_name,    <span class="comment">// name of sender or recipient (since its in the recordbox.)</span>
                                                           str_date,    <span class="comment">// the &quot;date signed&quot; on the receipt.</span>
                                                           str_amount,
                                                           str_type,    <span class="comment">// pending, chequeReceipt, etc.</span>
                                                           <span class="keyword">false</span>,       <span class="comment">// Everything in the recordbox is finished. (NOT pending.)</span>
                                                           bOutgoing, <span class="comment">// Since it&#39;s the recordbox, it contains both incoming and outgoing receipts.</span>
                                                           <span class="keyword">true</span>, <span class="comment">//IsRecord</span>
                                                           <span class="keyword">false</span>,<span class="comment">//IsReceipt,</span>
                                                           <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2da6df8bc1fa86af318441b6d9b44884379">OTRecord::Instrument</a>));
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (strContents.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
                    sp_Record-&gt;SetContents(strContents.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetDateRange(tValidFrom, tValidTo);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetBoxIndex(static_cast&lt;int&gt;(nIndex));
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_memo.empty())
                    sp_Record-&gt;SetMemo(str_memo);
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_other_nym_id.empty())
                    sp_Record-&gt;SetOtherNymID(str_other_nym_id);
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_other_acct_id.empty())
                    sp_Record-&gt;SetOtherAccountID(str_other_acct_id);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetTransNumForDisplay(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a4463450cc735aea9b924011f073bb3">GetReferenceNumForDisplay</a>());
                sp_Record-&gt;SetTransactionNum(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction_type.html#aa204b21b7f498389f746742c1d2007fa">GetTransactionNum</a>());

                m_contents.push_back(sp_Record);
                <span class="comment">// ------------------------------</span>

            } <span class="comment">// Loop through Recordbox</span>
            <span class="keywordflow">else</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;%s: Failed loading payments record box. (Probably just doesn&#39;t exist yet.)\n&quot;</span>, __FUNCTION__);
            <span class="comment">// ------------------------------------------------</span>

            <span class="comment">// ------------------------------------------------</span>
            <span class="comment">// EXPIRED RECORDS:</span>
            nIndex = (-1);

            <span class="comment">// Also loop through its expired record box.</span>
            <span class="comment">// OPTIMIZE FYI: m_bRunFast impacts run speed here.</span>
            <a class="code" href="class_o_t_ledger.html">OTLedger</a> * pExpiredbox = m_bRunFast ? <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a7b9a649113879b83befa1d7acc00b79d">LoadExpiredBoxNoVerify</a>(theServerID, theNymID) :
                                                  <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#ae3d6ecd9fabfea445d35fd7307008856">LoadExpiredBox</a>        (theServerID, theNymID);
            <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTLedger&gt;</a> theExpiredBoxAngel(pExpiredbox);

            <span class="comment">// It loaded up, so let&#39;s loop through it.</span>
            <span class="keywordflow">if</span> (NULL != pExpiredbox) <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_ledger_8hpp.html#a1823ddf57c0de6495aa8ec5da7f1b8f7">mapOfTransactions</a>, pExpiredbox-&gt;<a class="code" href="class_o_t_ledger.html#aa71b6540e2948a36e3c7d3e7d14547a5">GetTransactionMap</a>())
            {
                <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * pBoxTrans = (*it).second;
                <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pBoxTrans);
                <span class="comment">// ------------------------------</span>
                <span class="keywordtype">bool</span> bOutgoing = <span class="keyword">false</span>;
                <span class="comment">// ----------------------------------</span>
                ++nIndex; <span class="comment">// 0 on first iteration.</span>
                <span class="comment">// ------------------------------------------------</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Expired payment RECORD index: %d\n&quot;</span>, __FUNCTION__, nIndex);
                <span class="comment">// ------------------------------------------------</span>
                std::string  str_name; <span class="comment">// name of sender OR recipient (depending on whether it was originally incoming or outgoing.)</span>
                std::string  str_other_nym_id;
                std::string  str_other_acct_id;

                <span class="keywordflow">if</span> (<span class="keyword">false</span> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>())
                {
                    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theSenderID,    theSenderAcctID;
                    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theRecipientID, theRecipientAcctID;

                    <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a1091822e3072f014a8b2f64b93917ca7" title="For display purposes. The &quot;ref #&quot; you actually display (versus the one you use internally) might chan...">GetSenderUserIDForDisplay</a>(theSenderID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strSenderID  (theSenderID);
                        <span class="keyword">const</span> std::string str_sender_id(strSenderID.Get());

                        <span class="comment">// Usually, Nym is the RECIPIENT. Sometimes he&#39;s the sender.</span>
                        <span class="comment">// Either way, we want the OTHER ID (the other Nym) for display.</span>
                        <span class="comment">// So here, if Nym&#39;s CLEARLY the sender, then we want the RECIPIENT.</span>
                        <span class="comment">// Whereas if Nym were the recipient, then we&#39;d want the SENDER. (For display.)</span>
                        <span class="comment">//</span>
                        <span class="keywordflow">if</span> (0 == str_nym_id.compare(str_sender_id)) <span class="comment">// str_nym_id IS str_sender_id. (Therefore we want recipient.)</span>
                        {
                            bOutgoing = <span class="keyword">true</span>; <span class="comment">// if Nym is the sender, then it must have been outgoing.</span>

                            <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID))
                            {
                                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientID(theRecipientID);
                                <span class="keyword">const</span> std::string str_recipient_id(strRecipientID.Get());

                                <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_recipient_id, &amp;(*it_server))), strNameTemp;

                                <span class="keywordflow">if</span> (strName.Exists())
                                    strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                                <span class="keywordflow">else</span>
                                    strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_id.c_str());

                                str_name         = strNameTemp.Get(); <span class="comment">// Todo: lookup the name in address book also.</span>
                                str_other_nym_id = str_recipient_id;
                                <span class="comment">// -------------------------------------------</span>
                                <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                                {
                                    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientAcctID(theRecipientAcctID);
                                    str_other_acct_id = strRecipientAcctID.Get();
                                }
                            }
                        }
                        <span class="keywordflow">else</span> <span class="comment">// str_nym_id IS NOT str_sender_id. (Therefore we want sender.)</span>
                        {    <span class="comment">// In this case, some OTHER Nym is the sender, so it must have been incoming. (And bOutgoing is already false.)</span>

                            <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_sender_id, &amp;(*it_server))), strNameTemp;

                            <span class="keywordflow">if</span> (strName.Exists())
                                strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), strName.Get());
                            <span class="keywordflow">else</span>
                                strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), str_sender_id.c_str());

                            str_name         = strNameTemp.Get(); <span class="comment">// Todo: lookup the name in address book also.</span>
                            str_other_nym_id = str_sender_id;
                            <span class="comment">// -------------------------------------------</span>
                            <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#acf66d9f8f5d3a6e4ee0a418a41db6019">GetSenderAcctIDForDisplay</a>(theSenderAcctID))
                            {
                                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strSenderAcctID(theSenderAcctID);
                                str_other_acct_id = strSenderAcctID.Get();
                            }
                        }
                    }
                    <span class="comment">// In this block below, we already KNOW GetSenderUserIDForDisplay is EMPTY.</span>
                    <span class="comment">// (So it&#39;s &quot;recipient or bust.&quot;)</span>
                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientID(theRecipientID);
                        <span class="keyword">const</span> std::string str_recipient_id(strRecipientID.Get());

                        <span class="keywordflow">if</span> (0 != str_nym_id.compare(str_recipient_id)) <span class="comment">// str_nym_id is NOT str_recipient_id. (Therefore we want str_recipient_id.)</span>
                        {
                            <span class="comment">// If Nym is not the recipient, then he must be the sender.</span>
                            <span class="comment">// (Therefore it must be outgoing.)</span>
                            bOutgoing = <span class="keyword">true</span>;

                            <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_recipient_id, &amp;(*it_server))), strNameTemp;

                            <span class="keywordflow">if</span> (strName.Exists())
                                strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                            <span class="keywordflow">else</span>
                                strNameTemp.Format(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_id.c_str());

                            str_name         = strNameTemp.Get(); <span class="comment">// Todo: lookup the name in address book also.</span>
                            str_other_nym_id = str_recipient_id;
                            <span class="comment">// -------------------------------------------</span>
                            <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                            {
                                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientAcctID(theRecipientAcctID);
                                str_other_acct_id = strRecipientAcctID.Get();
                            }
                        }
                    }
                } <span class="comment">// if not abbreviated.</span>
                <span class="comment">// ------------------------------</span>
                <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> tValidFrom = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>, tValidTo = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;
                <span class="comment">// ------------------------------</span>
                std::string str_date    = <span class="stringliteral">&quot;0&quot;</span>; <span class="comment">// the &quot;date signed&quot; on the transaction receipt.</span>
                <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>      tDateSigned = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#afb069b9f7ab72f90e9e42aed0ba3b17c">GetDateSigned</a>();

                <span class="keywordflow">if</span> (tDateSigned &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
                {
                    tValidFrom = tDateSigned;
                    <span class="keyword">const</span> uint64_t lDateSigned = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tDateSigned);
                    <a class="code" href="class_o_t_string.html">OTString</a> strDateSigned;
                    strDateSigned.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lDateSigned);
                    str_date = strDateSigned.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                }
                <span class="comment">// ----------------------------------</span>
                <span class="keyword">const</span> std::string * p_str_asset_type = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ASSET TYPE</span>
                <span class="keyword">const</span> std::string * p_str_asset_name = &amp;OTRecordList::s_blank; <span class="comment">// asset type display name.</span>
                <span class="keyword">const</span> std::string * p_str_account    = &amp;OTRecordList::s_blank; <span class="comment">// &lt;========== ACCOUNT</span>
                <span class="comment">// ----------------------------------</span>
                std::string str_amount;  <span class="comment">// &lt;========== AMOUNT</span>
                std::string str_type;    <span class="comment">// Instrument type.</span>
                std::string str_memo;    <span class="comment">// Instrument memo (if applicable.)</span>
                <a class="code" href="class_o_t_string.html">OTString</a>    strContents; <span class="comment">// Instrument contents.</span>

                <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>())
                {
                    str_type = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>(); <span class="comment">// instrumentNotice, etc.</span>
                    <span class="comment">// --------------------------------------------------</span>
                    int64_t lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>();

                    <span class="keywordflow">if</span> (0 != lAmount)
                    {
                        <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                        strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                        str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                    }
                }
                <span class="keywordflow">else</span> <span class="comment">// NOT abbreviated. (Full box receipt is already loaded.)</span>
                {
                    <a class="code" href="class_o_t_payment.html">OTPayment</a> * pPayment = pExpiredbox-&gt;<a class="code" href="class_o_t_ledger.html#a114a4d31098807d6cb873a7343a407ae">GetInstrument</a>(*pNym,
                                                                      nIndex);     <span class="comment">// ===&gt; Returns financial instrument by index.</span>
                    <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTPayment&gt;</a> thePaymentAngel(pPayment);
                    <span class="comment">// ------------------------------</span>
                    <span class="keywordflow">if</span> (NULL == pPayment) <span class="comment">// then we treat it like it&#39;s abbreviated.</span>
                    {
                        str_type = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>(); <span class="comment">// instrumentNotice, etc.</span>
                        <span class="comment">// --------------------------------------------------</span>
                        int64_t lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>();

                        <span class="keywordflow">if</span> (0 != lAmount)
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                            strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                            str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                    }
                    <span class="comment">// ---------------------------------------------------</span>
                    <span class="comment">// We have pPayment, the instrument accompanying the receipt in the payments recordbox.</span>
                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a1ee95406f9d221ae4a57783422d52156">SetTempValues</a>())
                    {
                        <span class="comment">// ----------------------------------</span>
                        pPayment-&gt;<a class="code" href="class_o_t_payment.html#af3c3ed5823d48d9cf86463987f67ddae">GetValidFrom</a>(tValidFrom);
                        pPayment-&gt;<a class="code" href="class_o_t_payment.html#a11dbba988d5da835179885043b4c3979">GetValidTo</a>  (tValidTo);

                        <span class="keywordflow">if</span> (tValidFrom &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
                        {
                            <span class="keyword">const</span> uint64_t lFrom = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tValidFrom);
                            <a class="code" href="class_o_t_string.html">OTString</a> strFrom;
                            strFrom.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lFrom);
                            str_date = strFrom.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                        <span class="comment">// ----------------------------------</span>
                        pPayment-&gt;<a class="code" href="class_o_t_payment.html#a1d067b54e63054b1021ef5f187911fab">GetPaymentContents</a>(strContents);
                        <span class="comment">// ------------------------------------</span>
                        <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theAccountID;

                        <span class="keywordflow">if</span> (bOutgoing) <span class="comment">// Nym is sender.</span>
                        {
                            <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#af197690691464b57f9d9224357444351">GetSenderAcctIDForDisplay</a>(theAccountID)) <span class="comment">// Since Nym is ME, the Account must be MY acct.</span>
                            {                                            <span class="comment">// (If this record was originally OUTgoing, then the SENDER&#39;s account is MY acct.)</span>
                                <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAccountID);
                                std::string str_outpmt_account = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// The accountID we found on the payment (only applies to outgoing payments.)</span>
                                <span class="comment">// -----------------------------</span>
                                list_of_strings::iterator it_acct = std::find(m_accounts.begin(), m_accounts.end(), str_outpmt_account);
                                <span class="comment">// -----------------------------</span>
                                <span class="keywordflow">if</span> (it_acct != m_accounts.end()) <span class="comment">// Found it on the list of accounts we care about.</span>
                                {
                                    p_str_account = &amp;(*it_acct);
                                }
                                <span class="keywordflow">else</span>
                                {
                                    <span class="comment">// There was definitely an account on the instrument, and it definitely</span>
                                    <span class="comment">// did not match any of the accounts that we care about.</span>
                                    <span class="comment">// Therefore, skip.</span>
                                    <span class="comment">//</span>
                                    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Skipping &#39;sent payment&#39; expired record. (We don&#39;t care about account %s)\n&quot;</span>,
                                                   __FUNCTION__, str_outpmt_account.c_str());
                                    <span class="keywordflow">continue</span>;
                                }
                                <span class="comment">// -------------------------------------------</span>
                            }
                        }
                        <span class="keywordflow">else</span> <span class="comment">// Nym is recipient.</span>
                        {
                            <span class="comment">// Why is this here? Because if Nym is recipient, let&#39;s say he received an instrumentNotice containing</span>
                            <span class="comment">// a sendUserInstrument message containing an incoming cheque. Well... that incoming cheque (the payload</span>
                            <span class="comment">// on sendUserInstrument message) is ENCRYPTED. Meaning the above calls to pBoxReceipt-&gt;GetSenderAcctID</span>
                            <span class="comment">// on the instrumentNotice transaction will FAIL. One option is to pass pNym into GetSenderAcctID so it</span>
                            <span class="comment">// can decrypt the payload and return the value. But since we already have the payload decrypted here</span>
                            <span class="comment">// (we already have the cheque loaded up here) we can just grab the senderAcctID directly from the cheque.</span>
                            <span class="comment">// That&#39;s why this is here -- because this is where we KNOW we have the account ID -- so we grab it.</span>
                            <span class="comment">//</span>
                            <span class="keywordflow">if</span> (str_other_acct_id.empty() &amp;&amp; (pPayment-&gt;<a class="code" href="class_o_t_payment.html#af197690691464b57f9d9224357444351">GetSenderAcctIDForDisplay</a>(theAccountID)))
                            {
                                <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAccountID);
                                str_other_acct_id = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                            }
                        }
                        <span class="comment">// ------------------------------------------</span>
                        <span class="comment">// By this point, p_str_account is definitely set.</span>
                        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_account); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the accounts we care about.</span>
                        <span class="comment">// ---------------------------------------------------</span>
                        <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theAssetTypeID;

                        <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a37342f7cb3d3fa42afb8531f4989d552">GetAssetTypeID</a>(theAssetTypeID))
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp(theAssetTypeID);
                            <span class="keyword">const</span> std::string str_inpmt_asset(strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>()); <span class="comment">// The asset type we found on the payment (if we found anything.)</span>
                            <span class="comment">// -----------------------------</span>
                            map_of_strings::iterator it_asset = m_assets.find(str_inpmt_asset);
                            <span class="comment">// -----------------------------</span>
                            <span class="keywordflow">if</span> (it_asset != m_assets.end()) <span class="comment">// Found it on the map of asset types we care about.</span>
                            {
                                p_str_asset_type = &amp;(it_asset-&gt;first);   <span class="comment">// Set the asset type ID.</span>
                                p_str_asset_name = &amp;(it_asset-&gt;second);  <span class="comment">// The CurrencyTLA. Examples: USD, BTC, etc.</span>
                            }
                            <span class="keywordflow">else</span>
                            {
                                <span class="comment">// There was definitely an asset type on the instrument, and it definitely</span>
                                <span class="comment">// did not match any of the assets that we care about.</span>
                                <span class="comment">// Therefore, skip.</span>
                                <span class="comment">//</span>
                                <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: Skipping: Expired payment record (we don&#39;t care about asset type %s)\n&quot;</span>,
                                              __FUNCTION__, str_inpmt_asset.c_str());
                                <span class="keywordflow">continue</span>;
                            }
                        }
                        <span class="comment">// By this point, p_str_asset_type and p_str_asset_name are definitely set.</span>
                        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_type); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
                        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != p_str_asset_name); <span class="comment">// and it&#39;s either blank, or it&#39;s one of the asset types we care about.</span>
                        <span class="comment">// ----------------------------------</span>
                        <a class="code" href="class_o_t_string.html">OTString</a> strMemo;
                        <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a76ed76e62e9b57487f08a6f1296260ab">GetMemo</a>(strMemo))
                        {
                            str_memo = strMemo.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                        <span class="comment">// ----------------------------------</span>
                        <span class="comment">// Instrument type (cheque, voucher, etc)</span>
                        <span class="keywordtype">int</span> nType = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#a750b001a080812918d7c68bbc85c3ff3">GetType</a>());

                        str_type = <a class="code" href="_o_t_record_8hpp.html#aad2c87d02cf1bd05c6f519117deb93d9">OTRecord_GetTypeString</a>(nType);
                        <span class="comment">// ---------------------------------------------------</span>
                        int64_t lAmount = 0;

                        <span class="keywordflow">if</span> (pPayment-&gt;<a class="code" href="class_o_t_payment.html#acb3588ce12579879e64d65ed69afd5f6">GetAmount</a>(lAmount))
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                            strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                            str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                    }
                }
                <span class="comment">// ------------------------------</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: ADDED: Expired payment record %s (str_type: %s)\n&quot;</span>,
                               __FUNCTION__, bOutgoing ? <span class="stringliteral">&quot;(sent)&quot;</span> : <span class="stringliteral">&quot;(received)&quot;</span>, str_type.c_str());

                <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_Record(<span class="keyword">new</span> <a class="code" href="class_o_t_record.html">OTRecord</a>(*it_server,
                                                           *p_str_asset_type,
                                                           *p_str_asset_name,
                                                           str_nym_id,     <span class="comment">// This is the Nym WHOSE BOX IT IS.</span>
                                                           *p_str_account, <span class="comment">// This is the Nym&#39;s account for this box. (Blank for incoming, set for outgoing.)</span>
                                                           <span class="comment">// Everything above this line, it stores a reference to an external string.</span>
                                                           <span class="comment">// -----------------------------</span>
                                                           <span class="comment">// Everything below this line, it makes its own internal copy of the string.</span>
                                                           str_name,    <span class="comment">// name of sender or recipient (since its in the recordbox.)</span>
                                                           str_date,    <span class="comment">// the &quot;date signed&quot; on the receipt.</span>
                                                           str_amount,
                                                           str_type,    <span class="comment">// pending, chequeReceipt, etc.</span>
                                                           <span class="keyword">false</span>,       <span class="comment">// Everything in the recordbox is finished. (NOT pending.)</span>
                                                           bOutgoing, <span class="comment">// Since it&#39;s the recordbox, it contains both incoming and outgoing receipts.</span>
                                                           <span class="keyword">true</span>, <span class="comment">//IsRecord</span>
                                                           <span class="keyword">false</span>,<span class="comment">//IsReceipt,</span>
                                                           <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2da6df8bc1fa86af318441b6d9b44884379">OTRecord::Instrument</a>));
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (strContents.<a class="code" href="class_o_t_string.html#adf7489cd917d4ae5bf30853a3ad78daf">Exists</a>())
                    sp_Record-&gt;SetContents(strContents.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetDateRange(tValidFrom, tValidTo);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetExpired();
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetBoxIndex(static_cast&lt;int&gt;(nIndex));
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_memo.empty())
                    sp_Record-&gt;SetMemo(str_memo);
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_other_nym_id.empty())
                    sp_Record-&gt;SetOtherNymID(str_other_nym_id);
                <span class="comment">// -------------------------------------------------</span>
                <span class="keywordflow">if</span> (!str_other_acct_id.empty())
                    sp_Record-&gt;SetOtherAccountID(str_other_acct_id);
                <span class="comment">// -------------------------------------------------</span>
                sp_Record-&gt;SetTransNumForDisplay(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a4463450cc735aea9b924011f073bb3">GetReferenceNumForDisplay</a>());
                sp_Record-&gt;SetTransactionNum(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction_type.html#aa204b21b7f498389f746742c1d2007fa">GetTransactionNum</a>());

                m_contents.push_back(sp_Record);
                <span class="comment">// ------------------------------</span>

            } <span class="comment">// Loop through ExpiredBox</span>
            <span class="keywordflow">else</span>
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;%s: Failed loading expired payments box. (Probably just doesn&#39;t exist yet.)\n&quot;</span>, __FUNCTION__);
            <span class="comment">// ------------------------------------------------</span>

        } <span class="comment">// Loop through servers for each Nym.</span>

    } <span class="comment">// Loop through Nyms.</span>
    <span class="comment">// ------------------------------------------------</span>
    <span class="comment">// ASSET ACCOUNT -- INBOX/OUTBOX + RECORD BOX</span>
    <span class="comment">// Loop through the Accounts.</span>
    <span class="comment">//</span>
    <span class="comment">// ------------------------------------------------</span>
    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;================ %s: Looping through the accounts in the wallet...\n&quot;</span>, __FUNCTION__);
    <span class="comment">// ------------------------------------------------</span>
    <span class="keywordtype">int</span> nAccountIndex = -1;
    <a class="code" href="_o_t_storage_8hpp.html#a4a94c3435a932ed34e5755f3f472547c">FOR_EACH_IT</a>(<a class="code" href="_o_t_record_list_8hpp.html#a1172b459639314113a533a64309eb319">list_of_strings</a>, m_accounts, it_acct)
    {
        ++nAccountIndex; <span class="comment">// (0 on first iteration.)</span>
        <span class="comment">// ------------------</span>
        <span class="comment">// For each account, loop through its inbox, outbox, and record box.</span>
        <span class="comment">//</span>
        <span class="keyword">const</span> std::string  &amp; str_account_id(*it_acct);
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a>   theAccountID  (str_account_id);
        <a class="code" href="class_o_t_account.html">OTAccount</a> * pAccount = pWallet-&gt;<a class="code" href="class_o_t_wallet.html#aee1809973c356a82e9c0f80d201668f4">GetAccount</a>(theAccountID);
        <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pAccount);
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theNymID    = pAccount-&gt;<a class="code" href="class_o_t_transaction_type.html#a845d76c16f6f5f3f4bc9ac04393ca3c0">GetUserID</a>();
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theServerID = pAccount-&gt;<a class="code" href="class_o_t_transaction_type.html#a59fc08d52ef5bc0ea546da7a56e86fa5">GetPurportedServerID</a>();
        <span class="keyword">const</span> <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> &amp; theAssetID  = pAccount-&gt;<a class="code" href="class_o_t_account.html#a3b933b8c929e071a68ec4a29ad5797d6">GetAssetTypeID</a>();
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strNymID   (theNymID);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strServerID(theServerID);
        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>       strAssetID (theAssetID);
        <span class="comment">// ------------------------------------------------</span>
        <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;------------\n%s: Account: %d, ID: %s\n&quot;</span>, __FUNCTION__,
                       nAccountIndex, str_account_id.c_str());
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> std::string    str_nym_id   (strNymID.Get());
        <span class="keyword">const</span> std::string    str_server_id(strServerID.Get());
        <span class="keyword">const</span> std::string    str_asset_id (strAssetID.Get());
        <span class="comment">// ------------------------------------------------</span>
        <span class="keyword">const</span> std::string  * pstr_nym_id     = &amp;OTRecordList::s_blank;
        <span class="keyword">const</span> std::string  * pstr_server_id  = &amp;OTRecordList::s_blank;
        <span class="keyword">const</span> std::string  * pstr_asset_id   = &amp;OTRecordList::s_blank;
        <span class="keyword">const</span> std::string  * pstr_asset_name = &amp;OTRecordList::s_blank;
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// NOTE: Since this account is already on my &quot;care about&quot; list for accounts,</span>
        <span class="comment">// I wouldn&#39;t bother double-checking my &quot;care about&quot; lists for servers, nyms,</span>
        <span class="comment">// and asset types. But I still look up the appropriate string for each, since</span>
        <span class="comment">// I have to pass a reference to it into the constructor for OTRecord. (To a version</span>
        <span class="comment">// that won&#39;t be deleted, since the OTRecord will reference it. And the &quot;care about&quot;</span>
        <span class="comment">// list definitely contains a copy of the string that won&#39;t be deleted.)</span>
        <span class="comment">//</span>
        list_of_strings::iterator it_nym    = std::find(m_nyms.begin(),    m_nyms.end(),    str_nym_id);
        list_of_strings::iterator it_server = std::find(m_servers.begin(), m_servers.end(), str_server_id);
         map_of_strings::iterator it_asset  = m_assets.find(str_asset_id);
        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordflow">if</span> ((m_nyms.end() == it_nym) || (m_servers.end() == it_server) || (m_assets.end() == it_asset))
        {
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Skipping an account (%s) since its Nym, or Server, &quot;</span>
                           <span class="stringliteral">&quot;or Asset Type wasn&#39;t on my list.\n&quot;</span>, __FUNCTION__,
                           str_account_id.c_str());
            <span class="keywordflow">continue</span>;
        }
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// These pointers are what we&#39;ll use to construct each OTRecord.</span>
        <span class="comment">//</span>
        pstr_nym_id     = &amp;(*it_nym);
        pstr_server_id  = &amp;(*it_server);
        pstr_asset_id   = &amp;(it_asset-&gt;first);
        pstr_asset_name = &amp;(it_asset-&gt;second);
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// Loop through asset account INBOX.</span>
        <span class="comment">//</span>
        <span class="comment">// OPTIMIZE FYI:</span>
        <span class="comment">// NOTE: LoadInbox is much SLOWER than LoadInboxNoVerify, but it also lets you get</span>
        <span class="comment">// the NAME off of the box receipt. So if you are willing to GIVE UP the NAME, in</span>
        <span class="comment">// return for FASTER PERFORMANCE, then call SetFastMode() before Populating.</span>
        <span class="comment">//</span>
        <a class="code" href="class_o_t_ledger.html">OTLedger</a> * pInbox = m_bRunFast ? <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a11a9479b4875de4377232237d3521690">LoadInboxNoVerify</a>(theServerID, theNymID, theAccountID) :
                                         <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a478f3f32e383e05a203807810bc94940">LoadInbox</a>        (theServerID, theNymID, theAccountID);
        <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTLedger&gt;</a> theInboxAngel(pInbox);

        <span class="comment">// ------------------------------------------------</span>
        <span class="keywordtype">int</span> nInboxIndex = -1;
        <span class="comment">// It loaded up, so let&#39;s loop through it.</span>
        <span class="keywordflow">if</span> (NULL != pInbox) <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_ledger_8hpp.html#a1823ddf57c0de6495aa8ec5da7f1b8f7">mapOfTransactions</a>, pInbox-&gt;<a class="code" href="class_o_t_ledger.html#aa71b6540e2948a36e3c7d3e7d14547a5">GetTransactionMap</a>())
        {
            ++nInboxIndex; <span class="comment">// (0 on first iteration.)</span>
            <span class="comment">// ------------------------------------------------</span>
            <span class="keywordflow">if</span> (0 == nInboxIndex)
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Beginning loop through asset account INBOX...\n&quot;</span>, __FUNCTION__);
            <span class="comment">// --------------------------------</span>
            <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * pBoxTrans = (*it).second;
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pBoxTrans);
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Inbox index: %d\n&quot;</span>, __FUNCTION__, nInboxIndex);
            <span class="comment">// ------------------------------------------------</span>
            <span class="keywordtype">bool</span> bCanceled = <span class="keyword">false</span>;
            <span class="comment">// ------------------------------------------------</span>
            std::string  str_name; <span class="comment">// name of sender (since its in the inbox.)</span>
            std::string  str_other_nym_id;
            std::string  str_other_acct_id;
            std::string  str_memo;

            <span class="keywordflow">if</span> (<span class="keyword">false</span> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>())
            {
                <a class="code" href="class_o_t_string.html">OTString</a> strMemo;

                <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#abc54a3c74c5235cfe1debe4a2f97c2cd">GetMemo</a>(strMemo))
                    str_memo = strMemo.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                <span class="comment">// ------------------------------------------------</span>
                <span class="keywordflow">if</span> (<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>())
                {
                    <span class="comment">// NOTE: REMOVE THE BELOW CODE. (Found a better way, above this block.)</span>
<span class="comment">//                    const OTString strBoxTrans(*pBoxTrans);</span>
<span class="comment">//</span>
<span class="comment">//                    if (strBoxTrans.Exists())</span>
<span class="comment">//                        str_memo = OTAPI_Wrap::Pending_GetNote(*pstr_server_id, *pstr_nym_id, str_account_id, strBoxTrans.Get());</span>
                    <span class="comment">// ------------------------------</span>
                    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theSenderID, theSenderAcctID;

                    <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#acf66d9f8f5d3a6e4ee0a418a41db6019">GetSenderAcctIDForDisplay</a>(theSenderAcctID)) <span class="comment">// ACCOUNT name.</span>
                    {
                        <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a1091822e3072f014a8b2f64b93917ca7" title="For display purposes. The &quot;ref #&quot; you actually display (versus the one you use internally) might chan...">GetSenderUserIDForDisplay</a>(theSenderID))
                        {
                            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strSenderID(theSenderID);
                            str_other_nym_id = strSenderID.Get();
                        }
                        <span class="comment">// ------------------------------------</span>
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strSenderAcctID(theSenderAcctID);
                        <span class="keyword">const</span> std::string str_sender_acct_id(strSenderAcctID.Get());

                        str_other_acct_id = str_sender_acct_id;

                        <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#a0b746308196119aa968169387b6c9f7c">GetAcctName</a>(str_other_acct_id,
                                                                str_other_nym_id.empty() ? NULL :
                                                                    &amp;str_other_nym_id, <span class="comment">// nym ID if known</span>
                                                                pstr_server_id, <span class="comment">// server ID if known.</span>
                                                                pstr_asset_id)), <span class="comment">// asset ID if known.</span>
                                 strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                        {
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), strName.Get());
                            str_name = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!str_other_nym_id.empty())
                        {
                            <a class="code" href="class_o_t_string.html">OTString</a> strNymName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_other_nym_id, &amp;(*it_server))), strNymNameTemp;

                            <span class="keywordflow">if</span> (strNymName.Exists())
                            {
                                strNymNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), strNymName.Get());
                                str_name = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                            }
                        }
                        <span class="comment">// ---------------------------------------</span>
                        <span class="keywordflow">if</span> (str_name.empty())
                        {
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), str_sender_acct_id.c_str());
                            str_name = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        }
                    }
                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a1091822e3072f014a8b2f64b93917ca7" title="For display purposes. The &quot;ref #&quot; you actually display (versus the one you use internally) might chan...">GetSenderUserIDForDisplay</a>(theSenderID)) <span class="comment">// NYM name.</span>
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strSenderID  (theSenderID);
                        <span class="keyword">const</span> std::string str_sender_id(strSenderID.Get());

                        <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_sender_id, &amp;(*it_server))), strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), strName.Get());
                        <span class="keywordflow">else</span>
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), str_sender_id.c_str());

                        str_name         = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        str_other_nym_id = str_sender_id;
                    }
                    <span class="keywordflow">else</span>
                    {
                        <a class="code" href="class_o_t_string.html">OTString</a> strName(<a class="code" href="class_o_t_a_p_i___wrap.html#a18999957d285b958c3f683d3460a0b3f">OTAPI_Wrap::GetAccountWallet_Name</a>(str_account_id)), strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                            strNameTemp = strName;
                        <span class="keywordflow">else</span>
                            strNameTemp = str_account_id;

                        str_name = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// Todo: lookup the name in address book also.</span>
                    }
                } <span class="comment">// end: (if pending)</span>

                <span class="keywordflow">else</span> <span class="comment">// else it&#39;s a receipt.</span>
                {
                    <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theRecipientID, theRecipientAcctID;

                    <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strRecipientID       (theRecipientID);
                        <span class="keyword">const</span> std::string str_recipient_user_id(strRecipientID.Get());

                        <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_recipient_user_id, &amp;(*it_server))), strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                        <span class="keywordflow">else</span>
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_user_id.c_str());

                        str_name         = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// Todo: lookup the name in address book also.</span>
                        str_other_nym_id = str_recipient_user_id;
                        <span class="comment">// ------------------------------------</span>
                        <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                        {
                            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientAcctID(theRecipientAcctID);
                            str_other_acct_id = strRecipientAcctID.Get();
                        }
                    }
                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strRecipientAcctID   (theRecipientAcctID);
                        <span class="keyword">const</span> std::string str_recipient_acct_id(strRecipientAcctID.Get());

                        <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#a0b746308196119aa968169387b6c9f7c">GetAcctName</a>(str_recipient_acct_id,
                                                                NULL, <span class="comment">// nym ID if known</span>
                                                                pstr_server_id, <span class="comment">// server ID if known.</span>
                                                                pstr_asset_id)), <span class="comment">// asset ID if known.</span>
                                strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                        <span class="keywordflow">else</span>
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_acct_id.c_str());

                        str_name          = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// Todo: lookup the name in address book also.</span>
                        str_other_acct_id = str_recipient_acct_id;
                    }
                } <span class="comment">//end: (else it&#39;s a receipt.)</span>
            }
            <span class="comment">// ------------------------------</span>
            bCanceled = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aeabba0a2b6a52c8f50a329f7d14a1ba1">IsCancelled</a>();
            <span class="comment">// ------------------------------</span>
            <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> tValidFrom = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>, tValidTo = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;
            <span class="comment">// ------------------------------</span>
            std::string str_date    = <span class="stringliteral">&quot;0&quot;</span>; <span class="comment">// the &quot;date signed&quot; on the transaction receipt.</span>
            <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>      tDateSigned = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#afb069b9f7ab72f90e9e42aed0ba3b17c">GetDateSigned</a>();

            <span class="keywordflow">if</span> (tDateSigned &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
            {
                tValidFrom = tDateSigned;
                <span class="keyword">const</span> uint64_t lDateSigned = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tDateSigned);
                <a class="code" href="class_o_t_string.html">OTString</a> strDateSigned;
                strDateSigned.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lDateSigned);
                str_date = strDateSigned.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
            }
            <span class="comment">// ------------------------------</span>
            std::string str_amount;  <span class="comment">// &lt;========== AMOUNT</span>
            int64_t        lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>();

            <span class="keywordflow">if</span> (0 == lAmount)
                lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a01fdc95811465496f953c5a50dcef6">GetReceiptAmount</a>();
            <span class="comment">// ------------------------------------------</span>
            <span class="keywordflow">if</span> (0 != lAmount)
            {
                <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
            }
            <span class="comment">// ------------------------------</span>
            <span class="keyword">const</span> std::string str_type(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>()); <span class="comment">// pending, chequeReceipt, etc.</span>
            <span class="comment">// ------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: ADDED: incoming %s (str_type: %s)\n&quot;</span>,
                           __FUNCTION__,
                           (<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>()) ? <span class="stringliteral">&quot;pending transfer&quot;</span> : <span class="stringliteral">&quot;receipt&quot;</span>,
                           str_type.c_str());

            <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_Record(<span class="keyword">new</span> <a class="code" href="class_o_t_record.html">OTRecord</a>(*pstr_server_id,
                                                       *pstr_asset_id,
                                                       *pstr_asset_name,
                                                       *pstr_nym_id,   <span class="comment">// This is the Nym WHOSE BOX IT IS.</span>
                                                       str_account_id, <span class="comment">// This is the Nym&#39;s account for this box.</span>
                                                       <span class="comment">// Everything above this line, it stores a reference to an external string.</span>
                                                       <span class="comment">// -----------------------------</span>
                                                       <span class="comment">// Everything below this line, it makes its own internal copy of the string.</span>
                                                       str_name, <span class="comment">// name of sender (since its in the inbox.)</span>
                                                       str_date, <span class="comment">// the &quot;valid from&quot; date on the instrument.</span>
                                                       str_amount,
                                                       str_type, <span class="comment">// pending, chequeReceipt, etc.</span>
                                                       (<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>()), <span class="comment">// Sometimes true, often false.</span>
                                                       (lAmount &lt; 0) ? <span class="keyword">true</span> : <span class="keyword">false</span>, <span class="comment">//bIsOutgoing (this is the inbox, but a transferReceipt in the inbox represents outgoing funds. Whereas a &quot;pending&quot; in the inbox represents incoming funds. For now I&#39;m just going to go based on whether the amount is negative or not, to determine incoming / outgoing. We&#39;ll see how that works.)</span>
                                                       <span class="keyword">false</span>, <span class="comment">//IsRecord</span>
                                                       (<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> != pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>()), <span class="comment">//IsReceipt,</span>
                                                       (<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>()) ?
                                                            <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2da3a6c19392e918ba4597ae131b007c94f">OTRecord::Transfer</a> : <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2da106c4db2d8feb54b5d3afee0ead49fc2">OTRecord::Receipt</a> ));
            <span class="comment">// -------------------------------------------------</span>
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strContents(*pBoxTrans);
            sp_Record-&gt;SetContents(strContents.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
            <span class="comment">// -------------------------------------------------</span>
            sp_Record-&gt;SetDateRange(tValidFrom, tValidTo);
            <span class="comment">// -------------------------------------------------</span>
            sp_Record-&gt;SetBoxIndex(static_cast&lt;int&gt;(nInboxIndex));
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (bCanceled)
                sp_Record-&gt;SetCanceled();
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (!str_memo.empty())
                sp_Record-&gt;SetMemo(str_memo);
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (!str_other_nym_id.empty())
                sp_Record-&gt;SetOtherNymID(str_other_nym_id);
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (!str_other_acct_id.empty())
                sp_Record-&gt;SetOtherAccountID(str_other_acct_id);
            <span class="comment">// -------------------------------------------------</span>
            sp_Record-&gt;SetTransNumForDisplay(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a4463450cc735aea9b924011f073bb3">GetReferenceNumForDisplay</a>());
            sp_Record-&gt;SetTransactionNum(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction_type.html#aa204b21b7f498389f746742c1d2007fa">GetTransactionNum</a>());
            <span class="comment">// -------------------------------------------------</span>
            m_contents.push_back(sp_Record);
        }
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// OPTIMIZE FYI:</span>
        <span class="comment">// NOTE: LoadOutbox is much SLOWER than LoadOutboxNoVerify, but it also lets you get</span>
        <span class="comment">// the NAME off of the box receipt. So if you are willing to GIVE UP the NAME, in</span>
        <span class="comment">// return for FASTER PERFORMANCE, then call SetFastMode() before running Populate.</span>
        <span class="comment">//</span>
        <a class="code" href="class_o_t_ledger.html">OTLedger</a> * pOutbox = m_bRunFast ? <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#af4b4a5ef255263fbda9958082d393875">LoadOutboxNoVerify</a>(theServerID, theNymID, theAccountID) :
                                          <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#aeaf758c15cb39763d3ac80e7582e5409">LoadOutbox</a>        (theServerID, theNymID, theAccountID);
        <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTLedger&gt;</a> theOutboxAngel(pOutbox);

        <span class="comment">// It loaded up, so let&#39;s loop through it.</span>
        <span class="keywordtype">int</span> nOutboxIndex = -1;
        <span class="keywordflow">if</span> (NULL != pOutbox) <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_ledger_8hpp.html#a1823ddf57c0de6495aa8ec5da7f1b8f7">mapOfTransactions</a>, pOutbox-&gt;<a class="code" href="class_o_t_ledger.html#aa71b6540e2948a36e3c7d3e7d14547a5">GetTransactionMap</a>())
        {
            ++nOutboxIndex; <span class="comment">// (0 on first iteration.)</span>
            <span class="comment">// ------------------------------------------------</span>
            <span class="keywordflow">if</span> (0 == nOutboxIndex)
                <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Beginning loop through asset account OUTBOX...\n&quot;</span>, __FUNCTION__);
            <span class="comment">// --------------------------------</span>
            <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * pBoxTrans = (*it).second;
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pBoxTrans);
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Outbox index: %d\n&quot;</span>, __FUNCTION__, nOutboxIndex);
            <span class="comment">// ------------------------------------------------</span>
            std::string  str_name; <span class="comment">// name of recipient (since its in the outbox.)</span>
            std::string  str_other_nym_id;
            std::string  str_other_acct_id;
            std::string  str_memo;

            <span class="keywordflow">if</span> (<span class="keyword">false</span> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>())
            {
                <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theRecipientID, theRecipientAcctID;

                <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID))
                {
                    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strRecipientID  (theRecipientID);
                    <span class="keyword">const</span> std::string str_recipient_id(strRecipientID.Get());

                    <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_recipient_id, &amp;(*it_server))), strNameTemp;

                    <span class="keywordflow">if</span> (strName.Exists())
                        strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                    <span class="keywordflow">else</span>
                        strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_id.c_str());

                    str_name         = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// Todo: lookup the name in address book also.</span>
                    str_other_nym_id = str_recipient_id;
                    <span class="comment">// ------------------------------------</span>
                    <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientAcctID(theRecipientAcctID);
                        str_other_acct_id = strRecipientAcctID.Get();
                    }
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                {
                    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strRecipientAcctID(theRecipientAcctID);
                    <span class="keyword">const</span> std::string str_recipient_acct_id(strRecipientAcctID.Get());

                    <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#a0b746308196119aa968169387b6c9f7c">GetAcctName</a>(str_recipient_acct_id,
                                                            NULL, <span class="comment">// nym ID if known</span>
                                                            pstr_server_id, <span class="comment">// server ID if known.</span>
                                                            pstr_asset_id)), <span class="comment">// asset ID if known.</span>
                            strNameTemp;

                    <span class="keywordflow">if</span> (strName.Exists())
                        strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                    <span class="keywordflow">else</span>
                        strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_acct_id.c_str());

                    str_name          = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// Todo: lookup the name in address book also.</span>
                    str_other_acct_id = str_recipient_acct_id;
                }
                <span class="comment">// --------------------------</span>
                <span class="keywordflow">if</span> (<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>())
                {
                    <a class="code" href="class_o_t_string.html">OTString</a> strMemo;

                    <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#abc54a3c74c5235cfe1debe4a2f97c2cd">GetMemo</a>(strMemo))
                        str_memo = strMemo.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();

                    <span class="comment">// DELETE THE BELOW CODE (replaced by above code.)</span>
<span class="comment">//                    const OTString strBoxTrans(*pBoxTrans);</span>
<span class="comment">//</span>
<span class="comment">//                    if (strBoxTrans.Exists())</span>
<span class="comment">//                        str_memo = OTAPI_Wrap::Pending_GetNote(*pstr_server_id, *pstr_nym_id, str_account_id, strBoxTrans.Get());</span>
                }
            }
            <span class="comment">// ------------------------------</span>
            <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> tValidFrom = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>, tValidTo = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;
            <span class="comment">// ------------------------------</span>
            std::string str_date    = <span class="stringliteral">&quot;0&quot;</span>; <span class="comment">// the &quot;date signed&quot; on the transaction receipt.</span>
            <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>      tDateSigned = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#afb069b9f7ab72f90e9e42aed0ba3b17c">GetDateSigned</a>();

            <span class="keywordflow">if</span> (tDateSigned &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
            {
                tValidFrom = tDateSigned;
                <span class="keyword">const</span> uint64_t lDateSigned = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tDateSigned);
                <a class="code" href="class_o_t_string.html">OTString</a> strDateSigned;
                strDateSigned.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lDateSigned);
                str_date = strDateSigned.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
            }
            <span class="comment">// ------------------------------</span>
            std::string str_amount;  <span class="comment">// &lt;========== AMOUNT</span>
            int64_t        lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>();

            <span class="keywordflow">if</span> (0 == lAmount)
                lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a01fdc95811465496f953c5a50dcef6">GetReceiptAmount</a>();
            <span class="comment">// -------------------------------------------</span>
            <span class="keywordflow">if</span> (lAmount &gt; 0) <span class="comment">// Outgoing transfer should display with negative amount</span>
                lAmount *= (-1);
            <span class="comment">// -------------------------------------------</span>
            <span class="keywordflow">if</span> (0 != lAmount)
            {
                <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
            }
            <span class="comment">// ------------------------------</span>
            std::string str_type(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>()); <span class="comment">// pending, chequeReceipt, etc.</span>
            <span class="keywordflow">if</span> (0 == str_type.compare(<span class="stringliteral">&quot;pending&quot;</span>))
                str_type = <span class="stringliteral">&quot;transfer&quot;</span>;
            <span class="comment">// ------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: ADDED: %s outgoing transfer (str_type: %s).\n&quot;</span>, __FUNCTION__,
                           (<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>()) ? <span class="stringliteral">&quot;pending&quot;</span> : <span class="stringliteral">&quot;ERROR&quot;</span>, str_type.c_str());

            <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_Record(<span class="keyword">new</span> <a class="code" href="class_o_t_record.html">OTRecord</a>(*pstr_server_id,
                                                       *pstr_asset_id,
                                                       *pstr_asset_name,
                                                       *pstr_nym_id,   <span class="comment">// This is the Nym WHOSE BOX IT IS.</span>
                                                       str_account_id, <span class="comment">// This is the Nym&#39;s account for this box.</span>
                                                       <span class="comment">// Everything above this line, it stores a reference to an external string.</span>
                                                       <span class="comment">// -----------------------------</span>
                                                       <span class="comment">// Everything below this line, it makes its own internal copy of the string.</span>
                                                       str_name, <span class="comment">// name of recipient (since its in the outbox.)</span>
                                                       str_date, <span class="comment">// the &quot;valid from&quot; date on the instrument.</span>
                                                       str_amount,
                                                       str_type, <span class="comment">// pending, chequeReceipt, etc.</span>
                                                       (<a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>()), <span class="comment">// Basically always true, in this case.</span>
                                                       <span class="keyword">true</span>,  <span class="comment">//bIsOutgoing=true. (Since this is the outbox...)</span>
                                                       <span class="keyword">false</span>, <span class="comment">//IsRecord</span>
                                                       <span class="keyword">false</span>, <span class="comment">//IsReceipt</span>
                                                       <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2da3a6c19392e918ba4597ae131b007c94f">OTRecord::Transfer</a>
                                                       ));
            <span class="comment">// -------------------------------------------------</span>
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strContents(*pBoxTrans);
            sp_Record-&gt;SetContents(strContents.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
            <span class="comment">// -------------------------------------------------</span>
            sp_Record-&gt;SetDateRange(tValidFrom, tValidTo);
            <span class="comment">// -------------------------------------------------</span>
            sp_Record-&gt;SetBoxIndex(static_cast&lt;int&gt;(nOutboxIndex));
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (!str_memo.empty())
                sp_Record-&gt;SetMemo(str_memo);
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (!str_other_nym_id.empty())
                sp_Record-&gt;SetOtherNymID(str_other_nym_id);
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (!str_other_acct_id.empty())
                sp_Record-&gt;SetOtherAccountID(str_other_acct_id);
            <span class="comment">// -------------------------------------------------</span>
            sp_Record-&gt;SetTransNumForDisplay(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a4463450cc735aea9b924011f073bb3">GetReferenceNumForDisplay</a>());
            sp_Record-&gt;SetTransactionNum(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction_type.html#aa204b21b7f498389f746742c1d2007fa">GetTransactionNum</a>());
            <span class="comment">// -------------------------------------------------</span>
            m_contents.push_back(sp_Record);
        }
        <span class="comment">// ------------------------------------------------</span>
        <span class="comment">// For this record box, pass a NymID AND an AcctID,</span>
        <span class="comment">// since it&#39;s the recordbox for a specific account.</span>
        <span class="comment">//</span>
        <span class="comment">// OPTIMIZE FYI:</span>
        <span class="comment">// NOTE: LoadRecordBox is much SLOWER than LoadRecordBoxNoVerify, but it also lets you get</span>
        <span class="comment">// the NAME off of the box receipt. So if you are willing to GIVE UP the NAME, in</span>
        <span class="comment">// return for FASTER PERFORMANCE, then call SetFastMode() before Populating.</span>
        <span class="comment">//</span>
        <a class="code" href="class_o_t_ledger.html">OTLedger</a> * pRecordbox = m_bRunFast ? <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a8c288f48dcdc98a6ae02c03e6452c438">LoadRecordBoxNoVerify</a>(theServerID, theNymID, theAccountID) :
                                             <a class="code" href="class_o_t_a_p_i___wrap.html#a8867c48885173f01d0f9f08aa83d3587">OTAPI_Wrap::OTAPI</a>()-&gt;<a class="code" href="class_o_t___a_p_i.html#a318f160f9a43ac68afcf415ff51ae267">LoadRecordBox</a>        (theServerID, theNymID, theAccountID);
        <a class="code" href="class_o_t_cleanup.html">OTCleanup&lt;OTLedger&gt;</a> theRecordBoxAngel(pRecordbox);

        <span class="comment">// It loaded up, so let&#39;s loop through it.</span>
        <span class="keywordtype">int</span> nRecordIndex = -1;
        <span class="keywordflow">if</span> (NULL != pRecordbox) <a class="code" href="_o_t_storage_8hpp.html#aa135ed03585fa4b246d7907afbd5873d">FOR_EACH</a>(<a class="code" href="_o_t_ledger_8hpp.html#a1823ddf57c0de6495aa8ec5da7f1b8f7">mapOfTransactions</a>, pRecordbox-&gt;<a class="code" href="class_o_t_ledger.html#aa71b6540e2948a36e3c7d3e7d14547a5">GetTransactionMap</a>())
        {
            ++nRecordIndex;
            <span class="comment">// -----------------------------</span>
            <a class="code" href="class_o_t_transaction.html">OTTransaction</a> * pBoxTrans = (*it).second;
            <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>(NULL != pBoxTrans);
            <span class="comment">// ------------------------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: Account RECORD index: %d\n&quot;</span>, __FUNCTION__, nRecordIndex);
            <span class="comment">// ------------------------------------------------</span>
            <span class="keywordtype">bool</span> bOutgoing = <span class="keyword">false</span>;
            <span class="keywordtype">bool</span> bCanceled = <span class="keyword">false</span>;
            <span class="comment">// ------------------------------</span>
            std::string  str_name; <span class="comment">// name of sender OR recipient (depending on whether it was originally incoming or outgoing.)</span>
            std::string  str_other_nym_id;
            std::string  str_other_acct_id;
            std::string  str_memo;

            <span class="keywordflow">if</span> (<span class="keyword">false</span> == pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aacf7e02644aace6f245b9d493e721186">IsAbbreviated</a>())
            {
                <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theSenderID,    theSenderAcctID;
                <a class="code" href="class_o_t_identifier.html">OTIdentifier</a> theRecipientID, theRecipientAcctID;

                <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#acf66d9f8f5d3a6e4ee0a418a41db6019">GetSenderAcctIDForDisplay</a>(theSenderAcctID))
                {
                    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strSenderAcctID(theSenderAcctID);
                    <span class="keyword">const</span> std::string str_sender_acct_id(strSenderAcctID.Get());

                    <span class="comment">// Usually, Nym is the RECIPIENT. Sometimes he&#39;s the sender.</span>
                    <span class="comment">// Either way, we want the OTHER ID (the other Nym) for display.</span>
                    <span class="comment">// So here, if Nym&#39;s CLEARLY the sender, then we want the RECIPIENT.</span>
                    <span class="comment">// Whereas if Nym were the recipient, then we&#39;d want the SENDER. (For display.)</span>
                    <span class="comment">//</span>
                    <span class="keywordflow">if</span> (0 == str_account_id.compare(str_sender_acct_id)) <span class="comment">// str_account_id IS str_sender_acct_id. (Therefore we want recipient.)</span>
                    {
                        bOutgoing = <span class="keyword">true</span>; <span class="comment">// if Nym is the sender, then it must have been outgoing.</span>

                        <span class="keyword">const</span> <span class="keywordtype">bool</span> bGotRecipientUserIDForDisplay =
                                pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID);

                        <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                        {
                            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strRecipientAcctID(theRecipientAcctID);
                            <span class="keyword">const</span> std::string str_recip_acct_id(strRecipientAcctID.Get());

                                  <a class="code" href="class_o_t_string.html">OTString</a>    strRecipientUserID(<span class="stringliteral">&quot;&quot;</span>);
                                  std::string str_recip_user_id(<span class="stringliteral">&quot;&quot;</span>);

                            <span class="keywordflow">if</span> (bGotRecipientUserIDForDisplay)
                            {
                                theRecipientID.<a class="code" href="class_o_t_identifier.html#a4bccb30446b4b515d9d6016b86b260bb">GetString</a>(strRecipientUserID);
                                str_recip_user_id = strRecipientUserID.Get();
                            }
                            <span class="comment">// ---------------------------------------</span>
                            <span class="comment">// NOTE: We check for cancelled here so we don&#39;t accidentally</span>
                            <span class="comment">// cause the address book to falsely believe that str_recip_user_id</span>
                            <span class="comment">// is the owner of str_recip_acct_id. (If the cheque/invoice is cancelled,</span>
                            <span class="comment">// the recipient account will be the sender account, which is NOT owned</span>
                            <span class="comment">// by the recipient, obviously...)</span>
                            <span class="comment">//</span>
                            <span class="keywordflow">if</span> (!pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aeabba0a2b6a52c8f50a329f7d14a1ba1">IsCancelled</a>())
                            {
                                <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#a0b746308196119aa968169387b6c9f7c">GetAcctName</a>(str_recip_acct_id,
                                                                        <span class="comment">// NOTE: we CANNOT pass str_recip_user_id here with str_recip_acct_id</span>
                                                                        <span class="comment">// if it&#39;s a cancelled instrument, since in that case, the SENDER ACCT</span>
                                                                        <span class="comment">// is ALSO the RECIPIENT ACCT. So this logic is ONLY correct since we</span>
                                                                        <span class="comment">// are inside the block of if (!pBoxTrans-&gt;IsCancelled())</span>
                                                                        <span class="comment">// (Otherwise we&#39;d be training the address book to falsely believe that</span>
                                                                        <span class="comment">// the recipient Nym is the owner of the sender acct.)</span>
                                                                        bGotRecipientUserIDForDisplay ?
                                                                           &amp;str_recip_user_id : NULL, <span class="comment">// nym ID if known</span>
                                                                        pstr_server_id, <span class="comment">// server ID if known.</span>
                                                                        pstr_asset_id)), <span class="comment">// asset ID if known.</span>
                                        strNameTemp;

                                <span class="keywordflow">if</span> (strName.Exists())
                                    strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                                <span class="keywordflow">else</span>
                                    strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recip_acct_id.c_str());

                                str_name = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// We don&#39;t want to see our own name on cancelled cheques.</span>
                            }
                            str_other_acct_id = str_recip_acct_id;
                        }
                        <span class="comment">// -----------------------------------------</span>
                        <span class="keywordflow">if</span> (bGotRecipientUserIDForDisplay)
                        {
                            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientID(theRecipientID);
                            <span class="keyword">const</span> std::string str_recipient_id(strRecipientID.Get());

                            str_other_nym_id = str_recipient_id;

                            <span class="keywordflow">if</span> (str_name.empty())
                            {
                                <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_recipient_id, &amp;(*it_server))), strNameTemp;

                                <span class="keywordflow">if</span> (strName.Exists())
                                    strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                                <span class="keywordflow">else</span>
                                    strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_id.c_str());

                                str_name = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                            }
                        }
                    }
                    <span class="keywordflow">else</span> <span class="comment">// str_account_id IS NOT str_sender_acct_id. (Therefore we want sender.)</span>
                    {    <span class="comment">// In this case, some OTHER Nym is the sender, so it must have been incoming. (And bOutgoing is already false.)</span>

                        <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a1091822e3072f014a8b2f64b93917ca7" title="For display purposes. The &quot;ref #&quot; you actually display (versus the one you use internally) might chan...">GetSenderUserIDForDisplay</a>(theSenderID))
                        {
                            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strSenderUserID(theSenderID);
                            str_other_nym_id = strSenderUserID.Get();
                        }
                        <span class="comment">// ------------------------------------</span>
                        <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#a0b746308196119aa968169387b6c9f7c">GetAcctName</a>(str_sender_acct_id,
                                                                str_other_nym_id.empty() ? NULL :
                                                                    &amp;str_other_nym_id, <span class="comment">// nym ID if known</span>
                                                                pstr_server_id, <span class="comment">// server ID if known.</span>
                                                                pstr_asset_id)), <span class="comment">// asset ID if known.</span>
                                strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), strName.Get());
                        <span class="keywordflow">else</span>
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), str_sender_acct_id.c_str());

                        str_name          = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                        str_other_acct_id = str_sender_acct_id;
                    }
                }
                <span class="comment">// In this block below, we already KNOW GetSenderAcctIDForDisplay is EMPTY.</span>
                <span class="comment">// (So it&#39;s &quot;recipient or bust.&quot;)</span>
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                {
                    <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID))
                    {
                        <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientID(theRecipientID);
                        <span class="keyword">const</span> std::string str_recipient_user_id(strRecipientID.Get());

                        str_other_nym_id = str_recipient_user_id;
                    }
                    <span class="comment">// --------------------------------------------------------</span>
                    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientAcctID(theRecipientAcctID);
                    <span class="keyword">const</span> std::string str_recipient_acct_id(strRecipientAcctID.Get());

                    <span class="keywordflow">if</span> (0 != str_account_id.compare(str_recipient_acct_id)) <span class="comment">// str_account_id is NOT str_recipient_acct_id. (Therefore we want str_recipient_acct_id.)</span>
                    {
                        <span class="comment">// If Nym is not the recipient, then he must be the sender.</span>
                        <span class="comment">// (Therefore it must be outgoing.)</span>
                        bOutgoing = <span class="keyword">true</span>;

                        <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#a0b746308196119aa968169387b6c9f7c">GetAcctName</a>(str_recipient_acct_id,
                                                                str_other_nym_id.empty() ? NULL :
                                                                    &amp;str_other_nym_id, <span class="comment">// nym ID if known</span>
                                                                pstr_server_id, <span class="comment">// server ID if known.</span>
                                                                pstr_asset_id)), <span class="comment">// asset ID if known.</span>
                                strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                        <span class="keywordflow">else</span>
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_acct_id.c_str());

                        str_name          = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// Todo: lookup the name in address book also.</span>
                        str_other_acct_id = str_recipient_acct_id;
                    }
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a1091822e3072f014a8b2f64b93917ca7" title="For display purposes. The &quot;ref #&quot; you actually display (versus the one you use internally) might chan...">GetSenderUserIDForDisplay</a>(theSenderID))
                {
                    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a>    strSenderID  (theSenderID);
                    <span class="keyword">const</span> std::string str_sender_id(strSenderID.Get());

                    <span class="comment">// Usually, Nym is the RECIPIENT. Sometimes he&#39;s the sender.</span>
                    <span class="comment">// Either way, we want the OTHER ID (the other Nym) for display.</span>
                    <span class="comment">// So here, if Nym&#39;s CLEARLY the sender, then we want the RECIPIENT.</span>
                    <span class="comment">// Whereas if Nym were the recipient, then we&#39;d want the SENDER. (For display.)</span>
                    <span class="comment">//</span>
                    <span class="keywordflow">if</span> (0 == str_nym_id.compare(str_sender_id)) <span class="comment">// str_nym_id IS str_sender_id. (Therefore we want recipient.)</span>
                    {
                        bOutgoing = <span class="keyword">true</span>; <span class="comment">// if Nym is the sender, then it must have been outgoing.</span>

                        <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID))
                        {
                            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientID(theRecipientID);
                            <span class="keyword">const</span> std::string str_recipient_id(strRecipientID.Get());

                            <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_recipient_id, &amp;(*it_server))), strNameTemp;

                            <span class="keywordflow">if</span> (strName.Exists())
                                strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                            <span class="keywordflow">else</span>
                                strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_id.c_str());

                            str_name         = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
                            str_other_nym_id = str_recipient_id;
                            <span class="comment">// ------------------------------------</span>
                            <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                            {
                                <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientAcctID(theRecipientAcctID);
                                str_other_acct_id = strRecipientAcctID.Get();
                            }
                        }
                    }
                    <span class="keywordflow">else</span> <span class="comment">// str_nym_id IS NOT str_sender_id. (Therefore we want sender.)</span>
                    {    <span class="comment">// In this case, some OTHER Nym is the sender, so it must have been incoming. (And bOutgoing is already false.)</span>

                        <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_sender_id, &amp;(*it_server))), strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), strName.Get());
                        <span class="keywordflow">else</span>
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a>(), str_sender_id.c_str());

                        str_name         = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// Todo: lookup the name in address book also.</span>
                        str_other_nym_id = str_sender_id;
                        <span class="comment">// ------------------------------------</span>
                        <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#acf66d9f8f5d3a6e4ee0a418a41db6019">GetSenderAcctIDForDisplay</a>(theSenderAcctID))
                        {
                            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strSenderAcctID(theSenderAcctID);
                            str_other_acct_id = strSenderAcctID.Get();
                        }
                    }
                }
                <span class="comment">// In this block below, we already KNOW GetSenderUserIDForDisplay is EMPTY.</span>
                <span class="comment">// (So it&#39;s &quot;recipient or bust.&quot;)</span>
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a829e1dc63a933dae6fd3761091a9a2b1">GetRecipientUserIDForDisplay</a>(theRecipientID))
                {
                    <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientID(theRecipientID);
                    <span class="keyword">const</span> std::string str_recipient_id(strRecipientID.Get());

                    <span class="keywordflow">if</span> (0 != str_nym_id.compare(str_recipient_id)) <span class="comment">// str_nym_id is NOT str_recipient_id. (Therefore we want str_recipient_id.)</span>
                    {
                        <span class="comment">// If Nym is not the recipient, then he must be the sender.</span>
                        <span class="comment">// (Therefore it must be outgoing.)</span>
                        bOutgoing = <span class="keyword">true</span>;

                        <a class="code" href="class_o_t_string.html">OTString</a> strName(m_pLookup-&gt;<a class="code" href="class_o_t_name_lookup.html#ab9de14dd7df628b73df85ea96efa6eee">GetNymName</a>(str_recipient_id, &amp;(*it_server))), strNameTemp;

                        <span class="keywordflow">if</span> (strName.Exists())
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), strName.Get());
                        <span class="keywordflow">else</span>
                            strNameTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<a class="code" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a>(), str_recipient_id.c_str());

                        str_name         = strNameTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>(); <span class="comment">// Todo: lookup the name in address book also.</span>
                        str_other_nym_id = str_recipient_id;
                        <span class="comment">// ------------------------------------</span>
                        <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a54221d2117096fd673147492a67f6755">GetRecipientAcctIDForDisplay</a>(theRecipientAcctID))
                        {
                            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strRecipientAcctID(theRecipientAcctID);
                            str_other_acct_id = strRecipientAcctID.Get();
                        }
                    }
                }
                <span class="comment">// ---------------------</span>
                <span class="comment">// Get the Memo field for a transferReceipt and also for other receipts.</span>
                <span class="comment">//</span>
                <a class="code" href="class_o_t_string.html">OTString</a> strMemo;

                <span class="keywordflow">if</span> (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#abc54a3c74c5235cfe1debe4a2f97c2cd">GetMemo</a>(strMemo))
                    str_memo = strMemo.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();

            } <span class="comment">// if not abbreviated.</span>
            <span class="comment">// ------------------------------</span>
            bCanceled = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#aeabba0a2b6a52c8f50a329f7d14a1ba1">IsCancelled</a>();
            <span class="comment">// ------------------------------</span>
            <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a> tValidFrom = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>, tValidTo = <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>;
            <span class="comment">// ------------------------------</span>
            std::string str_date    = <span class="stringliteral">&quot;0&quot;</span>; <span class="comment">// the &quot;date signed&quot; on the transaction receipt.</span>
            <a class="code" href="_o_t_common_8hpp.html#ad28ff0a3eda18840f6bda5872819167f">time64_t</a>      tDateSigned = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#afb069b9f7ab72f90e9e42aed0ba3b17c">GetDateSigned</a>();

            <span class="keywordflow">if</span> (tDateSigned &gt; <a class="code" href="_o_t_common_8hpp.html#af4ca9fa2c7c290d647dd18de0a9ac25f">OT_TIME_ZERO</a>)
            {
                tValidFrom = tDateSigned;
                <span class="keyword">const</span> uint64_t lDateSigned = <a class="code" href="_o_t_common_8hpp.html#a4c31551b478d298d694f7df4915b4302">OTTimeGetSecondsFromTime</a>(tDateSigned);
                <a class="code" href="class_o_t_string.html">OTString</a> strDateSigned;
                strDateSigned.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRIu64 <span class="stringliteral">&quot;&quot;</span>, lDateSigned);
                str_date = strDateSigned.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();
            }
            <span class="comment">// ------------------------------</span>
            std::string str_amount;  <span class="comment">// &lt;========== AMOUNT</span>
            int64_t        lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a9ef2e2e40960239f6cbd0d1c1ded42f4">GetAbbrevDisplayAmount</a>();

            <span class="keywordflow">if</span> (0 == lAmount)
                lAmount = pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a01fdc95811465496f953c5a50dcef6">GetReceiptAmount</a>();
            <span class="comment">// ------------------------------------------</span>
            <span class="keyword">const</span> std::string str_type(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a5baeb1d30c71f3a37565cb2e91b05447">GetTypeString</a>()); <span class="comment">// pending, chequeReceipt, etc.</span>
            <span class="comment">// ------------------------------</span>
            <span class="keywordflow">if</span> (0 == str_type.compare(<span class="stringliteral">&quot;transferReceipt&quot;</span>))
                bOutgoing = <span class="keyword">true</span>; <span class="comment">// only the sender of a transfer will have a transferReceipt.</span>
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == str_type.compare(<span class="stringliteral">&quot;pending&quot;</span>))
                bOutgoing = <span class="keyword">false</span>; <span class="comment">// only the recipient of a transfer will have a pending in his recordbox.</span>
            <span class="comment">// ------------------------------</span>
            <span class="keywordflow">if</span> (0 != lAmount)
            {

<span class="comment">//                if (lAmount &lt; 0)</span>
<span class="comment">//                    bOutgoing = true;</span>
<span class="comment">//                else</span>
<span class="comment">//                    bOutgoing = false;</span>

                <span class="comment">// A transfer receipt ALWAYS represents an outgoing transfer.</span>
                <span class="comment">// If the amount is over 0, we want to display it as a negative</span>
                <span class="comment">// since it represents money LEAVING my account.</span>
<span class="comment">//                if ((0 == str_type.compare(&quot;transferReceipt&quot;)) &amp;&amp; (lAmount &gt; 0))</span>
<span class="comment">//                    lAmount *= (-1);</span>

                <a class="code" href="class_o_t_string.html">OTString</a> strTemp;
                strTemp.<a class="code" href="class_o_t_string.html#af1c861f21033a1d583b3cb12f952422e">Format</a>(<span class="stringliteral">&quot;%&quot;</span> PRId64 <span class="stringliteral">&quot;&quot;</span>, lAmount);
                str_amount = strTemp.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>();

            }
            <span class="comment">// ------------------------------</span>
            <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(0, <span class="stringliteral">&quot;%s: ADDED: %s (asset account) record (str_type: %s)\n&quot;</span>,
                           __FUNCTION__,
                           <span class="comment">// This line means: If it&#39;s a receipt, use a blank string. Otherwise if</span>
                           <span class="comment">// it&#39;s a transfer, then show sent/received. (This is the record box, so</span>
                           <span class="comment">// if it&#39;s a transfer, it&#39;s a completed one.)</span>
                           <span class="comment">//</span>
                           <span class="comment">// FYI, for Receipts we don&#39;t say &quot;sent transferReceipt&quot;,</span>
                           <span class="comment">// we just say &quot;transferReceipt.&quot;</span>
                           <span class="comment">//</span>
                           (pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>() != <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a>) ? <span class="stringliteral">&quot;&quot;</span> : (bOutgoing ? <span class="stringliteral">&quot;sent&quot;</span> : <span class="stringliteral">&quot;received&quot;</span>),
                           str_type.c_str());

            <a class="code" href="_o_t_record_list_8hpp.html#aa189a7af488f9684cc56c81eba2a9c14">shared_ptr_OTRecord</a> sp_Record(<span class="keyword">new</span> <a class="code" href="class_o_t_record.html">OTRecord</a>(*pstr_server_id,
                                                       *pstr_asset_id,
                                                       *pstr_asset_name,
                                                       *pstr_nym_id,   <span class="comment">// This is the Nym WHOSE BOX IT IS.</span>
                                                       str_account_id, <span class="comment">// This is the Nym&#39;s account for this box.</span>
                                                       <span class="comment">// Everything above this line, it stores a reference to an external string.</span>
                                                       <span class="comment">// -----------------------------</span>
                                                       <span class="comment">// Everything below this line, it makes its own internal copy of the string.</span>
                                                       str_name, <span class="comment">// name of sender or recipient (whichever is NOT the current Nym.)</span>
                                                       str_date, <span class="comment">// the &quot;valid from&quot; date on the instrument.</span>
                                                       str_amount,
                                                       str_type, <span class="comment">// pending, chequeReceipt, etc.</span>
                                                       <span class="keyword">false</span>,    <span class="comment">// bPending=false. If it&#39;s in the record box, then it&#39;s finished (not pending.)</span>
                                                       bOutgoing, <span class="comment">// Record box stores both old incoming, AND old outgoing, receipts.</span>
                                                       <span class="keyword">true</span>, <span class="comment">//IsRecord</span>
                                                       pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>() != <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a>, <span class="comment">//IsReceipt</span>
                                                       pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#ac964dfd1e704c02358a6641f030ead38">GetType</a>() == <a class="code" href="class_o_t_transaction.html#af6b54636f1000e09f19d1c7a7886e1f8addbed2a5d0af9bf58ff0694f587b4e08">OTTransaction::pending</a> ?
                                                            <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2da3a6c19392e918ba4597ae131b007c94f">OTRecord::Transfer</a> : <a class="code" href="class_o_t_record.html#a126d840d32aceeb21498b76e61b75b2da106c4db2d8feb54b5d3afee0ead49fc2">OTRecord::Receipt</a>));
            <span class="comment">// -------------------------------------------------</span>
            <span class="keyword">const</span> <a class="code" href="class_o_t_string.html">OTString</a> strContents(*pBoxTrans);
            sp_Record-&gt;SetContents(strContents.<a class="code" href="class_o_t_string.html#af87b3b43148de9b1425ed8e9348241d3">Get</a>());
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (bCanceled)
                sp_Record-&gt;SetCanceled();
            <span class="comment">// -------------------------------------------------</span>
            sp_Record-&gt;SetDateRange(tValidFrom, tValidTo);
            <span class="comment">// -------------------------------------------------</span>
            sp_Record-&gt;SetBoxIndex(static_cast&lt;int&gt;(nRecordIndex));
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (!str_memo.empty())
                sp_Record-&gt;SetMemo(str_memo);
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (!str_other_nym_id.empty())
                sp_Record-&gt;SetOtherNymID(str_other_nym_id);
            <span class="comment">// -------------------------------------------------</span>
            <span class="keywordflow">if</span> (!str_other_acct_id.empty())
                sp_Record-&gt;SetOtherAccountID(str_other_acct_id);
            <span class="comment">// -------------------------------------------------</span>
            sp_Record-&gt;SetTransNumForDisplay(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction.html#a7a4463450cc735aea9b924011f073bb3">GetReferenceNumForDisplay</a>());
            sp_Record-&gt;SetTransactionNum(pBoxTrans-&gt;<a class="code" href="class_o_t_transaction_type.html#aa204b21b7f498389f746742c1d2007fa">GetTransactionNum</a>());
            <span class="comment">// -------------------------------------------------</span>
            m_contents.push_back(sp_Record);
        }
        <span class="comment">// ------------------------------------------------</span>

    } <span class="comment">// loop through the accounts.</span>
    <span class="comment">// ------------------------------------------------</span>
    <span class="comment">// SORT the vector.</span>
    <span class="comment">//</span>
    <span class="comment">// TODO OPTIMIZE: We might load everything up into a multimap, and THEN copy it</span>
    <span class="comment">// directly over to the vector. (Since the multimap sorts automatically on insert.)</span>
    <span class="comment">// The question is, would doing that be any faster than just sorting it here?</span>
    <span class="comment">// (Possibly not, but I&#39;m not sure. Re-visit later.)</span>
    <span class="comment">//</span>
    std::sort (m_contents.begin(), m_contents.end(), <a class="code" href="_o_t_record_list_8cpp.html#a62f92aa6cb982ab391b04541e685681b">compare_records</a>); <span class="comment">// Todo optimize: any faster sorting algorithms?</span>
    <span class="comment">// ------------------------------------------------</span>
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a06d0016ff3e3ee84db4425a1b2f5a41b"></a><!-- doxytag: member="OTRecordList::RemoveRecord" ref="a06d0016ff3e3ee84db4425a1b2f5a41b" args="(int32_t nIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_record_list.html#a06d0016ff3e3ee84db4425a1b2f5a41b">OTRecordList::RemoveRecord</a> </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>nIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l03288">3288</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="_o_t_assert_8hpp.html#a74ecab0c6a7b0a9a546bb545160e23b3">OT_ASSERT</a>((nIndex &gt;= 0) &amp;&amp; (nIndex &lt; static_cast&lt;int32_t&gt;(m_contents.size())));
    m_contents.erase(m_contents.begin()+nIndex);
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6d54cbd85e4bd1ef68f386c5e87a4cdd"></a><!-- doxytag: member="OTRecordList::SetAccountID" ref="a6d54cbd85e4bd1ef68f386c5e87a4cdd" args="(const std::string str_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a6d54cbd85e4bd1ef68f386c5e87a4cdd">OTRecordList::SetAccountID</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>str_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00481">481</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_record_list.html#aa76496d19fdaaad6b231c65bad6c36e4">ClearAccounts</a>();
    <span class="comment">// -----------------------</span>
    <a class="code" href="class_o_t_record_list.html#a3797bde231add00697f547a147839906">AddAccountID</a>(str_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aae138fffa645482e39d2d838e4124839"></a><!-- doxytag: member="OTRecordList::setAddrBookCaller" ref="aae138fffa645482e39d2d838e4124839" args="(OTLookupCaller &amp;theCaller)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_o_t_record_list.html#aae138fffa645482e39d2d838e4124839">OTRecordList::setAddrBookCaller</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_o_t_lookup_caller.html">OTLookupCaller</a> &amp;&#160;</td>
          <td class="paramname"><em>theCaller</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00328">328</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(3, <span class="stringliteral">&quot;%s: Attempting to set the address book caller... \n&quot;</span>, __FUNCTION__);
    
    <span class="keywordflow">if</span> (!theCaller.<a class="code" href="class_o_t_lookup_caller.html#a1505287e5d5e6753fec8bf9ed8c88e62">isCallbackSet</a>())
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: ERROR: OTLookupCaller::setCallback() &quot;</span>
                      <span class="stringliteral">&quot;MUST be called first, with an OTNameLookup-extended object passed to it,\n&quot;</span>
                      <span class="stringliteral">&quot;BEFORE calling this function with that OTLookupCaller. (Returning false.)\n&quot;</span>, __FUNCTION__);
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    
    <span class="keywordflow">if</span> (NULL != <a class="code" href="class_o_t_record_list.html#a111c1ea4503cbe5f1b684dbd28682a2e">s_pCaller</a>)
    {
        <a class="code" href="class_o_t_log.html#acd1264f26723485de0783186149b0eca">OTLog::vError</a>(<span class="stringliteral">&quot;%s: WARNING: Setting the address book caller again, even though &quot;</span>
                      <span class="stringliteral">&quot;it was apparently ALREADY set... (Meaning Java has probably erroneously called this twice, &quot;</span>
                      <span class="stringliteral">&quot;possibly passing the same OTLookupCaller both times.)\n&quot;</span>, __FUNCTION__);
<span class="comment">//      delete s_pCaller; // Let Java delete it.</span>
    }
    
    <a class="code" href="class_o_t_record_list.html#a111c1ea4503cbe5f1b684dbd28682a2e">s_pCaller</a> = &amp;theCaller;
    <span class="comment">// ---------------------------</span>
    <a class="code" href="class_o_t_log.html#aa2a497c02879b811fe3134631d762f08">OTLog::vOutput</a>(1, <span class="stringliteral">&quot;%s: FYI, Successfully set the address book caller object from &quot;</span>
                   <span class="stringliteral">&quot;Java. Returning true.\n&quot;</span>, __FUNCTION__);
    
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8940a1f349f3543499e94c7e599ef3f9"></a><!-- doxytag: member="OTRecordList::SetAssetID" ref="a8940a1f349f3543499e94c7e599ef3f9" args="(const std::string str_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a8940a1f349f3543499e94c7e599ef3f9">OTRecordList::SetAssetID</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>str_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00399">399</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_record_list.html#a6752defba9b0a83c6d9723c1ab8f76a3">ClearAssets</a>();
    <span class="comment">// -----------------------</span>
    <a class="code" href="class_o_t_record_list.html#a47afa29d1990ec024feac91e6032c786">AddAssetID</a>(str_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a95de2963c62f82a8669d20c93f8289cd"></a><!-- doxytag: member="OTRecordList::SetFastMode" ref="a95de2963c62f82a8669d20c93f8289cd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT void <a class="el" href="class_o_t_record_list.html#a95de2963c62f82a8669d20c93f8289cd">OTRecordList::SetFastMode</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8hpp_source.html#l00274">274</a> of file <a class="el" href="_o_t_record_list_8hpp_source.html">OTRecordList.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ m_bRunFast = <span class="keyword">true</span>; }
</pre></div>
</div>
</div>
<a class="anchor" id="a4f11a534c858d5dc8371c83e4ec5cbc5"></a><!-- doxytag: member="OTRecordList::SetNymID" ref="a4f11a534c858d5dc8371c83e4ec5cbc5" args="(const std::string str_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#a4f11a534c858d5dc8371c83e4ec5cbc5">OTRecordList::SetNymID</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>str_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00455">455</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_record_list.html#a8c07d4f66047848e971b631b9dd7eace">ClearNyms</a>();
    <span class="comment">// -----------------------</span>
    <a class="code" href="class_o_t_record_list.html#aa9b17f88ed73b797b84be5fca67877c9">AddNymID</a>(str_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae87f1e637851abb0d46e1eddb424e6da"></a><!-- doxytag: member="OTRecordList::SetServerID" ref="ae87f1e637851abb0d46e1eddb424e6da" args="(const std::string str_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_o_t_record_list.html#ae87f1e637851abb0d46e1eddb424e6da">OTRecordList::SetServerID</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>str_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l00372">372</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="class_o_t_record_list.html#a5a1aa0a3c27dacc601263b13ba21770e">ClearServers</a>();
    <span class="comment">// -----------------------</span>
    <a class="code" href="class_o_t_record_list.html#a9d8963a34cc95d0665fc7824fc08846d">AddServerID</a>(str_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2d0938938a6401c8b0e2bd376323c511"></a><!-- doxytag: member="OTRecordList::setTextFrom" ref="a2d0938938a6401c8b0e2bd376323c511" args="(const std::string text)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static EXPORT void <a class="el" href="class_o_t_record_list.html#a2d0938938a6401c8b0e2bd376323c511">OTRecordList::setTextFrom</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8hpp_source.html#l00272">272</a> of file <a class="el" href="_o_t_record_list_8hpp_source.html">OTRecordList.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ s_strTextFrom = text; }
</pre></div>
</div>
</div>
<a class="anchor" id="aa5d5a6d00a8b54e2b295133563cd8646"></a><!-- doxytag: member="OTRecordList::setTextTo" ref="aa5d5a6d00a8b54e2b295133563cd8646" args="(const std::string text)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static EXPORT void <a class="el" href="class_o_t_record_list.html#aa5d5a6d00a8b54e2b295133563cd8646">OTRecordList::setTextTo</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>text</em></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8hpp_source.html#l00271">271</a> of file <a class="el" href="_o_t_record_list_8hpp_source.html">OTRecordList.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ s_strTextTo   = text; }
</pre></div>
</div>
</div>
<a class="anchor" id="a858ab3250d47c849687389e9b1e7b5e2"></a><!-- doxytag: member="OTRecordList::size" ref="a858ab3250d47c849687389e9b1e7b5e2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t <a class="el" href="class_o_t_record_list.html#a858ab3250d47c849687389e9b1e7b5e2">OTRecordList::size</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8cpp_source.html#l03282">3282</a> of file <a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> m_contents.size();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7a6171c700273b7fd5b1af2499653e2a"></a><!-- doxytag: member="OTRecordList::textFrom" ref="a7a6171c700273b7fd5b1af2499653e2a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static EXPORT const char* <a class="el" href="class_o_t_record_list.html#a7a6171c700273b7fd5b1af2499653e2a">OTRecordList::textFrom</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8hpp_source.html#l00269">269</a> of file <a class="el" href="_o_t_record_list_8hpp_source.html">OTRecordList.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> s_strTextFrom.c_str(); }
</pre></div>
</div>
</div>
<a class="anchor" id="aafd6d679105ba507a06690c39372b48f"></a><!-- doxytag: member="OTRecordList::textTo" ref="aafd6d679105ba507a06690c39372b48f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static EXPORT const char* <a class="el" href="class_o_t_record_list.html#aafd6d679105ba507a06690c39372b48f">OTRecordList::textTo</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8hpp_source.html#l00268">268</a> of file <a class="el" href="_o_t_record_list_8hpp_source.html">OTRecordList.hpp</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> s_strTextTo  .c_str(); }
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a111c1ea4503cbe5f1b684dbd28682a2e"></a><!-- doxytag: member="OTRecordList::s_pCaller" ref="a111c1ea4503cbe5f1b684dbd28682a2e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_t_lookup_caller.html">OTLookupCaller</a> * <a class="el" href="class_o_t_record_list.html#a111c1ea4503cbe5f1b684dbd28682a2e">OTRecordList::s_pCaller</a> = NULL<code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_o_t_record_list_8hpp_source.html#l00261">261</a> of file <a class="el" href="_o_t_record_list_8hpp_source.html">OTRecordList.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/otapi/<a class="el" href="_o_t_record_list_8hpp_source.html">OTRecordList.hpp</a></li>
<li>src/otapi/<a class="el" href="_o_t_record_list_8cpp_source.html">OTRecordList.cpp</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_o_t_record_list.html">OTRecordList</a>      </li>

    <li class="footer">Generated on Wed May 21 2014 11:26:15 for Open-Transactions by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
